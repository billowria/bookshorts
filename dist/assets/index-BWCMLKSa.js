const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-DqV9_OhW.js","assets/react-vendor-DWBQL16M.js"])))=>i.map(i=>d[i]);
import{e as hn,u as Oi,j as s,B as ne,F as Me,C as Le,S as rr,L as Et,H as ke,T as oe,I as Ge,a as ae,b as ve,c as be,A as tt,d as rt,V as we,f as $t,m as st,g as mt,h as Ct,i as ze,k as Bt,l as As,n as Ot,o as dt,D as Pt,p as Yn,P as ji,q as ga,r as va,s as jt,t as St,v as At,w as Ji,x as Ts,y as Zi,z as Xi,E as Tt,G as Tr,J as Xe,K as $e,M as qe,N as Jn,O as Cs,Q as Zr,R as Xr,U as Qr,W as ya,X as ma,Y as Ps,Z as Si,_ as Zn,$ as Xn,a0 as Qt,a1 as Qn,a2 as er,a3 as ei,a4 as Ls,a5 as Rs,a6 as ti,a7 as ri,a8 as ni,a9 as ii,aa as oi,ab as ai,ac as Ns,ad as Nn,ae as Wt,af as Gt,ag as Kt,ah as Qi,ai as Is,aj as Ds,ak as eo,al as vr,am as Ms,an as yr,ao as Bs,ap as $s,aq as to,ar as ro,as as no,at as Vt,au as io,av as qs,aw as ba}from"./chakra-vendor-C5BQn-N8.js";import{a as _a,d as Us,c as Te,b as yt,r as Q,L as Ae,O as xa,u as pn,e as gn,N as Ai,f as wa,g as Fs,h as zs,i as Fe,B as Hs}from"./react-vendor-DWBQL16M.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var si={},oo=_a;si.createRoot=oo.createRoot,si.hydrateRoot=oo.hydrateRoot;const Ws="modulepreload",Gs=function(n){return"/"+n},ao={},nr=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),g=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(d=>{if(d=Gs(d),d in ao)return;ao[d]=!0;const v=d.endsWith(".css"),u=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const f=document.createElement("link");if(f.rel=v?"stylesheet":Ws,v||(f.as="script"),f.crossOrigin="",f.href=d,g&&f.setAttribute("nonce",g),document.head.appendChild(f),v)return new Promise((l,c)=>{f.addEventListener("load",l),f.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(a){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=a,window.dispatchEvent(g),!g.defaultPrevented)throw a}return i.then(a=>{for(const g of a||[])g.status==="rejected"&&o(g.reason);return e().catch(o)})},Ks=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>nr(async()=>{const{default:r}=await Promise.resolve().then(()=>ar);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Ti extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Vs extends Ti{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ys extends Ti{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Js extends Ti{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var li;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(li||(li={}));var Zs=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function g(u){try{v(r.next(u))}catch(f){a(f)}}function d(u){try{v(r.throw(u))}catch(f){a(f)}}function v(u){u.done?o(u.value):i(u.value).then(g,d)}v((r=r.apply(n,e||[])).next())})};class Xs{constructor(e,{headers:t={},customFetch:r,region:i=li.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=Ks(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Zs(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:a}=t;let g={},{region:d}=t;d||(d=this.region),d&&d!=="any"&&(g["x-region"]=d);let v;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(g["Content-Type"]="application/octet-stream",v=a):typeof a=="string"?(g["Content-Type"]="text/plain",v=a):typeof FormData<"u"&&a instanceof FormData?v=a:(g["Content-Type"]="application/json",v=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},g),this.headers),i),body:v}).catch(_=>{throw new Vs(_)}),f=u.headers.get("x-relay-error");if(f&&f==="true")throw new Ys(u);if(!u.ok)throw new Js(u);let l=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),c;return l==="application/json"?c=yield u.json():l==="application/octet-stream"?c=yield u.blob():l==="text/event-stream"?c=u:l==="multipart/form-data"?c=yield u.formData():c=yield u.text(),{data:c,error:null}}catch(i){return{data:null,error:i}}})}}var Ze={},Ci={},vn={},Nr={},yn={},mn={},Qs=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ir=Qs();const el=ir.fetch,ka=ir.fetch.bind(ir),Ea=ir.Headers,tl=ir.Request,rl=ir.Response,ar=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ea,Request:tl,Response:rl,default:ka,fetch:el},Symbol.toStringTag,{value:"Module"})),nl=Us(ar);var bn={};Object.defineProperty(bn,"__esModule",{value:!0});let il=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};bn.default=il;var Oa=Te&&Te.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(mn,"__esModule",{value:!0});const ol=Oa(nl),al=Oa(bn);let sl=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=ol.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var a,g,d;let v=null,u=null,f=null,l=o.status,c=o.statusText;if(o.ok){if(this.method!=="HEAD"){const h=await o.text();h===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=h:u=JSON.parse(h))}const y=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(g=o.headers.get("content-range"))===null||g===void 0?void 0:g.split("/");y&&b&&b.length>1&&(f=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(v={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,l=406,c="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const y=await o.text();try{v=JSON.parse(y),Array.isArray(v)&&o.status===404&&(u=[],v=null,l=200,c="OK")}catch{o.status===404&&y===""?(l=204,c="No Content"):v={message:y}}if(v&&this.isMaybeSingle&&(!((d=v==null?void 0:v.details)===null||d===void 0)&&d.includes("0 rows"))&&(v=null,l=200,c="OK"),v&&this.shouldThrowOnError)throw new al.default(v)}return{error:v,data:u,count:f,status:l,statusText:c}});return this.shouldThrowOnError||(i=i.catch(o=>{var a,g,d;return{error:{message:`${(a=o==null?void 0:o.name)!==null&&a!==void 0?a:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(g=o==null?void 0:o.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(d=o==null?void 0:o.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};mn.default=sl;var ll=Te&&Te.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(yn,"__esModule",{value:!0});const cl=ll(mn);let ul=class extends cl.default{select(e){let t=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.order`:"order",g=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${g?`${g},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:i=r}={}){const o=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:i=!1,wal:o=!1,format:a="text"}={}){var g;const d=[e?"analyze":null,t?"verbose":null,r?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),v=(g=this.headers.Accept)!==null&&g!==void 0?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${v}"; options=${d};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};yn.default=ul;var fl=Te&&Te.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Nr,"__esModule",{value:!0});const dl=fl(yn);let hl=class extends dl.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Nr.default=hl;var pl=Te&&Te.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(vn,"__esModule",{value:!0});const mr=pl(Nr);let gl=class{constructor(e,{headers:t={},schema:r,fetch:i}){this.url=e,this.headers=t,this.schema=r,this.fetch=i}select(e,{head:t=!1,count:r}={}){const i=t?"HEAD":"GET";let o=!1;const a=(e??"*").split("").map(g=>/\s/.test(g)&&!o?"":(g==='"'&&(o=!o),g)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new mr.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const i="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),t&&o.push(`count=${t}`),r||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const a=e.reduce((g,d)=>g.concat(Object.keys(d)),[]);if(a.length>0){const g=[...new Set(a)].map(d=>`"${d}"`);this.url.searchParams.set("columns",g.join(","))}}return new mr.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:i,defaultToNull:o=!0}={}){const a="POST",g=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&g.push(this.headers.Prefer),i&&g.push(`count=${i}`),o||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(e)){const d=e.reduce((v,u)=>v.concat(Object.keys(u)),[]);if(d.length>0){const v=[...new Set(d)].map(u=>`"${u}"`);this.url.searchParams.set("columns",v.join(","))}}return new mr.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new mr.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new mr.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};vn.default=gl;var _n={},xn={};Object.defineProperty(xn,"__esModule",{value:!0});xn.version=void 0;xn.version="0.0.0-automated";Object.defineProperty(_n,"__esModule",{value:!0});_n.DEFAULT_HEADERS=void 0;const vl=xn;_n.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${vl.version}`};var ja=Te&&Te.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ci,"__esModule",{value:!0});const yl=ja(vn),ml=ja(Nr),bl=_n;let _l=class Sa{constructor(e,{headers:t={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},bl.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new yl.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Sa(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:i=!1,count:o}={}){let a;const g=new URL(`${this.url}/rpc/${e}`);let d;r||i?(a=r?"HEAD":"GET",Object.entries(t).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{g.searchParams.append(u,f)})):(a="POST",d=t);const v=Object.assign({},this.headers);return o&&(v.Prefer=`count=${o}`),new ml.default({method:a,url:g,headers:v,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}};Ci.default=_l;var sr=Te&&Te.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.PostgrestError=Ze.PostgrestBuilder=Ze.PostgrestTransformBuilder=Ze.PostgrestFilterBuilder=Ze.PostgrestQueryBuilder=Ze.PostgrestClient=void 0;const Aa=sr(Ci);Ze.PostgrestClient=Aa.default;const Ta=sr(vn);Ze.PostgrestQueryBuilder=Ta.default;const Ca=sr(Nr);Ze.PostgrestFilterBuilder=Ca.default;const Pa=sr(yn);Ze.PostgrestTransformBuilder=Pa.default;const La=sr(mn);Ze.PostgrestBuilder=La.default;const Ra=sr(bn);Ze.PostgrestError=Ra.default;var xl=Ze.default={PostgrestClient:Aa.default,PostgrestQueryBuilder:Ta.default,PostgrestFilterBuilder:Ca.default,PostgrestTransformBuilder:Pa.default,PostgrestBuilder:La.default,PostgrestError:Ra.default};const{PostgrestClient:wl,PostgrestQueryBuilder:Am,PostgrestFilterBuilder:Tm,PostgrestTransformBuilder:Cm,PostgrestBuilder:Pm,PostgrestError:Lm}=xl,kl="2.11.2",El={"X-Client-Info":`realtime-js/${kl}`},Ol="1.0.0",Na=1e4,jl=1e3;var tr;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(tr||(tr={}));var Qe;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Qe||(Qe={}));var at;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(at||(at={}));var ci;(function(n){n.websocket="websocket"})(ci||(ci={}));var Mt;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Mt||(Mt={}));class Sl{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const i=t.getUint8(1),o=t.getUint8(2);let a=this.HEADER_LENGTH+2;const g=r.decode(e.slice(a,a+i));a=a+i;const d=r.decode(e.slice(a,a+o));a=a+o;const v=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:g,event:d,payload:v}}}class Ia{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var je;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(je||(je={}));const so=(n,e,t={})=>{var r;const i=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((o,a)=>(o[a]=Al(a,n,e,i),o),{})},Al=(n,e,t,r)=>{const i=e.find(g=>g.name===n),o=i==null?void 0:i.type,a=t[n];return o&&!r.includes(o)?Da(o,a):ui(a)},Da=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Ll(e,t)}switch(n){case je.bool:return Tl(e);case je.float4:case je.float8:case je.int2:case je.int4:case je.int8:case je.numeric:case je.oid:return Cl(e);case je.json:case je.jsonb:return Pl(e);case je.timestamp:return Rl(e);case je.abstime:case je.date:case je.daterange:case je.int4range:case je.int8range:case je.money:case je.reltime:case je.text:case je.time:case je.timestamptz:case je.timetz:case je.tsrange:case je.tstzrange:return ui(e);default:return ui(e)}},ui=n=>n,Tl=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Cl=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Pl=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Ll=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let o;const a=n.slice(1,t);try{o=JSON.parse("["+a+"]")}catch{o=a?a.split(","):[]}return o.map(g=>Da(e,g))}return n},Rl=n=>typeof n=="string"?n.replace(" ","T"):n,Ma=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class In{constructor(e,t,r={},i=Na){this.channel=e,this.event=t,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var lo;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(lo||(lo={}));class Cr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:o,onLeave:a,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Cr.syncState(this.state,i,o,a),this.pendingDiffs.forEach(d=>{this.state=Cr.syncDiff(this.state,d,o,a)}),this.pendingDiffs=[],g()}),this.channel._on(r.diff,{},i=>{const{onJoin:o,onLeave:a,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Cr.syncDiff(this.state,i,o,a),g())}),this.onJoin((i,o,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:a})}),this.onLeave((i,o,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,i){const o=this.cloneDeep(e),a=this.transformState(t),g={},d={};return this.map(o,(v,u)=>{a[v]||(d[v]=u)}),this.map(a,(v,u)=>{const f=o[v];if(f){const l=u.map(b=>b.presence_ref),c=f.map(b=>b.presence_ref),_=u.filter(b=>c.indexOf(b.presence_ref)<0),y=f.filter(b=>l.indexOf(b.presence_ref)<0);_.length>0&&(g[v]=_),y.length>0&&(d[v]=y)}else g[v]=u}),this.syncDiff(o,{joins:g,leaves:d},r,i)}static syncDiff(e,t,r,i){const{joins:o,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(o,(g,d)=>{var v;const u=(v=e[g])!==null&&v!==void 0?v:[];if(e[g]=this.cloneDeep(d),u.length>0){const f=e[g].map(c=>c.presence_ref),l=u.filter(c=>f.indexOf(c.presence_ref)<0);e[g].unshift(...l)}r(g,u,d)}),this.map(a,(g,d)=>{let v=e[g];if(!v)return;const u=d.map(f=>f.presence_ref);v=v.filter(f=>u.indexOf(f.presence_ref)<0),e[g]=v,i(g,v,d),v.length===0&&delete e[g]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const i=e[r];return"metas"in i?t[r]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[r]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var co;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(co||(co={}));var uo;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(uo||(uo={}));var vt;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(vt||(vt={}));class Pi{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Qe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new In(this,at.join,this.params,this.timeout),this.rejoinTimer=new Ia(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Qe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Qe.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Qe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Qe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(at.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new Cr(this),this.broadcastEndpointURL=Ma(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:a,private:g}}=this.params;this._onError(u=>e==null?void 0:e(vt.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(vt.CLOSED));const d={},v={broadcast:o,presence:a,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[],private:g};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:v},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){e==null||e(vt.SUBSCRIBED);return}else{const l=this.bindings.postgres_changes,c=(f=l==null?void 0:l.length)!==null&&f!==void 0?f:0,_=[];for(let y=0;y<c;y++){const b=l[y],{filter:{event:h,schema:m,table:x,filter:p}}=b,w=u&&u[y];if(w&&w.event===h&&w.schema===m&&w.table===x&&w.filter===p)_.push(Object.assign(Object.assign({},b),{id:w.id}));else{this.unsubscribe(),e==null||e(vt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e(vt.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(vt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(vt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:a}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{const v=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=v.body)===null||i===void 0?void 0:i.cancel()),v.ok?"ok":"error"}catch(v){return v.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,g,d;const v=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(g=(a=this.params)===null||a===void 0?void 0:a.config)===null||g===void 0?void 0:g.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),v.receive("ok",()=>o("ok")),v.receive("error",()=>o("error")),v.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Qe.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(at.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new In(this,at.leave,{},e);i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const i=new AbortController,o=setTimeout(()=>i.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(o),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new In(this,e,t,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var i,o;const a=e.toLocaleLowerCase(),{close:g,error:d,leave:v,join:u}=at;if(r&&[g,d,v,u].indexOf(a)>=0&&r!==this._joinRef())return;let l=this._onMessage(a,t,r);if(t&&!l)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(c=>{var _,y,b;return((_=c.filter)===null||_===void 0?void 0:_.event)==="*"||((b=(y=c.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===a}).map(c=>c.callback(l,r)):(o=this.bindings[a])===null||o===void 0||o.filter(c=>{var _,y,b,h,m,x;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in c){const p=c.id,w=(_=c.filter)===null||_===void 0?void 0:_.event;return p&&((y=t.ids)===null||y===void 0?void 0:y.includes(p))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((b=t.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const p=(m=(h=c==null?void 0:c.filter)===null||h===void 0?void 0:h.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return p==="*"||p===((x=t==null?void 0:t.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return c.type.toLocaleLowerCase()===a}).map(c=>{if(typeof l=="object"&&"ids"in l){const _=l.data,{schema:y,table:b,commit_timestamp:h,type:m,errors:x}=_;l=Object.assign(Object.assign({},{schema:y,table:b,commit_timestamp:h,eventType:m,new:{},old:{},errors:x}),this._getPayloadRecords(_))}c.callback(l,r)})}_isClosed(){return this.state===Qe.closed}_isJoined(){return this.state===Qe.joined}_isJoining(){return this.state===Qe.joining}_isLeaving(){return this.state===Qe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const i=e.toLocaleLowerCase(),o={type:i,filter:t,callback:r};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&Pi.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(at.close,{},e)}_onError(e){this._on(at.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Qe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=so(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=so(e.columns,e.old_record)),t}}const Nl=()=>{},Il=typeof WebSocket<"u",Dl=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ml{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=El,this.params={},this.timeout=Na,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Nl,this.conn=null,this.sendBuffer=[],this.serializer=new Sl,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let a;return o?a=o:typeof fetch>"u"?a=(...g)=>nr(async()=>{const{default:d}=await Promise.resolve().then(()=>ar);return{default:d}},void 0).then(({default:d})=>d(...g)):a=fetch,(...g)=>a(...g)},this.endPoint=`${e}/${ci.websocket}`,this.httpEndpoint=Ma(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(o,a)=>a(JSON.stringify(o)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ia(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Il){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Bl(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),nr(async()=>{const{default:e}=await import("./browser-DqV9_OhW.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1])).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ol}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case tr.connecting:return Mt.Connecting;case tr.open:return Mt.Open;case tr.closing:return Mt.Closing;default:return Mt.Closed}}isConnected(){return this.connectionState()===Mt.Open}channel(e,t={config:{}}){const r=new Pi(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:i,ref:o}=e,a=()=>{this.encode(e,g=>{var d;(d=this.conn)===null||d===void 0||d.send(g)})};this.log("push",`${t} ${r} (${o})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(at.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(jl,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:i,payload:o,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${r} ${i} ${a&&"("+a+")"||""}`,o),this.channels.filter(g=>g._isMember(r)).forEach(g=>g._trigger(i,o,a)),this.stateChangeCallbacks.message.forEach(g=>g(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(at.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${r}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Dl],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Bl{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=tr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Li extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function De(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class $l extends Li{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class fi extends Li{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ql=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function g(u){try{v(r.next(u))}catch(f){a(f)}}function d(u){try{v(r.throw(u))}catch(f){a(f)}}function v(u){u.done?o(u.value):i(u.value).then(g,d)}v((r=r.apply(n,e||[])).next())})};const Ba=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>nr(async()=>{const{default:r}=await Promise.resolve().then(()=>ar);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ul=()=>ql(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield nr(()=>Promise.resolve().then(()=>ar),void 0)).Response:Response}),di=n=>{if(Array.isArray(n))return n.map(t=>di(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const i=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[i]=di(r)}),e};var Ut=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function g(u){try{v(r.next(u))}catch(f){a(f)}}function d(u){try{v(r.throw(u))}catch(f){a(f)}}function v(u){u.done?o(u.value):i(u.value).then(g,d)}v((r=r.apply(n,e||[])).next())})};const Dn=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Fl=(n,e,t)=>Ut(void 0,void 0,void 0,function*(){const r=yield Ul();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(i=>{e(new $l(Dn(i),n.status||500))}).catch(i=>{e(new fi(Dn(i),i))}):e(new fi(Dn(n),n))}),zl=(n,e,t,r)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),t))};function Ir(n,e,t,r,i,o){return Ut(this,void 0,void 0,function*(){return new Promise((a,g)=>{n(t,zl(e,r,i,o)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>a(d)).catch(d=>Fl(d,g,r))})})}function en(n,e,t,r){return Ut(this,void 0,void 0,function*(){return Ir(n,"GET",e,t,r)})}function wt(n,e,t,r,i){return Ut(this,void 0,void 0,function*(){return Ir(n,"POST",e,r,i,t)})}function Hl(n,e,t,r,i){return Ut(this,void 0,void 0,function*(){return Ir(n,"PUT",e,r,i,t)})}function Wl(n,e,t,r){return Ut(this,void 0,void 0,function*(){return Ir(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function $a(n,e,t,r,i){return Ut(this,void 0,void 0,function*(){return Ir(n,"DELETE",e,r,i,t)})}var Je=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function g(u){try{v(r.next(u))}catch(f){a(f)}}function d(u){try{v(r.throw(u))}catch(f){a(f)}}function v(u){u.done?o(u.value):i(u.value).then(g,d)}v((r=r.apply(n,e||[])).next())})};const Gl={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},fo={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Kl{constructor(e,t={},r,i){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Ba(i)}uploadOrUpdate(e,t,r,i){return Je(this,void 0,void 0,function*(){try{let o;const a=Object.assign(Object.assign({},fo),i);let g=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const d=a.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",a.cacheControl),d&&o.append("metadata",this.encodeMetadata(d)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",a.cacheControl),d&&o.append("metadata",this.encodeMetadata(d))):(o=r,g["cache-control"]=`max-age=${a.cacheControl}`,g["content-type"]=a.contentType,d&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),i!=null&&i.headers&&(g=Object.assign(Object.assign({},g),i.headers));const v=this._removeEmptyFolders(t),u=this._getFinalPath(v),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:o,headers:g},a!=null&&a.duplex?{duplex:a.duplex}:{})),l=yield f.json();return f.ok?{data:{path:v,id:l.Id,fullPath:l.Key},error:null}:{data:null,error:l}}catch(o){if(De(o))return{data:null,error:o};throw o}})}upload(e,t,r){return Je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,i){return Je(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),a=this._getFinalPath(o),g=new URL(this.url+`/object/upload/sign/${a}`);g.searchParams.set("token",t);try{let d;const v=Object.assign({upsert:fo.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(v.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",v.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",v.cacheControl)):(d=r,u["cache-control"]=`max-age=${v.cacheControl}`,u["content-type"]=v.contentType);const f=yield this.fetch(g.toString(),{method:"PUT",body:d,headers:u}),l=yield f.json();return f.ok?{data:{path:o,fullPath:l.Key},error:null}:{data:null,error:l}}catch(d){if(De(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,t){return Je(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const o=yield wt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),a=new URL(this.url+o.url),g=a.searchParams.get("token");if(!g)throw new Li("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:g},error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}})}update(e,t,r){return Je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Je(this,void 0,void 0,function*(){try{return{data:yield wt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(De(i))return{data:null,error:i};throw i}})}copy(e,t,r){return Je(this,void 0,void 0,function*(){try{return{data:{path:(yield wt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(De(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,r){return Je(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),o=yield wt(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${a}`)},{data:o,error:null}}catch(i){if(De(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,r){return Je(this,void 0,void 0,function*(){try{const i=yield wt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${o}`):null})),error:null}}catch(i){if(De(i))return{data:null,error:i};throw i}})}download(e,t){return Je(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=o?`?${o}`:"";try{const g=this._getFinalPath(e);return{data:yield(yield en(this.fetch,`${this.url}/${i}/${g}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(g){if(De(g))return{data:null,error:g};throw g}})}info(e){return Je(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield en(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:di(r),error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}})}exists(e){return Je(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Wl(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(De(r)&&r instanceof fi){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),i=[],o=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&i.push(o);const g=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});d!==""&&i.push(d);let v=i.join("&");return v!==""&&(v=`?${v}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${r}${v}`)}}}remove(e){return Je(this,void 0,void 0,function*(){try{return{data:yield $a(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(De(t))return{data:null,error:t};throw t}})}list(e,t,r){return Je(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Gl),t),{prefix:e||""});return{data:yield wt(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(De(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Vl="2.7.1",Yl={"X-Client-Info":`storage-js/${Vl}`};var Yt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function g(u){try{v(r.next(u))}catch(f){a(f)}}function d(u){try{v(r.throw(u))}catch(f){a(f)}}function v(u){u.done?o(u.value):i(u.value).then(g,d)}v((r=r.apply(n,e||[])).next())})};class Jl{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Yl),t),this.fetch=Ba(r)}listBuckets(){return Yt(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(De(e))return{data:null,error:e};throw e}})}getBucket(e){return Yt(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(De(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Yt(this,void 0,void 0,function*(){try{return{data:yield wt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Yt(this,void 0,void 0,function*(){try{return{data:yield Hl(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Yt(this,void 0,void 0,function*(){try{return{data:yield wt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(De(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Yt(this,void 0,void 0,function*(){try{return{data:yield $a(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(De(t))return{data:null,error:t};throw t}})}}class Zl extends Jl{constructor(e,t={},r){super(e,t,r)}from(e){return new Kl(this.url,this.headers,e,this.fetch)}}const Xl="2.49.1";let Sr="";typeof Deno<"u"?Sr="deno":typeof document<"u"?Sr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Sr="react-native":Sr="node";const Ql={"X-Client-Info":`supabase-js-${Sr}/${Xl}`},ec={headers:Ql},tc={schema:"public"},rc={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},nc={};var ic=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function g(u){try{v(r.next(u))}catch(f){a(f)}}function d(u){try{v(r.throw(u))}catch(f){a(f)}}function v(u){u.done?o(u.value):i(u.value).then(g,d)}v((r=r.apply(n,e||[])).next())})};const oc=n=>{let e;return n?e=n:typeof fetch>"u"?e=ka:e=fetch,(...t)=>e(...t)},ac=()=>typeof Headers>"u"?Ea:Headers,sc=(n,e,t)=>{const r=oc(t),i=ac();return(o,a)=>ic(void 0,void 0,void 0,function*(){var g;const d=(g=yield e())!==null&&g!==void 0?g:n;let v=new i(a==null?void 0:a.headers);return v.has("apikey")||v.set("apikey",n),v.has("Authorization")||v.set("Authorization",`Bearer ${d}`),r(o,Object.assign(Object.assign({},a),{headers:v}))})};var lc=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function g(u){try{v(r.next(u))}catch(f){a(f)}}function d(u){try{v(r.throw(u))}catch(f){a(f)}}function v(u){u.done?o(u.value):i(u.value).then(g,d)}v((r=r.apply(n,e||[])).next())})};function cc(n){return n.replace(/\/$/,"")}function uc(n,e){const{db:t,auth:r,realtime:i,global:o}=n,{db:a,auth:g,realtime:d,global:v}=e,u={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},g),r),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign({},v),o),accessToken:()=>lc(this,void 0,void 0,function*(){return""})};return n.accessToken?u.accessToken=n.accessToken:delete u.accessToken,u}const qa="2.68.0",Xt=30*1e3,hi=3,Mn=hi*Xt,fc="http://localhost:9999",dc="supabase.auth.token",hc={"X-Client-Info":`gotrue-js/${qa}`},pi="X-Supabase-Api-Version",Ua={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function pc(n){return Math.round(Date.now()/1e3)+n}function gc(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const ft=()=>typeof window<"u"&&typeof document<"u",Rt={tested:!1,writable:!1},Pr=()=>{if(!ft())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rt.tested)return Rt.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Rt.tested=!0,Rt.writable=!0}catch{Rt.tested=!0,Rt.writable=!1}return Rt.writable};function vc(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,o)=>{e[o]=i})}catch{}return t.searchParams.forEach((r,i)=>{e[i]=r}),e}const Fa=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>nr(async()=>{const{default:r}=await Promise.resolve().then(()=>ar);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},yc=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",za=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Fr=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},zr=async(n,e)=>{await n.removeItem(e)};function mc(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,i,o,a,g,d,v,u=0;for(n=n.replace("-","+").replace("_","/");u<n.length;)a=e.indexOf(n.charAt(u++)),g=e.indexOf(n.charAt(u++)),d=e.indexOf(n.charAt(u++)),v=e.indexOf(n.charAt(u++)),r=a<<2|g>>4,i=(g&15)<<4|d>>2,o=(d&3)<<6|v,t=t+String.fromCharCode(r),d!=64&&i!=0&&(t=t+String.fromCharCode(i)),v!=64&&o!=0&&(t=t+String.fromCharCode(o));return t}class wn{constructor(){this.promise=new wn.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}wn.promiseConstructor=Promise;function ho(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(mc(r))}async function bc(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function _c(n,e){return new Promise((r,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const a=await n(o);if(!e(o,null,a)){r(a);return}}catch(a){if(!e(o,a)){i(a);return}}})()})}function xc(n){return("0"+n.toString(16)).substr(-2)}function wc(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let i="";for(let o=0;o<56;o++)i+=t.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,xc).join("")}async function kc(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(r);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}function Ec(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Oc(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await kc(n);return Ec(t)}async function Jt(n,e,t=!1){const r=wc();let i=r;t&&(i+="/PASSWORD_RECOVERY"),await za(n,`${e}-code-verifier`,i);const o=await Oc(r);return[o,r===o?"plain":"s256"]}const jc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Sc(n){const e=n.headers.get(pi);if(!e||!e.match(jc))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Ri extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function ge(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Ac extends Ri{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Tc(n){return ge(n)&&n.name==="AuthApiError"}class Ha extends Ri{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ft extends Ri{constructor(e,t,r,i){super(e,r,i),this.name=t,this.status=r}}class _t extends Ft{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Cc(n){return ge(n)&&n.name==="AuthSessionMissingError"}class Bn extends Ft{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hr extends Ft{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Wr extends Ft{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Pc(n){return ge(n)&&n.name==="AuthImplicitGrantRedirectError"}class po extends Ft{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gi extends Ft{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function $n(n){return ge(n)&&n.name==="AuthRetryableFetchError"}class go extends Ft{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var Lc=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Nt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Rc=[502,503,504];async function vo(n){var e;if(!yc(n))throw new gi(Nt(n),0);if(Rc.includes(n.status))throw new gi(Nt(n),n.status);let t;try{t=await n.json()}catch(o){throw new Ha(Nt(o),o)}let r;const i=Sc(n);if(i&&i.getTime()>=Ua["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new go(Nt(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new _t}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,a)=>o&&typeof a=="string",!0))throw new go(Nt(t),n.status,t.weak_password.reasons);throw new Ac(Nt(t),n.status||500,r)}const Nc=(n,e,t,r)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),t))};async function me(n,e,t,r){var i;const o=Object.assign({},r==null?void 0:r.headers);o[pi]||(o[pi]=Ua["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const a=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const g=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",d=await Ic(n,e,t+g,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}}async function Ic(n,e,t,r,i,o){const a=Nc(e,r,i,o);let g;try{g=await n(t,Object.assign({},a))}catch(d){throw console.error(d),new gi(Nt(d),0)}if(g.ok||await vo(g),r!=null&&r.noResolveJson)return g;try{return await g.json()}catch(d){await vo(d)}}function xt(n){var e;let t=null;$c(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=pc(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function yo(n){const e=xt(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function kt(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Dc(n){return{data:n,error:null}}function Mc(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:o}=n,a=Lc(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:o},d=Object.assign({},a);return{data:{properties:g,user:d},error:null}}function Bc(n){return n}function $c(n){return n.access_token&&n.refresh_token&&n.expires_in}var qc=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Uc{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Fa(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await me(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:kt})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=qc(e,["options"]),i=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Mc,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ge(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:kt})}catch(t){if(ge(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,i,o,a,g,d;try{const v={nextPage:null,lastPage:0,total:0},u=await me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(o=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:Bc});if(u.error)throw u.error;const f=await u.json(),l=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,c=(d=(g=u.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&d!==void 0?d:[];return c.length>0&&(c.forEach(_=>{const y=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(_.split(";")[1].split("=")[1]);v[`${b}Page`]=y}),v.total=parseInt(l)),{data:Object.assign(Object.assign({},f),v),error:null}}catch(v){if(ge(v))return{data:{users:[]},error:v};throw v}}async getUserById(e){try{return await me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:kt})}catch(t){if(ge(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:kt})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:kt})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:r}}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}}}const Fc={getItem:n=>Pr()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Pr()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Pr()&&globalThis.localStorage.removeItem(n)}};function mo(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function zc(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Zt={debug:!!(globalThis&&Pr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Wa extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Hc extends Wa{}async function Wc(n,e,t){Zt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Zt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Zt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return await t()}finally{Zt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(e===0)throw Zt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Hc(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Zt.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}zc();const Gc={url:fc,storageKey:dc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:hc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function bo(n,e,t){return await t()}class Rr{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Rr.nextInstanceID,Rr.nextInstanceID+=1,this.instanceID>0&&ft()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Gc),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Uc({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Fa(i.fetch),this.lock=i.lock||bo,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:ft()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Wc:this.lock=bo,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Pr()?this.storage=Fc:(this.memoryStorage={},this.storage=mo(this.memoryStorage)):(this.memoryStorage={},this.storage=mo(this.memoryStorage)),ft()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${qa}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=vc(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),ft()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:o}=await this._getSessionFromURL(t,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Pc(o)){const d=(e=o.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:a,redirectType:g}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",g),await this._saveSession(a),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ge(t)?{error:t}:{error:new Ha("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,i;try{const o=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:xt}),{data:a,error:g}=o;if(g||!a)return{data:{user:null,session:null},error:g};const d=a.session,v=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:v,session:d},error:null}}catch(o){if(ge(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var t,r,i;try{let o;if("email"in e){const{email:u,password:f,options:l}=e;let c=null,_=null;this.flowType==="pkce"&&([c,_]=await Jt(this.storage,this.storageKey)),o=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:l==null?void 0:l.emailRedirectTo,body:{email:u,password:f,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:_},xform:xt})}else if("phone"in e){const{phone:u,password:f,options:l}=e;o=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xt})}else throw new Hr("You must provide either an email or phone number and a password");const{data:a,error:g}=o;if(g||!a)return{data:{user:null,session:null},error:g};const d=a.session,v=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:v,session:d},error:null}}catch(o){if(ge(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:a,options:g}=e;t=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:yo})}else if("phone"in e){const{phone:o,password:a,options:g}=e;t=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:yo})}else throw new Hr("You must provide either an email or phone number and a password");const{data:r,error:i}=t;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Bn}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,i,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Fr(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(t??"").split("/");try{const{data:o,error:a}=await me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:xt});if(await zr(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Bn}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:a})}catch(o){if(ge(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:t,provider:r,token:i,access_token:o,nonce:a}=e,g=await me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:xt}),{data:d,error:v}=g;return v?{data:{user:null,session:null},error:v}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Bn}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:v})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,i,o,a;try{if("email"in e){const{email:g,options:d}=e;let v=null,u=null;this.flowType==="pkce"&&([v,u]=await Jt(this.storage,this.storageKey));const{error:f}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:v,code_challenge_method:u},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:g,options:d}=e,{data:v,error:u}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(i=d==null?void 0:d.data)!==null&&i!==void 0?i:{},create_user:(o=d==null?void 0:d.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(a=d==null?void 0:d.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:v==null?void 0:v.message_id},error:u}}throw new Hr("You must provide either an email or phone number.")}catch(g){if(ge(g))return{data:{user:null,session:null},error:g};throw g}}async verifyOtp(e){var t,r;try{let i,o;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:g}=await me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:xt});if(g)throw g;if(!a)throw new Error("An error occurred on token verification.");const d=a.session,v=a.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:v,session:d},error:null}}catch(i){if(ge(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,r,i;try{let o=null,a=null;return this.flowType==="pkce"&&([o,a]=await Jt(this.storage,this.storageKey)),await me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:Dc})}catch(o){if(ge(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new _t;const{error:i}=await me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(ge(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:o}=e,{error:a}=await me(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:i,options:o}=e,{data:a,error:g}=await me(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:g}}throw new Hr("You must provide either an email or phone number and a type")}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Fr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Mn:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,v,u)=>(!a&&v==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,v,u))})}return{data:{session:e},error:null}}const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:kt}):await this._useSession(async t=>{var r,i,o;const{data:a,error:g}=t;if(g)throw g;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _t}:await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:kt})})}catch(t){if(ge(t))return Cc(t)&&(await this._removeSession(),await zr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:i,error:o}=r;if(o)throw o;if(!i.session)throw new _t;const a=i.session;let g=null,d=null;this.flowType==="pkce"&&e.email!=null&&([g,d]=await Jt(this.storage,this.storageKey));const{data:v,error:u}=await me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:g,code_challenge_method:d}),jwt:a.access_token,xform:kt});if(u)throw u;return a.user=v.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return ho(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new _t;const t=Date.now()/1e3;let r=t,i=!0,o=null;const a=ho(e.access_token);if(a.exp&&(r=a.exp,i=r<=t),i){const{session:g,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!g)return{data:{user:null,session:null},error:null};o=g}else{const{data:g,error:d}=await this._getUser(e.access_token);if(d)throw d;o={access_token:e.access_token,refresh_token:e.refresh_token,user:g.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(ge(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:g}=t;if(g)throw g;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new _t;const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!ft())throw new Wr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Wr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new po("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wr("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new po("No code detected.");const{data:m,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const p=new URL(window.location.href);return p.searchParams.delete("code"),window.history.replaceState(window.history.state,"",p.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:o,refresh_token:a,expires_in:g,expires_at:d,token_type:v}=e;if(!o||!g||!a||!v)throw new Wr("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(g);let l=u+f;d&&(l=parseInt(d));const c=l-u;c*1e3<=Xt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${c}s, should have been closer to ${f}s`);const _=l-f;u-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,l,u):u-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,l,u);const{data:y,error:b}=await this._getUser(o);if(b)throw b;const h={provider_token:r,provider_refresh_token:i,access_token:o,expires_in:f,expires_at:l,refresh_token:a,token_type:v,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:h,redirectType:e.type},error:null}}catch(r){if(ge(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Fr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:i,error:o}=t;if(o)return{error:o};const a=(r=i.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:g}=await this.admin.signOut(a,e);if(g&&!(Tc(g)&&(g.status===404||g.status===401||g.status===403)))return{error:g}}return e!=="others"&&(await this._removeSession(),await zr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=gc(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,i;try{const{data:{session:o},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Jt(this.storage,this.storageKey,!0));try{return await me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(ge(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:i}=await this._useSession(async o=>{var a,g,d,v,u;const{data:f,error:l}=o;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(g=e.options)===null||g===void 0?void 0:g.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await me(this.fetch,"GET",c,{headers:this.headers,jwt:(u=(v=f.session)===null||v===void 0?void 0:v.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return ft()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ge(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,i;const{data:o,error:a}=t;if(a)throw a;return await me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await _c(async i=>(i>0&&await bc(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:xt})),(i,o)=>{const a=200*Math.pow(2,i);return o&&$n(o)&&Date.now()+a-r<Xt})}catch(r){if(this._debug(t,"error",r),ge(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),ft()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Fr(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Mn;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${Mn}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),$n(o)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new _t;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new wn;const{data:o,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new _t;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const g={session:o.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(o){if(this._debug(i,"error",o),ge(o)){const a={session:null,error:o};return $n(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],a=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(e,t)}catch(d){o.push(d)}});if(await Promise.all(a),o.length>0){for(let g=0;g<o.length;g+=1)console.error(o[g]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await za(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await zr(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ft()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/Xt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Xt}ms, refresh threshold is ${hi} ticks`),i<=hi&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Wa)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ft()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const i=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,a]=await Jt(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(g.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);i.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:i,error:o}=t;return o?{data:null,error:o}:await me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,i;const{data:o,error:a}=t;if(a)return{data:null,error:a};const g=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:v}=await me(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return v?{data:null,error:v}:(e.factorType==="totp"&&(!((i=d==null?void 0:d.totp)===null||i===void 0)&&i.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:o}=t;if(o)return{data:null,error:o};const{data:a,error:g}=await me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:g})})}catch(t){if(ge(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:o}=t;return o?{data:null,error:o}:await me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ge(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],i=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),o=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:i,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:i},error:o}=e;if(o)return{data:null,error:o};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(i.access_token);let g=null;a.aal&&(g=a.aal);let d=g;((r=(t=i.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const u=a.amr||[];return{data:{currentLevel:g,nextLevel:d,currentAuthenticationMethods:u},error:null}}))}}Rr.nextInstanceID=0;const Kc=Rr;class Vc extends Kc{constructor(e){super(e)}}var Yc=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function g(u){try{v(r.next(u))}catch(f){a(f)}}function d(u){try{v(r.throw(u))}catch(f){a(f)}}function v(u){u.done?o(u.value):i(u.value).then(g,d)}v((r=r.apply(n,e||[])).next())})};class Jc{constructor(e,t,r){var i,o,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const g=cc(e);this.realtimeUrl=`${g}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${g}/auth/v1`,this.storageUrl=`${g}/storage/v1`,this.functionsUrl=`${g}/functions/v1`;const d=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,v={db:tc,realtime:nc,auth:Object.assign(Object.assign({},rc),{storageKey:d}),global:ec},u=uc(r??{},v);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,l)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(l)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=sc(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new wl(`${g}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new Xs(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Zl(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Yc(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,storageKey:o,flowType:a,lock:g,debug:d},v,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Vc({url:this.authUrl,headers:Object.assign(Object.assign({},f),v),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,flowType:a,lock:g,debug:d,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Ml(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Zc=(n,e,t)=>new Jc(n,e,t),Ga="https://yggftjdbznludnoqukzf.supabase.co",_o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlnZ2Z0amRiem5sdWRub3F1a3pmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2MTUzODQsImV4cCI6MjA1NzE5MTM4NH0.8GCOMXCwzEgQ09RcPcNlzMcie3SW3Jj7HIq9m2gE4vw",Xc="http://localhost:5173";console.log("Supabase URL:",Ga);console.log("Redirect URL:",Xc);const le=Zc(Ga,_o,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:{getItem:n=>{try{const e=localStorage.getItem(n);return e?JSON.parse(e):null}catch(e){return console.error("Error getting auth from localStorage:",e),null}},setItem:(n,e)=>{try{localStorage.setItem(n,JSON.stringify(e))}catch(t){console.error("Error setting auth in localStorage:",t)}},removeItem:n=>{try{localStorage.removeItem(n)}catch(e){console.error("Error removing auth from localStorage:",e)}}}},global:{headers:{apikey:_o}}}),Qc=async()=>{console.log("[fetchCategories] Starting fetch");try{console.log("[fetchCategories] Executing supabase query:",{table:"Categories",select:"id, name, display_order, status, image_url, click_count",filters:{status:!0},order:"display_order",limit:6});const{data:n,error:e}=await le.from("Categories").select("id, name, display_order, status, image_url, click_count").eq("status",!0).order("display_order",{ascending:!0}).limit(6);if(console.log("[fetchCategories] Raw supabase response:",{data:n,error:e}),e)throw console.error("[fetchCategories] Supabase error:",{message:e.message,code:e.code,details:e.details,hint:e.hint}),e;return console.log("[fetchCategories] Successful response data:",n),{data:n,error:null}}catch(n){return console.error("[fetchCategories] General error:",{errorName:n.name,errorMessage:n.message,stack:n.stack}),{data:null,error:n}}},eu=async()=>{console.log("[fetchFeaturedBooks] Starting fetch");try{console.log("[fetchFeaturedBooks] Executing supabase query:",{table:"Books",select:"id, title, cover_image, status, avg_rating, click_count, category_id, Categories ( name )",filters:{status:!0},order:"avg_rating",limit:5});const{data:n,error:e}=await le.from("Books").select(`
        id, 
        title, 
        cover_image, 
        status,
        avg_rating,
        click_count,
        category_id,
        Categories (
          name
        )
      `).eq("status",!0).order("avg_rating",{ascending:!1}).limit(5);if(console.log("[fetchFeaturedBooks] Raw supabase response:",{data:n,error:e}),e)throw console.error("[fetchFeaturedBooks] Supabase error:",{message:e.message,code:e.code,details:e.details,hint:e.hint}),e;return console.log("[fetchFeaturedBooks] Successful response data:",n),{data:n,error:null}}catch(n){return console.error("[fetchFeaturedBooks] General error:",{errorName:n.name,errorMessage:n.message,stack:n.stack}),{data:null,error:n}}},Ka=async n=>{try{const{data:e,error:t}=await le.rpc("increment_book_clicks",{book_id:n});if(t)throw t;return{data:e,error:null}}catch(e){return console.error("Error incrementing book clicks:",e),{data:null,error:e}}},tu=async n=>{try{const{data:e,error:t}=await le.rpc("increment_category_clicks",{category_id:n});if(t)throw t;return{data:e,error:null}}catch(e){return console.error("Error incrementing category clicks:",e),{data:null,error:e}}},ru=async n=>{try{console.log("Fetching bookmarks for user:",n);const e=3;let t=0,r=null;for(;t<e;)try{const{data:i,error:o}=await le.from("Bookmarks").select(`
            id,
            created_at,
            Books (
              id,
              title,
              cover_image,
              avg_rating,
              category_id,
              Categories (
                name
              )
            )
          `).eq("user_id",n).order("created_at",{ascending:!1});if(o)throw o;return console.log(`Successfully fetched ${(i==null?void 0:i.length)||0} bookmarks`),{data:i,error:null}}catch(i){if(r=i,t++,console.error(`Attempt ${t} failed:`,i),t<e){const o=Math.pow(2,t)*500;await new Promise(a=>setTimeout(a,o))}}return console.error("All bookmark fetch attempts failed:",r),{data:[],error:r}}catch(e){return console.error("Error fetching bookmarks:",e),{data:[],error:e}}},Va=async(n,e)=>{try{console.log("Toggling bookmark for book:",n,"user:",e);const{data:t,error:r}=await le.from("Bookmarks").select("id").eq("book_id",n).eq("user_id",e).maybeSingle();if(r)throw r;if(t){console.log("Removing existing bookmark");const{error:i}=await le.from("Bookmarks").delete().eq("book_id",n).eq("user_id",e);if(i)throw i;return{data:{action:"removed"},error:null}}else{console.log("Adding new bookmark");const{data:i,error:o}=await le.from("Bookmarks").insert([{book_id:n,user_id:e}]).select().single();if(o)throw o;return{data:{...i,action:"added"},error:null}}}catch(t){return console.error("Error toggling bookmark:",t),{data:null,error:t}}},nu={brand:{50:"#f0f4ff",100:"#d9e4ff",200:"#b3c5ff",300:"#8da6ff",400:"#6687ff",500:"#4068ff",600:"#3352cc",700:"#263d99",800:"#1a2966",900:"#0d1433"},accent:{50:"#f5f0ff",100:"#ebe0ff",200:"#d6c2ff",300:"#c2a3ff",400:"#ad85ff",500:"#9966ff",600:"#7a52cc",700:"#5c3d99",800:"#3d2966",900:"#1f1433"}},iu={colors:{"bg.default":{default:"gray.50",_dark:"gray.900"},"bg.subtle":{default:"gray.100",_dark:"gray.800"},"bg.muted":{default:"gray.200",_dark:"gray.700"},"text.default":{default:"gray.900",_dark:"gray.50"},"text.muted":{default:"gray.600",_dark:"gray.400"},"border.default":{default:"gray.200",_dark:"gray.700"}}},ou={global:n=>({body:{bg:"bg.default",color:"text.default"},":root":{"--gradient-start":n.colorMode==="dark"?"brand.800":"brand.50","--gradient-end":n.colorMode==="dark"?"accent.800":"accent.50"}})},au={Button:{baseStyle:{fontWeight:"semibold",borderRadius:"lg"},variants:{solid:n=>({bg:(n.colorMode==="dark","brand.500"),color:"white",_hover:{bg:(n.colorMode==="dark","brand.600")}}),outline:{borderWidth:"2px"}}},Card:{baseStyle:{container:{bg:"bg.subtle",borderRadius:"xl",boxShadow:"lg"}}},Heading:{baseStyle:{fontWeight:"bold"}}},su={initialColorMode:"system",useSystemColorMode:!0};hn({colors:nu,semanticTokens:iu,styles:ou,components:au,config:su,fonts:{heading:`'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"`,body:`'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"`},shadows:{outline:"0 0 0 3px rgba(66, 153, 225, 0.6)"}});const lu={primary:{50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c"},secondary:{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"}},cu={colors:{"bg.default":{default:"primary.50",_dark:"gray.900"},"bg.subtle":{default:"white",_dark:"gray.800"},"bg.muted":{default:"primary.100",_dark:"gray.700"},"text.default":{default:"gray.900",_dark:"gray.50"},"text.muted":{default:"primary.700",_dark:"primary.200"},"border.default":{default:"primary.100",_dark:"primary.900"}}},uu={Button:{defaultProps:{colorScheme:"primary"},variants:{solid:{bg:"primary.500",color:"white",_hover:{bg:"primary.600",transform:"translateY(-1px)",boxShadow:"md"},transition:"all 0.2s"},outline:{borderColor:"primary.500",color:"primary.500",_hover:{bg:"primary.50"}}}},Heading:{baseStyle:{color:"primary.700",fontWeight:"semibold",_dark:{color:"primary.200"}}},Card:{baseStyle:{container:{borderRadius:"lg",borderColor:"primary.100",_hover:{borderColor:"primary.200",boxShadow:"md"}}}}},fu={global:n=>({body:{bg:"bg.default",color:"text.default"},":root":{"--gradient-start":n.colorMode==="dark"?"primary.800":"primary.50","--gradient-end":n.colorMode==="dark"?"primary.900":"primary.100"}})},du=hn({colors:lu,semanticTokens:cu,components:uu,styles:fu,config:{initialColorMode:"light",useSystemColorMode:!1},fonts:{heading:"Inter, system-ui, sans-serif",body:"Inter, system-ui, sans-serif"}}),hu={brand:{50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1"},accent:{50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b"}},pu={colors:{"bg.default":{default:"gray.50",_dark:"gray.900"},"bg.subtle":{default:"white",_dark:"gray.800"},"text.default":{default:"gray.900",_dark:"gray.50"},"text.muted":{default:"gray.600",_dark:"gray.400"},"border.default":{default:"gray.100",_dark:"gray.700"}}},gu={Button:{defaultProps:{colorScheme:"brand"},variants:{solid:{bg:"brand.500",color:"white",_hover:{bg:"brand.600",transform:"translateY(-2px)",boxShadow:"lg"},transition:"all 0.2s"},ghost:{_hover:{bg:"brand.50"}}}},Card:{baseStyle:{container:{borderRadius:"xl",overflow:"hidden",transition:"all 0.2s",_hover:{transform:"translateY(-4px)",boxShadow:"xl"}}}},Heading:{baseStyle:{color:"brand.700",_dark:{color:"brand.200"}}}},vu={global:n=>({body:{bg:"bg.default",color:"text.default"},":root":{"--gradient-start":n.colorMode==="dark"?"brand.800":"brand.50","--gradient-end":n.colorMode==="dark"?"accent.800":"accent.50"}})},yu=hn({colors:hu,semanticTokens:pu,components:gu,styles:vu,config:{initialColorMode:"light",useSystemColorMode:!1},fonts:{heading:'"Source Sans Pro", system-ui, sans-serif',body:'"Open Sans", system-ui, sans-serif'},shadows:{outline:"0 0 0 3px rgba(66, 153, 225, 0.6)"},radii:{none:"0",sm:"0.25rem",md:"0.5rem",lg:"1rem",xl:"1.5rem","2xl":"2rem",full:"9999px"}});var Ya={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},xo=yt.createContext&&yt.createContext(Ya),mu=["attr","size","title"];function bu(n,e){if(n==null)return{};var t=_u(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function _u(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function tn(){return tn=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},tn.apply(this,arguments)}function wo(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function rn(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wo(Object(t),!0).forEach(function(r){xu(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wo(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function xu(n,e,t){return e=wu(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wu(n){var e=ku(n,"string");return typeof e=="symbol"?e:e+""}function ku(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ja(n){return n&&n.map((e,t)=>yt.createElement(e.tag,rn({key:t},e.attr),Ja(e.child)))}function _e(n){return e=>yt.createElement(Eu,tn({attr:rn({},n.attr)},e),Ja(n.child))}function Eu(n){var e=t=>{var{attr:r,size:i,title:o}=n,a=bu(n,mu),g=i||t.size||"1em",d;return t.className&&(d=t.className),n.className&&(d=(d?d+" ":"")+n.className),yt.createElement("svg",tn({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,a,{className:d,style:rn(rn({color:n.color||t.color},t.style),n.style),height:g,width:g,xmlns:"http://www.w3.org/2000/svg"}),o&&yt.createElement("title",null,o),n.children)};return xo!==void 0?yt.createElement(xo.Consumer,null,t=>e(t)):e(Ya)}function Ou(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(n)}function Za(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(n)}function ju(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"},child:[]}]})(n)}function nn(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"},child:[]},{tag:"path",attr:{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"},child:[]}]})(n)}function ht(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"},child:[]},{tag:"path",attr:{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"},child:[]}]})(n)}function or(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"},child:[]}]})(n)}function br(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(n)}function Su(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(n)}function ko(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 18 22 12 16 6"},child:[]},{tag:"polyline",attr:{points:"8 6 2 12 8 18"},child:[]}]})(n)}function Au(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(n)}function Tu(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 20h9"},child:[]},{tag:"path",attr:{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"},child:[]}]})(n)}function vi(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(n)}function qt(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(n)}function Eo(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"},child:[]},{tag:"line",attr:{x1:"12",y1:"11",x2:"12",y2:"17"},child:[]},{tag:"line",attr:{x1:"9",y1:"14",x2:"15",y2:"14"},child:[]}]})(n)}function Xa(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(n)}function Oo(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"},child:[]},{tag:"polyline",attr:{points:"21 15 16 10 5 21"},child:[]}]})(n)}function jo(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(n)}function qn(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 2 7 12 12 22 7 12 2"},child:[]},{tag:"polyline",attr:{points:"2 17 12 22 22 17"},child:[]},{tag:"polyline",attr:{points:"2 12 12 17 22 12"},child:[]}]})(n)}function Cu(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(n)}function on(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(n)}function Pu(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(n)}function Lu(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 3 21 3 21 9"},child:[]},{tag:"polyline",attr:{points:"9 21 3 21 3 15"},child:[]},{tag:"line",attr:{x1:"21",y1:"3",x2:"14",y2:"10"},child:[]},{tag:"line",attr:{x1:"3",y1:"21",x2:"10",y2:"14"},child:[]}]})(n)}function an(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},child:[]}]})(n)}function So(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(n)}function Ru(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(n)}function Ni(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(n)}function Nu(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"},child:[]},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"},child:[]},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"},child:[]},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"},child:[]},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"},child:[]}]})(n)}function sn(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(n)}function ln(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"},child:[]},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"},child:[]},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"},child:[]},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"},child:[]}]})(n)}function Iu(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(n)}function Du(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(n)}function Ao(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(n)}function yi(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(n)}function Mu(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(n)}function Lr(n){return _e({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(n)}const Lt=()=>{const[n,e]=Q.useState({user:null,loading:!0,error:null});Q.useEffect(()=>{let r=!0,i;const o=async(g,d)=>{if(r)try{if(d!=null&&d.user)console.log("Auth event:",g,"User:",d.user.email),e({user:d.user,loading:!1,error:null});else{const{data:{session:v}}=await le.auth.getSession();e({user:(v==null?void 0:v.user)||null,loading:!1,error:v?null:"No active session"})}}catch(v){e({user:null,loading:!1,error:v.message})}};return(async()=>{try{const{data:{session:g},error:d}=await le.auth.getSession();if(!r)return;if(d)throw d;e({user:(g==null?void 0:g.user)||null,loading:!1,error:null});const{data:{subscription:v}}=le.auth.onAuthStateChange(o);i=v}catch(g){e({user:null,loading:!1,error:g.message})}})(),()=>{r=!1,i==null||i.unsubscribe()}},[]);const t=async()=>{try{e(i=>({...i,loading:!0}));const{error:r}=await le.auth.signOut();if(r)throw r;e({user:null,loading:!1,error:null}),window.location.href="/"}catch(r){throw e(i=>({...i,loading:!1,error:r.message})),r}};return{...n,isAuthenticated:!!n.user,signOut:t}},Bu=()=>{const{colorMode:n,toggleColorMode:e}=Oi();return Lt(),s.jsxs(ne,{minH:"100vh",bgGradient:"linear(to-br, var(--gradient-start), var(--gradient-end))",transition:"all 0.2s",display:"flex",flexDirection:"column",children:[s.jsx(Me,{as:"header",position:"fixed",w:"full",top:0,zIndex:1e3,bg:n==="light"?"whiteAlpha.800":"blackAlpha.800",backdropFilter:"blur(10px)",borderBottom:"1px",borderColor:"border.default",py:4,children:s.jsx(Le,{maxW:"container.xl",children:s.jsxs(Me,{align:"center",justify:"space-between",children:[s.jsxs(rr,{direction:"row",spacing:4,align:"center",children:[s.jsx(Et,{as:Ae,to:"/",_hover:{textDecoration:"none"},children:s.jsx(ke,{size:"md",bgGradient:"linear(to-r, brand.500, accent.500)",bgClip:"text",children:"BookShorts"})}),s.jsxs(rr,{direction:"row",spacing:4,children:[s.jsx(Et,{as:Ae,to:"/",color:"text.muted",_hover:{color:"brand.500"},children:s.jsxs(Me,{align:"center",children:[s.jsx(Xa,{}),s.jsx(oe,{ml:2,children:"Home"})]})}),s.jsx(Et,{as:Ae,to:"/admin",color:"text.muted",_hover:{color:"brand.500"},children:s.jsxs(Me,{align:"center",children:[s.jsx(Ni,{}),s.jsx(oe,{ml:2,children:"Admin"})]})})]})]}),s.jsx(Ge,{"aria-label":"Toggle color mode",icon:n==="light"?s.jsx(an,{}):s.jsx(ln,{}),onClick:e,variant:"ghost",colorScheme:"brand"})]})})}),s.jsx(ne,{as:"main",pt:20,flex:"1",children:s.jsx(xa,{})}),s.jsx(ne,{as:"footer",bg:n==="light"?"whiteAlpha.800":"blackAlpha.800",backdropFilter:"blur(10px)",py:4,borderTop:"1px",borderColor:"border.default",children:s.jsx(Le,{maxW:"container.xl",children:s.jsxs(oe,{textAlign:"center",color:"text.muted",children:["© ",new Date().getFullYear()," BookShorts. All rights reserved."]})})})]})},$u=()=>{const{colorMode:n,toggleColorMode:e}=Oi(),t=pn(),r=ae("white","gray.800"),i=ae("gray.200","gray.700"),o=async()=>{try{await le.auth.signOut(),t("/admin/login")}catch(a){console.error("Error signing out:",a)}};return s.jsxs(ne,{minH:"100vh",bg:ae("gray.50","gray.900"),children:[s.jsx(ne,{as:"header",position:"fixed",w:"full",bg:r,borderBottom:"1px",borderColor:i,py:4,px:8,zIndex:1e3,children:s.jsx(Le,{maxW:"container.xl",children:s.jsxs(Me,{justify:"space-between",align:"center",children:[s.jsx(ke,{size:"md",color:ae("blue.600","blue.400"),children:"BookShorts Admin"}),s.jsxs(ve,{spacing:4,children:[s.jsx(be,{variant:"ghost",onClick:()=>t("/admin"),children:"Dashboard"}),s.jsx(be,{variant:"ghost",onClick:()=>t("/admin/books"),children:"Books"}),s.jsx(be,{variant:"ghost",onClick:()=>t("/admin/content"),children:"Content"}),s.jsx(be,{variant:"ghost",onClick:()=>t("/admin/analytics"),children:"Analytics"}),s.jsx(Ge,{icon:n==="light"?s.jsx(an,{}):s.jsx(ln,{}),onClick:e,variant:"ghost"}),s.jsx(be,{leftIcon:s.jsx(on,{}),onClick:o,colorScheme:"red",variant:"ghost",children:"Sign Out"})]})]})})}),s.jsx(ne,{as:"main",pt:"80px",px:8,pb:8,children:s.jsx(Le,{maxW:"container.xl",children:s.jsx(xa,{})})})]})},qu=({children:n})=>{const{user:e,loading:t,error:r}=Lt(),i=gn();return r?(console.error("Authentication error:",r),s.jsx(Le,{maxW:"container.xl",py:10,children:s.jsxs(tt,{status:"error",borderRadius:"md",children:[s.jsx(rt,{}),"Authentication error: ",r]})})):t?s.jsx(Le,{maxW:"container.xl",py:10,children:s.jsx(ne,{minH:"50vh",display:"flex",alignItems:"center",justifyContent:"center",children:s.jsxs(we,{spacing:4,children:[s.jsx($t,{size:"xl",color:"brand.500",thickness:"4px",speed:"0.65s"}),s.jsx(oe,{color:"gray.500",fontSize:"lg",children:"Loading your profile..."})]})})}):e?n:(console.log("User not authenticated, redirecting to login"),s.jsx(Ai,{to:"/login",state:{from:i.pathname},replace:!0}))};st(ne);const Uu="https://yggftjdbznludnoqukzf.supabase.co/storage/v1/object/public/book-covers/s9i5s7r03n_1741745341926.jpg",Fu=({id:n,title:e,to:t,imageUrl:r,onClick:i})=>s.jsx(Ae,{to:t,onClick:()=>i&&i(n),children:s.jsxs(ne,{position:"relative",overflow:"hidden",borderRadius:"xl",cursor:"pointer",h:"200px",transition:"0.3s",_hover:{transform:"translateY(-4px)",shadow:"xl"},children:[s.jsx(ne,{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:`url(${r||Uu})`,backgroundSize:"cover",backgroundPosition:"center"}),s.jsx(ne,{position:"absolute",top:0,left:0,right:0,bottom:0,bg:"blackAlpha.600",display:"flex",alignItems:"center",justifyContent:"center",p:4,children:s.jsx(oe,{fontSize:"2xl",fontWeight:"bold",color:"white",textAlign:"center",children:e})})]})}),zu=({id:n,title:e,image:t,avgRating:r,isBookmarked:i,onBookmarkToggle:o,cardBg:a})=>{const g=()=>{Ka(n)},d=ae("brand.500","brand.400"),v=ae("gray.100","gray.700"),u=ae("white","white"),f=ae("gray.500","gray.400");return s.jsxs(ne,{bg:a,borderRadius:"xl",overflow:"hidden",shadow:"lg",transition:"0.3s",position:"relative",_hover:{transform:"translateY(-4px)",shadow:"xl"},children:[s.jsx(Bt,{label:i?"Remove from bookmarks":"Add to bookmarks",placement:"top",hasArrow:!0,children:s.jsx(Ge,{icon:s.jsx(or,{}),"aria-label":"Bookmark",position:"absolute",top:2,right:2,zIndex:2,size:"sm",bg:i?d:v,color:i?u:f,borderRadius:"full",shadow:i?"md":"none",_hover:{transform:"scale(1.1)",bg:i?"brand.600":"gray.300"},onClick:l=>{l.preventDefault(),l.stopPropagation(),o&&o(n)}})}),s.jsx(As,{ratio:4/3,children:s.jsx(Ot,{src:t,alt:e,objectFit:"cover"})}),s.jsxs(ne,{p:4,children:[s.jsx(ve,{justify:"space-between",mb:2,children:s.jsxs(ve,{spacing:2,children:[s.jsx(dt,{colorScheme:"yellow",variant:"solid",borderRadius:"full",children:r?r.toFixed(1):"N/A"}),s.jsx(ze,{as:sn,color:"yellow.400"})]})}),s.jsx(ke,{size:"md",mb:4,noOfLines:2,children:e}),s.jsx(ve,{justify:"flex-end",align:"center",children:s.jsx(be,{size:"sm",rightIcon:s.jsx(Za,{}),variant:"ghost",as:Ae,to:`/book/${n}`,onClick:g,children:"View"})})]})]})},Hu=()=>{const[n,e]=Q.useState([]),[t,r]=Q.useState([]),[i,o]=Q.useState(new Set),[a,g]=Q.useState(!0),[d,v]=Q.useState(null),{user:u}=Lt(),f=ae("gray.50","gray.900"),l=ae("white","gray.800"),c=ae("white","gray.800"),_=ae("gray.100","gray.700"),y=mt();Q.useEffect(()=>{let h=!0;return(async()=>{try{if(console.log("Home: Starting data fetch"),!h)return;g(!0),console.log("Loading state:",a);const[x,p]=await Promise.all([Qc(),eu()]);if(console.log("Categories result:",x),console.log("Books result:",p),!h)return;if(x.error)throw x.error;if(p.error)throw p.error;if(e(x.data||[]),r(p.data||[]),u!=null&&u.id){console.log("Home: Fetching bookmarks for user:",u.id);const w=await ru(u.id);if(w.data){const T=new Set(w.data.map(S=>S.books.id));o(T)}}v(null)}catch(x){console.error("Home: Error fetching data:",x),h&&v(x.message||"An error occurred while fetching data")}finally{h&&g(!1)}})(),()=>{h=!1}},[u==null?void 0:u.id]);const b=async h=>{try{if(!u){y({title:"Authentication required",description:"Please sign in to bookmark books",status:"warning",duration:3e3,isClosable:!0,position:"top-right"});return}const{data:m,error:x}=await Va(h,u.id);if(x)throw x;o(p=>{const w=new Set(p);return w.has(h)?(w.delete(h),y({title:"Bookmark removed",description:"Book has been removed from your bookmarks",status:"success",duration:2e3,isClosable:!0,position:"top-right"})):(w.add(h),y({title:"Book bookmarked!",description:"Book has been added to your bookmarks",status:"success",duration:2e3,isClosable:!0,position:"top-right"})),w})}catch(m){console.error("Error toggling bookmark:",m),y({title:"Error",description:m.message||"Failed to toggle bookmark",status:"error",duration:3e3,isClosable:!0,position:"top-right"})}};return a?s.jsx(ne,{minH:"100vh",bg:f,display:"flex",alignItems:"center",justifyContent:"center",children:s.jsxs(we,{spacing:4,children:[s.jsx($t,{size:"xl",color:"brand.500",thickness:"4px"}),s.jsx(oe,{fontSize:"lg",color:"gray.500",children:"Loading amazing content..."})]})}):d?s.jsx(ne,{minH:"100vh",bg:f,display:"flex",alignItems:"center",justifyContent:"center",p:4,children:s.jsxs(tt,{status:"error",variant:"subtle",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",borderRadius:"xl",p:8,maxW:"xl",children:[s.jsx(rt,{boxSize:"40px",mr:0,mb:4}),s.jsx(ke,{size:"lg",mb:2,children:"Error Loading Content"}),s.jsx(oe,{mb:4,children:d}),s.jsx(be,{colorScheme:"red",onClick:()=>window.location.reload(),children:"Try Again"})]})}):s.jsxs(ne,{bg:f,children:[s.jsx(ne,{bg:l,position:"relative",h:{base:"400px",md:"500px"},backgroundImage:"url('/images/hero-bg.jpg')",backgroundSize:"cover",backgroundPosition:"center",children:s.jsx(ne,{position:"absolute",top:0,left:0,right:0,bottom:0,bg:"blackAlpha.600",display:"flex",alignItems:"center",justifyContent:"center",children:s.jsx(Le,{maxW:"container.xl",children:s.jsxs(we,{spacing:6,textAlign:"center",color:"white",children:[s.jsx(ke,{as:"h1",size:"2xl",fontWeight:"bold",children:"Explore book summaries with BookShorts"}),s.jsx(oe,{fontSize:"xl",maxW:"2xl",children:"Discover concise summaries of popular books!"}),s.jsx(be,{size:"lg",colorScheme:"brand",rightIcon:s.jsx(Za,{}),as:Ae,to:"/categories",children:"Discover"})]})})})}),s.jsx(Le,{maxW:"container.xl",py:16,children:s.jsxs(we,{spacing:12,children:[n.length>0&&s.jsxs(ne,{width:"100%",children:[s.jsx(ke,{size:"xl",mb:8,children:"Top genres"}),s.jsx(Ct,{columns:{base:1,sm:2,md:3},spacing:6,children:n.filter(h=>h.status).map(h=>s.jsx(Fu,{id:h.id,title:h.name,to:`/category/${h.id}`,imageUrl:h.image_url,onClick:tu},h.id))})]}),t.length>0&&s.jsxs(ne,{width:"100%",children:[s.jsx(ke,{size:"xl",mb:8,children:"Featured Books"}),s.jsx(Ct,{columns:{base:1,md:2,lg:3,xl:5},spacing:6,children:t.map(h=>s.jsx(zu,{id:h.id,title:h.title,image:h.cover_image||"/images/book-placeholder.jpg",avgRating:h.avg_rating,isBookmarked:i.has(h.id),onBookmarkToggle:b,cardBg:c},h.id))})]}),s.jsx(ne,{width:"100%",bg:_,borderRadius:"2xl",p:8,children:s.jsxs(Me,{direction:{base:"column",md:"row"},align:"center",justify:"space-between",gap:6,children:[s.jsxs(ve,{spacing:6,children:[s.jsx(ze,{as:ht,boxSize:8,color:"brand.500"}),s.jsxs(rr,{spacing:1,children:[s.jsx(ke,{size:"lg",children:"Exclusive deals"}),s.jsx(oe,{color:"gray.500",children:"Want to access premium summaries and exclusive offers? Join our Book Club now!"})]})]}),s.jsx(be,{size:"lg",colorScheme:"brand",as:Ae,to:"/join",children:"Join now"})]})})]})})]})},Wu=(n,e)=>{const[t,r]=Q.useState({book:null,content:null,loading:!0,error:null});return Q.useEffect(()=>{n&&(async()=>{try{r(v=>({...v,loading:!0,error:null}));const[o,a]=await Promise.all([le.from("Books").select(`
              *,
              category:Categories (
                id,
                name,
                display_order,
                status
              )
            `).eq("id",n).single(),le.from("Content").select("*").eq("book_id",n).eq("type",e).single()]),g=o.error||a.error;if(g)throw g;if(!o.data)throw new Error("Book not found");const d=a.data||{content:"",type:e,last_updated:new Date};d.content&&typeof d.content=="object"&&(console.warn("Content is an object, not a string. Converting to JSON string."),d.content=JSON.stringify(d.content)),d.content||(d.content=""),r({book:{...o.data,category:o.data.category||null,cover_image:o.data.cover_image||"/placeholder-cover.jpg",status:o.data.status??!0},content:{...d,content:String(d.content),last_updated:d.last_updated?new Date(d.last_updated):new Date},loading:!1,error:null})}catch(o){console.error("Book data fetch error:",o),r({book:null,content:null,loading:!1,error:o instanceof Error?o:new Error("Failed to load book data")})}})()},[n,e]),t};/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:Qa,setPrototypeOf:To,isFrozen:Gu,getPrototypeOf:Ku,getOwnPropertyDescriptor:Vu}=Object;let{freeze:Ke,seal:nt,create:es}=Object,{apply:mi,construct:bi}=typeof Reflect<"u"&&Reflect;Ke||(Ke=function(e){return e});nt||(nt=function(e){return e});mi||(mi=function(e,t,r){return e.apply(t,r)});bi||(bi=function(e,t){return new e(...t)});const Gr=Ve(Array.prototype.forEach),Yu=Ve(Array.prototype.lastIndexOf),Co=Ve(Array.prototype.pop),_r=Ve(Array.prototype.push),Ju=Ve(Array.prototype.splice),Jr=Ve(String.prototype.toLowerCase),Un=Ve(String.prototype.toString),Po=Ve(String.prototype.match),xr=Ve(String.prototype.replace),Zu=Ve(String.prototype.indexOf),Xu=Ve(String.prototype.trim),ot=Ve(Object.prototype.hasOwnProperty),We=Ve(RegExp.prototype.test),wr=Qu(TypeError);function Ve(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return mi(n,e,r)}}function Qu(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return bi(n,t)}}function ye(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jr;To&&To(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=t(i);o!==i&&(Gu(e)||(e[r]=o),i=o)}n[i]=!0}return n}function ef(n){for(let e=0;e<n.length;e++)ot(n,e)||(n[e]=null);return n}function It(n){const e=es(null);for(const[t,r]of Qa(n))ot(n,t)&&(Array.isArray(r)?e[t]=ef(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=It(r):e[t]=r);return e}function kr(n,e){for(;n!==null;){const r=Vu(n,e);if(r){if(r.get)return Ve(r.get);if(typeof r.value=="function")return Ve(r.value)}n=Ku(n)}function t(){return null}return t}const Lo=Ke(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Fn=Ke(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),zn=Ke(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),tf=Ke(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Hn=Ke(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),rf=Ke(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ro=Ke(["#text"]),No=Ke(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Wn=Ke(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Io=Ke(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Kr=Ke(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),nf=nt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),of=nt(/<%[\w\W]*|[\w\W]*%>/gm),af=nt(/\$\{[\w\W]*/gm),sf=nt(/^data-[\-\w.\u00B7-\uFFFF]+$/),lf=nt(/^aria-[\-\w]+$/),ts=nt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),cf=nt(/^(?:\w+script|data):/i),uf=nt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),rs=nt(/^html$/i),ff=nt(/^[a-z][.\w]*(-[.\w]+)+$/i);var Do=Object.freeze({__proto__:null,ARIA_ATTR:lf,ATTR_WHITESPACE:uf,CUSTOM_ELEMENT:ff,DATA_ATTR:sf,DOCTYPE_NAME:rs,ERB_EXPR:of,IS_ALLOWED_URI:ts,IS_SCRIPT_OR_DATA:cf,MUSTACHE_EXPR:nf,TMPLIT_EXPR:af});const Er={element:1,text:3,progressingInstruction:7,comment:8,document:9},df=function(){return typeof window>"u"?null:window},hf=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Mo=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ns(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:df();const e=se=>ns(se);if(e.version="3.2.4",e.removed=[],!n||!n.document||n.document.nodeType!==Er.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:g,Element:d,NodeFilter:v,NamedNodeMap:u=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:f,DOMParser:l,trustedTypes:c}=n,_=d.prototype,y=kr(_,"cloneNode"),b=kr(_,"remove"),h=kr(_,"nextSibling"),m=kr(_,"childNodes"),x=kr(_,"parentNode");if(typeof a=="function"){const se=t.createElement("template");se.content&&se.content.ownerDocument&&(t=se.content.ownerDocument)}let p,w="";const{implementation:T,createNodeIterator:S,createDocumentFragment:O,getElementsByTagName:P}=t,{importNode:j}=r;let k=Mo();e.isSupported=typeof Qa=="function"&&typeof x=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:E,ERB_EXPR:C,TMPLIT_EXPR:L,DATA_ATTR:M,ARIA_ATTR:z,IS_SCRIPT_OR_DATA:B,ATTR_WHITESPACE:K,CUSTOM_ELEMENT:q}=Do;let{IS_ALLOWED_URI:D}=Do,A=null;const N=ye({},[...Lo,...Fn,...zn,...Hn,...Ro]);let I=null;const H=ye({},[...No,...Wn,...Io,...Kr]);let U=Object.seal(es(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),R=null,$=null,G=!0,W=!0,J=!1,re=!0,ce=!1,ue=!0,he=!1,xe=!1,Ne=!1,Ee=!1,V=!1,Y=!1,ee=!0,te=!1;const Z="user-content-";let pe=!0,fe=!1,de={},Re=null;const et=ye({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Oe=null;const Dr=ye({},["audio","video","img","source","image","track"]);let Ce=null;const it=ye({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Mr="http://www.w3.org/1998/Math/MathML",Br="http://www.w3.org/2000/svg",pt="http://www.w3.org/1999/xhtml";let zt=pt,Cn=!1,Pn=null;const xs=ye({},[Mr,Br,pt],Un);let $r=ye({},["mi","mo","mn","ms","mtext"]),qr=ye({},["annotation-xml"]);const ws=ye({},["title","style","font","a","script"]);let pr=null;const ks=["application/xhtml+xml","text/html"],Es="text/html";let Ie=null,Ht=null;const Os=t.createElement("form"),Bi=function(F){return F instanceof RegExp||F instanceof Function},Ln=function(){let F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ht&&Ht===F)){if((!F||typeof F!="object")&&(F={}),F=It(F),pr=ks.indexOf(F.PARSER_MEDIA_TYPE)===-1?Es:F.PARSER_MEDIA_TYPE,Ie=pr==="application/xhtml+xml"?Un:Jr,A=ot(F,"ALLOWED_TAGS")?ye({},F.ALLOWED_TAGS,Ie):N,I=ot(F,"ALLOWED_ATTR")?ye({},F.ALLOWED_ATTR,Ie):H,Pn=ot(F,"ALLOWED_NAMESPACES")?ye({},F.ALLOWED_NAMESPACES,Un):xs,Ce=ot(F,"ADD_URI_SAFE_ATTR")?ye(It(it),F.ADD_URI_SAFE_ATTR,Ie):it,Oe=ot(F,"ADD_DATA_URI_TAGS")?ye(It(Dr),F.ADD_DATA_URI_TAGS,Ie):Dr,Re=ot(F,"FORBID_CONTENTS")?ye({},F.FORBID_CONTENTS,Ie):et,R=ot(F,"FORBID_TAGS")?ye({},F.FORBID_TAGS,Ie):{},$=ot(F,"FORBID_ATTR")?ye({},F.FORBID_ATTR,Ie):{},de=ot(F,"USE_PROFILES")?F.USE_PROFILES:!1,G=F.ALLOW_ARIA_ATTR!==!1,W=F.ALLOW_DATA_ATTR!==!1,J=F.ALLOW_UNKNOWN_PROTOCOLS||!1,re=F.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ce=F.SAFE_FOR_TEMPLATES||!1,ue=F.SAFE_FOR_XML!==!1,he=F.WHOLE_DOCUMENT||!1,Ee=F.RETURN_DOM||!1,V=F.RETURN_DOM_FRAGMENT||!1,Y=F.RETURN_TRUSTED_TYPE||!1,Ne=F.FORCE_BODY||!1,ee=F.SANITIZE_DOM!==!1,te=F.SANITIZE_NAMED_PROPS||!1,pe=F.KEEP_CONTENT!==!1,fe=F.IN_PLACE||!1,D=F.ALLOWED_URI_REGEXP||ts,zt=F.NAMESPACE||pt,$r=F.MATHML_TEXT_INTEGRATION_POINTS||$r,qr=F.HTML_INTEGRATION_POINTS||qr,U=F.CUSTOM_ELEMENT_HANDLING||{},F.CUSTOM_ELEMENT_HANDLING&&Bi(F.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=F.CUSTOM_ELEMENT_HANDLING.tagNameCheck),F.CUSTOM_ELEMENT_HANDLING&&Bi(F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),F.CUSTOM_ELEMENT_HANDLING&&typeof F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ce&&(W=!1),V&&(Ee=!0),de&&(A=ye({},Ro),I=[],de.html===!0&&(ye(A,Lo),ye(I,No)),de.svg===!0&&(ye(A,Fn),ye(I,Wn),ye(I,Kr)),de.svgFilters===!0&&(ye(A,zn),ye(I,Wn),ye(I,Kr)),de.mathMl===!0&&(ye(A,Hn),ye(I,Io),ye(I,Kr))),F.ADD_TAGS&&(A===N&&(A=It(A)),ye(A,F.ADD_TAGS,Ie)),F.ADD_ATTR&&(I===H&&(I=It(I)),ye(I,F.ADD_ATTR,Ie)),F.ADD_URI_SAFE_ATTR&&ye(Ce,F.ADD_URI_SAFE_ATTR,Ie),F.FORBID_CONTENTS&&(Re===et&&(Re=It(Re)),ye(Re,F.FORBID_CONTENTS,Ie)),pe&&(A["#text"]=!0),he&&ye(A,["html","head","body"]),A.table&&(ye(A,["tbody"]),delete R.tbody),F.TRUSTED_TYPES_POLICY){if(typeof F.TRUSTED_TYPES_POLICY.createHTML!="function")throw wr('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof F.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw wr('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');p=F.TRUSTED_TYPES_POLICY,w=p.createHTML("")}else p===void 0&&(p=hf(c,i)),p!==null&&typeof w=="string"&&(w=p.createHTML(""));Ke&&Ke(F),Ht=F}},$i=ye({},[...Fn,...zn,...tf]),qi=ye({},[...Hn,...rf]),js=function(F){let X=x(F);(!X||!X.tagName)&&(X={namespaceURI:zt,tagName:"template"});const ie=Jr(F.tagName),Pe=Jr(X.tagName);return Pn[F.namespaceURI]?F.namespaceURI===Br?X.namespaceURI===pt?ie==="svg":X.namespaceURI===Mr?ie==="svg"&&(Pe==="annotation-xml"||$r[Pe]):!!$i[ie]:F.namespaceURI===Mr?X.namespaceURI===pt?ie==="math":X.namespaceURI===Br?ie==="math"&&qr[Pe]:!!qi[ie]:F.namespaceURI===pt?X.namespaceURI===Br&&!qr[Pe]||X.namespaceURI===Mr&&!$r[Pe]?!1:!qi[ie]&&(ws[ie]||!$i[ie]):!!(pr==="application/xhtml+xml"&&Pn[F.namespaceURI]):!1},lt=function(F){_r(e.removed,{element:F});try{x(F).removeChild(F)}catch{b(F)}},Ur=function(F,X){try{_r(e.removed,{attribute:X.getAttributeNode(F),from:X})}catch{_r(e.removed,{attribute:null,from:X})}if(X.removeAttribute(F),F==="is")if(Ee||V)try{lt(X)}catch{}else try{X.setAttribute(F,"")}catch{}},Ui=function(F){let X=null,ie=null;if(Ne)F="<remove></remove>"+F;else{const Be=Po(F,/^[\r\n\t ]+/);ie=Be&&Be[0]}pr==="application/xhtml+xml"&&zt===pt&&(F='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+F+"</body></html>");const Pe=p?p.createHTML(F):F;if(zt===pt)try{X=new l().parseFromString(Pe,pr)}catch{}if(!X||!X.documentElement){X=T.createDocument(zt,"template",null);try{X.documentElement.innerHTML=Cn?w:Pe}catch{}}const Ue=X.body||X.documentElement;return F&&ie&&Ue.insertBefore(t.createTextNode(ie),Ue.childNodes[0]||null),zt===pt?P.call(X,he?"html":"body")[0]:he?X.documentElement:Ue},Fi=function(F){return S.call(F.ownerDocument||F,F,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT|v.SHOW_PROCESSING_INSTRUCTION|v.SHOW_CDATA_SECTION,null)},Rn=function(F){return F instanceof f&&(typeof F.nodeName!="string"||typeof F.textContent!="string"||typeof F.removeChild!="function"||!(F.attributes instanceof u)||typeof F.removeAttribute!="function"||typeof F.setAttribute!="function"||typeof F.namespaceURI!="string"||typeof F.insertBefore!="function"||typeof F.hasChildNodes!="function")},zi=function(F){return typeof g=="function"&&F instanceof g};function gt(se,F,X){Gr(se,ie=>{ie.call(e,F,X,Ht)})}const Hi=function(F){let X=null;if(gt(k.beforeSanitizeElements,F,null),Rn(F))return lt(F),!0;const ie=Ie(F.nodeName);if(gt(k.uponSanitizeElement,F,{tagName:ie,allowedTags:A}),F.hasChildNodes()&&!zi(F.firstElementChild)&&We(/<[/\w]/g,F.innerHTML)&&We(/<[/\w]/g,F.textContent)||F.nodeType===Er.progressingInstruction||ue&&F.nodeType===Er.comment&&We(/<[/\w]/g,F.data))return lt(F),!0;if(!A[ie]||R[ie]){if(!R[ie]&&Gi(ie)&&(U.tagNameCheck instanceof RegExp&&We(U.tagNameCheck,ie)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ie)))return!1;if(pe&&!Re[ie]){const Pe=x(F)||F.parentNode,Ue=m(F)||F.childNodes;if(Ue&&Pe){const Be=Ue.length;for(let Ye=Be-1;Ye>=0;--Ye){const ct=y(Ue[Ye],!0);ct.__removalCount=(F.__removalCount||0)+1,Pe.insertBefore(ct,h(F))}}}return lt(F),!0}return F instanceof d&&!js(F)||(ie==="noscript"||ie==="noembed"||ie==="noframes")&&We(/<\/no(script|embed|frames)/i,F.innerHTML)?(lt(F),!0):(ce&&F.nodeType===Er.text&&(X=F.textContent,Gr([E,C,L],Pe=>{X=xr(X,Pe," ")}),F.textContent!==X&&(_r(e.removed,{element:F.cloneNode()}),F.textContent=X)),gt(k.afterSanitizeElements,F,null),!1)},Wi=function(F,X,ie){if(ee&&(X==="id"||X==="name")&&(ie in t||ie in Os))return!1;if(!(W&&!$[X]&&We(M,X))){if(!(G&&We(z,X))){if(!I[X]||$[X]){if(!(Gi(F)&&(U.tagNameCheck instanceof RegExp&&We(U.tagNameCheck,F)||U.tagNameCheck instanceof Function&&U.tagNameCheck(F))&&(U.attributeNameCheck instanceof RegExp&&We(U.attributeNameCheck,X)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(X))||X==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&We(U.tagNameCheck,ie)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ie))))return!1}else if(!Ce[X]){if(!We(D,xr(ie,K,""))){if(!((X==="src"||X==="xlink:href"||X==="href")&&F!=="script"&&Zu(ie,"data:")===0&&Oe[F])){if(!(J&&!We(B,xr(ie,K,"")))){if(ie)return!1}}}}}}return!0},Gi=function(F){return F!=="annotation-xml"&&Po(F,q)},Ki=function(F){gt(k.beforeSanitizeAttributes,F,null);const{attributes:X}=F;if(!X||Rn(F))return;const ie={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I,forceKeepAttr:void 0};let Pe=X.length;for(;Pe--;){const Ue=X[Pe],{name:Be,namespaceURI:Ye,value:ct}=Ue,gr=Ie(Be);let He=Be==="value"?ct:Xu(ct);if(ie.attrName=gr,ie.attrValue=He,ie.keepAttr=!0,ie.forceKeepAttr=void 0,gt(k.uponSanitizeAttribute,F,ie),He=ie.attrValue,te&&(gr==="id"||gr==="name")&&(Ur(Be,F),He=Z+He),ue&&We(/((--!?|])>)|<\/(style|title)/i,He)){Ur(Be,F);continue}if(ie.forceKeepAttr||(Ur(Be,F),!ie.keepAttr))continue;if(!re&&We(/\/>/i,He)){Ur(Be,F);continue}ce&&Gr([E,C,L],Yi=>{He=xr(He,Yi," ")});const Vi=Ie(F.nodeName);if(Wi(Vi,gr,He)){if(p&&typeof c=="object"&&typeof c.getAttributeType=="function"&&!Ye)switch(c.getAttributeType(Vi,gr)){case"TrustedHTML":{He=p.createHTML(He);break}case"TrustedScriptURL":{He=p.createScriptURL(He);break}}try{Ye?F.setAttributeNS(Ye,Be,He):F.setAttribute(Be,He),Rn(F)?lt(F):Co(e.removed)}catch{}}}gt(k.afterSanitizeAttributes,F,null)},Ss=function se(F){let X=null;const ie=Fi(F);for(gt(k.beforeSanitizeShadowDOM,F,null);X=ie.nextNode();)gt(k.uponSanitizeShadowNode,X,null),Hi(X),Ki(X),X.content instanceof o&&se(X.content);gt(k.afterSanitizeShadowDOM,F,null)};return e.sanitize=function(se){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=null,ie=null,Pe=null,Ue=null;if(Cn=!se,Cn&&(se="<!-->"),typeof se!="string"&&!zi(se))if(typeof se.toString=="function"){if(se=se.toString(),typeof se!="string")throw wr("dirty is not a string, aborting")}else throw wr("toString is not a function");if(!e.isSupported)return se;if(xe||Ln(F),e.removed=[],typeof se=="string"&&(fe=!1),fe){if(se.nodeName){const ct=Ie(se.nodeName);if(!A[ct]||R[ct])throw wr("root node is forbidden and cannot be sanitized in-place")}}else if(se instanceof g)X=Ui("<!---->"),ie=X.ownerDocument.importNode(se,!0),ie.nodeType===Er.element&&ie.nodeName==="BODY"||ie.nodeName==="HTML"?X=ie:X.appendChild(ie);else{if(!Ee&&!ce&&!he&&se.indexOf("<")===-1)return p&&Y?p.createHTML(se):se;if(X=Ui(se),!X)return Ee?null:Y?w:""}X&&Ne&&lt(X.firstChild);const Be=Fi(fe?se:X);for(;Pe=Be.nextNode();)Hi(Pe),Ki(Pe),Pe.content instanceof o&&Ss(Pe.content);if(fe)return se;if(Ee){if(V)for(Ue=O.call(X.ownerDocument);X.firstChild;)Ue.appendChild(X.firstChild);else Ue=X;return(I.shadowroot||I.shadowrootmode)&&(Ue=j.call(r,Ue,!0)),Ue}let Ye=he?X.outerHTML:X.innerHTML;return he&&A["!doctype"]&&X.ownerDocument&&X.ownerDocument.doctype&&X.ownerDocument.doctype.name&&We(rs,X.ownerDocument.doctype.name)&&(Ye="<!DOCTYPE "+X.ownerDocument.doctype.name+`>
`+Ye),ce&&Gr([E,C,L],ct=>{Ye=xr(Ye,ct," ")}),p&&Y?p.createHTML(Ye):Ye},e.setConfig=function(){let se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ln(se),xe=!0},e.clearConfig=function(){Ht=null,xe=!1},e.isValidAttribute=function(se,F,X){Ht||Ln({});const ie=Ie(se),Pe=Ie(F);return Wi(ie,Pe,X)},e.addHook=function(se,F){typeof F=="function"&&_r(k[se],F)},e.removeHook=function(se,F){if(F!==void 0){const X=Yu(k[se],F);return X===-1?void 0:Ju(k[se],X,1)[0]}return Co(k[se])},e.removeHooks=function(se){k[se]=[]},e.removeAllHooks=function(){k=Mo()},e}var Ar=ns();const pf=({content:n,lastUpdated:e})=>{let t="";if(n)if(typeof n=="string")t=n;else if(typeof n=="object")if(n.content)t=n.content;else try{t=JSON.stringify(n,null,2)}catch(a){console.error("Failed to stringify content:",a),t="Error parsing content"}else t=String(n);const r=t?Ar.sanitize(t):"",i=ae("white","gray.700"),o=ae("gray.200","gray.600");return r.trim()?s.jsxs(ne,{p:8,borderWidth:"1px",borderColor:o,borderRadius:"lg",bg:i,boxShadow:"md",className:"content-section",children:[e&&s.jsxs(ne,{mb:4,children:[s.jsxs(oe,{fontSize:"sm",color:"gray.500",children:["Last updated: ",e.toLocaleDateString()]}),s.jsx(Pt,{my:2})]}),s.jsx(ne,{className:"html-content",sx:{"h1, h2, h3, h4, h5, h6":{fontWeight:"bold",lineHeight:1.2,mt:4,mb:2},h1:{fontSize:"2xl",mt:6,mb:4},h2:{fontSize:"xl",mt:5,mb:3},h3:{fontSize:"lg"},p:{mb:4,lineHeight:1.7},ul:{pl:6,mb:4},ol:{pl:6,mb:4},li:{mb:2},a:{color:"blue.500",textDecoration:"underline"},blockquote:{borderLeftWidth:"4px",borderLeftColor:"gray.300",pl:4,py:1,my:4,fontStyle:"italic"},img:{maxWidth:"100%",height:"auto",borderRadius:"md",my:4},table:{width:"100%",borderCollapse:"collapse",my:4},"th, td":{borderWidth:"1px",borderColor:"gray.200",p:2},th:{bg:"gray.50",fontWeight:"bold"},pre:{bg:"gray.50",p:4,borderRadius:"md",overflowX:"auto",my:4},code:{fontFamily:"monospace",bg:"gray.100",p:1,borderRadius:"sm"}},dangerouslySetInnerHTML:{__html:r}})]}):s.jsxs(tt,{status:"info",borderRadius:"md",children:[s.jsx(rt,{}),"No content available for this section."]})},Bo=st(ne),gf=st(ne),vf=()=>{var b,h,m;const{bookId:n}=wa(),t=new URLSearchParams(gn().search).get("section")||"core",{book:r,content:i,loading:o,error:a}=Wu(n,t),[g,d]=yt.useState(0),[v,u]=Q.useState(null),f=mt(),l=Yn({base:"150px",md:"250px"}),c=ae("linear(to-r, blue.50 0%, purple.50 100%)","linear(to-r, gray.800 0%, gray.900 100%)"),_=ae("gray.600","gray.300");ae("white","gray.800"),ae("gray.200","gray.700");const y=()=>{d(x=>x>=100?0:x+25)};return Q.useEffect(()=>{(async()=>{try{const{data:p,error:w}=await le.from("Books").select(`
            *,
            Categories (
              id,
              name
            )
          `).eq("id",n).single();if(w)throw w;u(p),await Ka(n)}catch(p){console.error("Error fetching book:",p),f({title:"Error fetching book",description:p.message,status:"error",duration:3e3,isClosable:!0})}})()},[n]),o?s.jsx(ne,{display:"flex",justifyContent:"center",alignItems:"center",minH:"100vh",children:s.jsx($t,{size:"xl",thickness:"3px",color:"blue.500"})}):a?s.jsxs(tt,{status:"error",variant:"left-accent",borderRadius:"md",my:6,children:[s.jsx(rt,{}),"Error loading book: ",a.message]}):v?s.jsx(Bo,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},minH:"100vh",bgGradient:c,children:s.jsxs(Le,{maxW:"container.xl",py:8,children:[s.jsxs(Me,{mb:6,align:"center",justify:"space-between",children:[s.jsxs(Et,{as:Ae,to:"/",display:"flex",alignItems:"center",children:[s.jsx(Ou,{}),s.jsx(oe,{ml:2,children:"Back to Home"})]}),s.jsxs(ve,{children:[s.jsx(Ge,{"aria-label":"Bookmark",icon:s.jsx(or,{}),variant:"ghost"}),s.jsx(Ge,{"aria-label":"Share",icon:s.jsx(Nu,{}),variant:"ghost"})]})]}),s.jsx(Bo,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.4},children:s.jsxs(Me,{direction:{base:"column",md:"row"},align:"center",mb:8,children:[s.jsx(Ot,{src:v.cover_image||"/placeholder-book.jpg",alt:v.title,boxSize:l,objectFit:"cover",borderRadius:"lg",shadow:"xl",mr:{md:8},mb:{base:4,md:0}}),s.jsxs(ne,{textAlign:{base:"center",md:"left"},children:[s.jsx(ke,{as:"h1",size:"2xl",mb:2,children:v.title}),s.jsx(dt,{colorScheme:"purple",fontSize:"lg",mb:2,children:(b=v.Categories)==null?void 0:b.name}),s.jsxs(ve,{spacing:4,justify:{base:"center",md:"flex-start"},children:[s.jsxs(oe,{fontSize:"lg",color:_,children:[s.jsx(Su,{style:{marginRight:"4px",display:"inline"}}),t==="core"?"15 min read":"30 min read"]}),s.jsx(dt,{colorScheme:v.status?"green":"red",children:v.status?"Published":"Draft"})]}),s.jsxs(ve,{spacing:4,justify:{base:"center",md:"flex-start"},children:[s.jsx(ze,{as:sn,color:"yellow.400"}),s.jsx(oe,{children:((h=v.avg_rating)==null?void 0:h.toFixed(1))||"0.0"}),s.jsxs(oe,{children:["(",v.total_ratings||0," ratings)"]})]}),s.jsxs(ve,{spacing:4,justify:{base:"center",md:"flex-start"},children:[s.jsx(ze,{as:qt}),s.jsxs(oe,{children:[v.click_count||0," views"]})]})]})]})}),s.jsxs(ne,{mb:8,children:[s.jsx(oe,{fontWeight:"500",mb:2,children:"Reading Progress"}),s.jsx(ji,{value:g,size:"sm",colorScheme:"blue",borderRadius:"full"})]}),s.jsxs(ve,{spacing:4,mb:8,justify:"center",children:[s.jsxs(Et,{as:Ae,to:`/book/${n}?section=core`,p:4,borderRadius:"md",fontWeight:"semibold",bg:t==="core"?"blue.500":"transparent",color:t==="core"?"white":"gray.500",_hover:{textDecoration:"none",bg:t==="core"?"blue.600":"gray.100"},transition:"all 0.2s",children:["Core Explanation",s.jsx(dt,{ml:2,colorScheme:"blue",children:"Summary"})]}),s.jsxs(Et,{as:Ae,to:`/book/${n}?section=deep_dive`,p:4,borderRadius:"md",fontWeight:"semibold",bg:t==="deep_dive"?"purple.500":"transparent",color:t==="deep_dive"?"white":"gray.500",_hover:{textDecoration:"none",bg:t==="deep_dive"?"purple.600":"gray.100"},transition:"all 0.2s",children:["Deep Dive",s.jsx(dt,{ml:2,colorScheme:"purple",children:"Detailed"})]})]}),s.jsx(ga,{mode:"wait",children:s.jsx(gf,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:i?s.jsx(pf,{content:i.content,lastUpdated:i.last_updated?new Date(i.last_updated):new Date}):s.jsx(oe,{textAlign:"center",color:"gray.500",children:"Content not available for this section"})},t)}),s.jsxs(ne,{mt:12,textAlign:"center",children:[s.jsxs(oe,{fontSize:"lg",mb:4,children:[g,"% Completed"]}),s.jsxs(be,{colorScheme:"blue",size:"lg",onClick:y,leftIcon:s.jsx(or,{}),children:["Mark as ",g>=100?"Restart":"Completed"]})]}),s.jsx(ne,{p:8,children:s.jsxs(we,{spacing:6,align:"stretch",children:[s.jsxs(va,{children:[s.jsxs(jt,{children:[s.jsx(St,{children:"Average Rating"}),s.jsx(At,{children:s.jsxs(ve,{spacing:2,children:[s.jsx(ze,{as:sn,color:"yellow.400"}),s.jsx(oe,{children:((m=v.avg_rating)==null?void 0:m.toFixed(1))||"0.0"})]})})]}),s.jsxs(jt,{children:[s.jsx(St,{children:"Total Ratings"}),s.jsx(At,{children:v.total_ratings||0})]}),s.jsxs(jt,{children:[s.jsx(St,{children:"Views"}),s.jsx(At,{children:v.click_count||0})]})]}),s.jsx(Pt,{}),s.jsxs(we,{align:"start",spacing:4,children:[s.jsx(ke,{size:"md",children:"About this book"}),s.jsx(oe,{children:v.description||"No description available."})]})]})})]})}):s.jsx(Le,{maxW:"container.lg",py:8,children:s.jsx(oe,{children:"Book not found"})})};st(ne);const yf=st(Ge),mf="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300'%3E%3Crect width='200' height='300' fill='%23f0f0f0'/%3E%3Ctext x='50%25' y='50%25' font-family='Arial' font-size='14' text-anchor='middle' dominant-baseline='middle' fill='%23999999'%3ENo Image%3C/text%3E%3C/svg%3E",is=({book:n,isBookmarked:e=!1,onBookmarkToggle:t,categoryName:r})=>{var m;const i=ae("white","gray.800"),o=ae("gray.200","gray.700"),a=ae("brand.500","brand.400"),g=ae("gray.100","gray.700"),d=ae("white","white"),v=ae("gray.500","gray.400"),u=n==null?void 0:n.id,f=n==null?void 0:n.title,l=(n==null?void 0:n.cover_image)||mf,c=(n==null?void 0:n.avg_rating)||0,_=(n==null?void 0:n.total_ratings)||0,y=(n==null?void 0:n.click_count)||0,b=r||((m=n==null?void 0:n.Categories)==null?void 0:m.name),h=x=>{t&&(x.preventDefault(),x.stopPropagation(),t())};return s.jsxs(ne,{borderWidth:"1px",borderRadius:"lg",overflow:"hidden",bg:i,borderColor:o,transition:"all 0.2s",position:"relative",_hover:{transform:"translateY(-4px)",shadow:"lg"},children:[t&&s.jsx(Bt,{label:e?"Remove from bookmarks":"Add to bookmarks",placement:"top",hasArrow:!0,children:s.jsx(yf,{icon:s.jsx(or,{}),"aria-label":"Bookmark",position:"absolute",top:2,right:2,zIndex:2,size:"sm",bg:e?a:g,color:e?d:v,borderRadius:"full",shadow:e?"md":"none",_hover:{transform:"scale(1.1)",bg:e?"brand.600":"gray.300"},onClick:h,whileHover:{scale:1.1},whileTap:{scale:.9},initial:{opacity:0},animate:{opacity:1},transition:{duration:.2}})}),s.jsxs(Et,{as:Ae,to:`/book/${u}`,_hover:{textDecoration:"none"},children:[s.jsx(Ot,{src:l,alt:f,height:"250px",width:"100%",objectFit:"cover",fallback:s.jsx(ne,{height:"250px",width:"100%",bg:"gray.100"})}),s.jsxs(we,{p:4,align:"stretch",spacing:2,children:[s.jsx(oe,{fontWeight:"semibold",noOfLines:2,children:f}),s.jsxs(ve,{justify:"space-between",align:"center",children:[b&&s.jsx(dt,{colorScheme:"blue",variant:"subtle",children:b}),s.jsxs(ve,{spacing:4,children:[s.jsx(Bt,{label:`${_||0} ratings`,children:s.jsxs(ve,{spacing:1,children:[s.jsx(ze,{as:sn,color:"yellow.400"}),s.jsx(oe,{fontSize:"sm",fontWeight:"medium",children:c?c.toFixed(1):"N/A"})]})}),s.jsx(Bt,{label:"Views",children:s.jsxs(ve,{spacing:1,children:[s.jsx(ze,{as:qt}),s.jsx(oe,{fontSize:"sm",children:y||0})]})})]})]})]})]})]})},bf=st(ne),_f=st(Le),xf=()=>{const{categoryId:n}=wa(),[e,t]=Q.useState(null),[r,i]=Q.useState([]),[o,a]=Q.useState([]),[g,d]=Q.useState(!0),[v,u]=Q.useState(null),[f,l]=Q.useState(""),[c,_]=Q.useState(new Set),{user:y}=Lt(),b=mt(),h=ae("linear(to-br, blue.50, purple.50)","linear(to-br, gray.800, gray.900)"),m=ae("white","gray.700"),x=ae("white","gray.700"),p=ae("gray.600","gray.300"),w=ae("blue.500","blue.300");ae("rgba(255, 255, 255, 0.8)","rgba(25, 25, 25, 0.8)");const T=ae("gray.200","gray.700"),S=ae("gray.500","gray.400"),O=Yn({base:4,md:8}),P=Yn({base:1,md:2,lg:3});Q.useEffect(()=>{n&&(async()=>{try{d(!0),u(null),console.log("Fetching category data for ID:",n);const{data:E,error:C}=await le.from("Categories").select("*").eq("id",n).single();if(C)throw C;const{data:L,error:M}=await le.from("Books").select(`
            id, 
            title, 
            cover_image, 
            display_order, 
            status,
            avg_rating,
            category_id,
            Categories (
              name
            )
          `).eq("category_id",n).eq("status",!0).order("display_order",{ascending:!0});if(M)throw M;if(console.log("Category data:",E),console.log("Books data:",L),t(E),i(L||[]),a(L||[]),y!=null&&y.id){const{data:z,error:B}=await le.from("Bookmarks").select("book_id").eq("user_id",y.id);if(B)console.error("Error fetching bookmarks:",B);else if(z){const K=new Set(z.map(q=>q.book_id));_(K)}}}catch(E){console.error("Error fetching category data:",E),u(E.message||"Failed to load category data"),b({title:"Error",description:`Failed to load category data: ${E.message}`,status:"error",duration:5e3,isClosable:!0})}finally{d(!1)}})()},[n,y==null?void 0:y.id,b]),Q.useEffect(()=>{if(f.trim()==="")a(r);else{const k=r.filter(E=>E.title.toLowerCase().includes(f.toLowerCase()));a(k)}},[f,r]);const j=async k=>{try{if(!y){b({title:"Authentication required",description:"Please sign in to bookmark books",status:"warning",duration:3e3,isClosable:!0});return}const{data:E,error:C}=await Va(k,y.id);if(C)throw C;_(L=>{const M=new Set(L);return M.has(k)?(M.delete(k),b({title:"Bookmark removed",description:"Book has been removed from your bookmarks",status:"success",duration:2e3,isClosable:!0,position:"top-right"})):(M.add(k),b({title:"Book bookmarked!",description:"Book has been added to your bookmarks",status:"success",duration:2e3,isClosable:!0,position:"top-right"})),M})}catch(E){console.error("Error toggling bookmark:",E),b({title:"Error",description:E.message||"Failed to update bookmark",status:"error",duration:3e3,isClosable:!0})}};return g?s.jsx(ne,{display:"flex",justifyContent:"center",minH:"100vh",alignItems:"center",bgGradient:h,children:s.jsxs(we,{spacing:4,children:[s.jsx($t,{size:"xl",thickness:"4px",color:w,emptyColor:"gray.200",speed:"0.65s"}),s.jsx(oe,{color:p,fontSize:"lg",children:"Loading books..."})]})}):v?s.jsx(Le,{maxW:"container.xl",py:8,bgGradient:h,minH:"100vh",children:s.jsx(Ji,{initialScale:.9,in:!0,children:s.jsxs(tt,{status:"error",variant:"left-accent",borderRadius:"xl",my:6,flexDirection:"column",alignItems:"center",textAlign:"center",p:8,bg:x,shadow:"xl",children:[s.jsx(rt,{boxSize:"32px",mr:0,mb:4}),s.jsxs(oe,{fontSize:"xl",mb:4,fontWeight:"medium",children:["Error loading books: ",v]}),s.jsx(be,{as:Ae,to:"/",colorScheme:"blue",size:"lg",leftIcon:s.jsx(ht,{}),children:"Return to Home"})]})})}):s.jsx(ne,{minH:"100vh",bgGradient:h,py:O,transition:"all 0.2s",children:s.jsx(_f,{maxW:"container.xl",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:s.jsxs(we,{spacing:8,width:"100%",children:[s.jsxs(Ts,{separator:">",width:"100%",color:S,mb:2,children:[s.jsx(Zi,{children:s.jsxs(Xi,{as:Ae,to:"/",display:"flex",alignItems:"center",children:[s.jsx(ze,{as:Xa,mr:1}),"Home"]})}),s.jsx(Zi,{isCurrentPage:!0,children:s.jsx(Xi,{children:(e==null?void 0:e.name)||"Category"})})]}),s.jsxs(we,{spacing:6,width:"100%",align:"center",pb:6,children:[s.jsx(ke,{as:"h1",size:"2xl",textAlign:"center",bgGradient:`linear(to-r, ${w}, purple.500)`,bgClip:"text",letterSpacing:"tight",children:e==null?void 0:e.name}),s.jsxs(dt,{colorScheme:"blue",variant:"subtle",fontSize:"md",px:4,py:1,borderRadius:"full",children:[o.length," ",o.length===1?"Book":"Books"]}),s.jsx(ne,{width:"100%",maxW:"600px",mx:"auto",mt:4,children:s.jsxs(Tt,{size:"lg",children:[s.jsx(Tr,{pointerEvents:"none",h:"full",pl:4,children:s.jsx(ze,{as:Ru,color:S,boxSize:"1.5em"})}),s.jsx(Xe,{placeholder:"Search books in this category...",value:f,onChange:k=>l(k.target.value),bg:m,borderRadius:"full",borderWidth:"2px",borderColor:f?w:T,_hover:{borderColor:w},_focus:{borderColor:w,boxShadow:"outline"},transition:"all 0.2s",fontSize:"lg",pl:12,pr:f?16:6,h:14}),f&&s.jsx(be,{position:"absolute",right:"3",top:"50%",transform:"translateY(-50%)",size:"md",colorScheme:"brand",variant:"ghost",onClick:()=>l(""),zIndex:2,h:10,w:10,borderRadius:"full",children:s.jsx(ze,{as:Lr,boxSize:"1.2em"})})]})}),s.jsx(Pt,{borderColor:T,mt:6})]}),s.jsx(ga,{children:s.jsx(Ct,{columns:P,spacing:8,width:"100%",children:o.map((k,E)=>s.jsx(bf,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:E*.1},whileHover:{y:-4},children:s.jsx(is,{book:k,isBookmarked:c.has(k.id),onBookmarkToggle:()=>j(k.id),categoryName:e==null?void 0:e.name})},k.id))})}),o.length===0&&s.jsx(Ji,{initialScale:.9,in:!0,children:s.jsxs(ne,{textAlign:"center",p:12,borderRadius:"2xl",bg:x,boxShadow:"xl",maxW:"600px",mx:"auto",children:[s.jsx(ze,{as:ht,fontSize:"4xl",color:p,mb:4}),s.jsx(oe,{fontSize:"xl",color:p,mb:6,children:f?"No books found matching your search":"No books available in this category yet"}),s.jsx(be,{as:Ae,to:"/",colorScheme:"blue",size:"lg",leftIcon:s.jsx(ht,{}),children:"Browse Other Categories"})]})})]})})})},wf=()=>{const[n,e]=Q.useState(""),[t,r]=Q.useState(""),[i,o]=Q.useState(""),[a,g]=Q.useState(!1),[d,v]=Q.useState(!1),u=pn(),{user:f}=Lt(),l=ae("gray.50","gray.900"),c=ae("white","gray.800");Q.useEffect(()=>{(async()=>{if(f!=null&&f.id){const{data:b,error:h}=await le.from("profiles").select("role").eq("id",f.id).single();!h&&(b==null?void 0:b.role)==="admin"?u("/admin"):u("/login")}})()},[f,u]);const _=async y=>{y.preventDefault(),o(""),g(!0);try{const{data:{user:b},error:h}=await le.auth.signInWithPassword({email:n,password:t});if(h)throw h;const{data:m,error:x}=await le.from("profiles").select("role").eq("id",b.id).single();if(x)throw x;if(m.role!=="admin")throw new Error("Access denied. Admin privileges required.");u("/admin")}catch(b){o(b.message),g(!1)}};return f?null:s.jsx(Me,{minH:"100vh",align:"center",justify:"center",bg:l,children:s.jsx(ne,{as:"form",onSubmit:_,w:"full",maxW:"md",p:8,borderRadius:"lg",boxShadow:"xl",bg:c,children:s.jsxs(we,{spacing:6,children:[s.jsx(ke,{as:"h1",size:"xl",textAlign:"center",children:"Admin Login"}),i&&s.jsxs(tt,{status:"error",borderRadius:"md",children:[s.jsx(rt,{}),i]}),s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:"Email"}),s.jsx(Xe,{type:"email",value:n,onChange:y=>e(y.target.value),placeholder:"Enter your email",autoFocus:!0})]}),s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:"Password"}),s.jsxs(Tt,{children:[s.jsx(Xe,{type:d?"text":"password",value:t,onChange:y=>r(y.target.value),placeholder:"Enter your password"}),s.jsx(Jn,{children:s.jsx(Ge,{icon:d?s.jsx(vi,{}):s.jsx(qt,{}),variant:"ghost",onClick:()=>v(!d),"aria-label":d?"Hide password":"Show password"})})]})]}),s.jsx(be,{type:"submit",colorScheme:"blue",size:"lg",width:"full",isLoading:a,loadingText:"Signing in...",children:"Sign In"}),s.jsxs(oe,{textAlign:"center",children:["Don't have an account?"," ",s.jsx(be,{as:Ae,to:"/admin/signup",variant:"link",colorScheme:"blue",children:"Sign Up"})]}),s.jsx(be,{as:Ae,to:"/admin/forgot-password",variant:"link",colorScheme:"blue",size:"sm",children:"Forgot Password?"})]})})})},kf=()=>{const[n,e]=Q.useState({email:"",password:"",confirmPassword:"",fullName:""}),[t,r]=Q.useState(""),[i,o]=Q.useState(!1),[a,g]=Q.useState(!1),d=pn(),v=mt(),u=ae("gray.50","gray.900"),f=ae("white","gray.800"),l=y=>{e({...n,[y.target.name]:y.target.value})},c=()=>!n.email||!n.password||!n.confirmPassword||!n.fullName?(r("All fields are required"),!1):n.password!==n.confirmPassword?(r("Passwords do not match"),!1):n.password.length<6?(r("Password must be at least 6 characters long"),!1):!0,_=async y=>{if(y.preventDefault(),!!c()){o(!0),r("");try{const{data:b,error:h}=await le.auth.signUp({email:n.email,password:n.password,options:{data:{full_name:n.fullName,role:"admin"}}});if(h)throw h;if(b.user){const{error:m}=await le.from("profiles").upsert([{id:b.user.id,full_name:n.fullName,email:n.email,role:"admin",updated_at:new Date().toISOString()}],{onConflict:"id",ignoreDuplicates:!1});if(m)throw console.error("Profile creation error:",m),new Error("Failed to create profile. Please contact support.")}v({title:"Account created successfully!",description:"Please check your email for verification.",status:"success",duration:5e3,isClosable:!0}),d("/admin/login")}catch(b){console.error("Signup error:",b),r(b.message)}finally{o(!1)}}};return s.jsx(Me,{minH:"100vh",align:"center",justify:"center",bg:u,children:s.jsx(ne,{as:"form",onSubmit:_,w:"full",maxW:"md",p:8,borderRadius:"lg",boxShadow:"xl",bg:f,children:s.jsxs(we,{spacing:6,children:[s.jsx(ke,{as:"h1",size:"xl",textAlign:"center",children:"Admin Sign Up"}),t&&s.jsxs(tt,{status:"error",borderRadius:"md",children:[s.jsx(rt,{}),t]}),s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:"Full Name"}),s.jsx(Xe,{name:"fullName",value:n.fullName,onChange:l,placeholder:"Enter your full name"})]}),s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:"Email"}),s.jsx(Xe,{name:"email",type:"email",value:n.email,onChange:l,placeholder:"Enter your email"})]}),s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:"Password"}),s.jsxs(Tt,{children:[s.jsx(Xe,{name:"password",type:a?"text":"password",value:n.password,onChange:l,placeholder:"Enter password"}),s.jsx(Jn,{children:s.jsx(Ge,{icon:a?s.jsx(vi,{}):s.jsx(qt,{}),variant:"ghost",onClick:()=>g(!a),"aria-label":a?"Hide password":"Show password"})})]}),s.jsx(Cs,{children:"Password must be at least 6 characters long"})]}),s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:"Confirm Password"}),s.jsxs(Tt,{children:[s.jsx(Xe,{name:"confirmPassword",type:a?"text":"password",value:n.confirmPassword,onChange:l,placeholder:"Confirm password"}),s.jsx(Jn,{children:s.jsx(Ge,{icon:a?s.jsx(vi,{}):s.jsx(qt,{}),variant:"ghost",onClick:()=>g(!a),"aria-label":a?"Hide password":"Show password"})})]})]}),s.jsx(be,{type:"submit",colorScheme:"blue",size:"lg",width:"full",isLoading:i,loadingText:"Signing up...",children:"Sign Up"}),s.jsxs(oe,{textAlign:"center",children:["Already have an account?"," ",s.jsx(be,{as:Ae,to:"/admin/login",variant:"link",colorScheme:"blue",children:"Sign In"})]})]})})})},Ef=st(ne),Of=st(Ct),os=st(Zr),jf=()=>{var l;const{user:n,signOut:e}=Lt(),[t,r]=Q.useState({totalBooks:0,totalCategories:0,recentViews:0,completionRate:0}),[i,o]=Q.useState(!0),a=ae("white","gray.700"),g=ae("gray.200","gray.600"),d=ae("blue.50","blue.900"),v=ae("gray.600","gray.200");Q.useEffect(()=>{(async()=>{try{const{data:_,error:y}=await le.from("Books").select("id",{count:"exact"}),{data:b,error:h}=await le.from("Categories").select("id",{count:"exact"});if(y)throw y;if(h)throw h;r({totalBooks:(_==null?void 0:_.length)||0,totalCategories:(b==null?void 0:b.length)||0,recentViews:Math.floor(Math.random()*1e3),completionRate:Math.floor(Math.random()*100)})}catch(_){console.error("Error fetching stats:",_)}finally{o(!1)}})()},[]);const u=async()=>{try{await e()}catch(c){console.error("Error signing out:",c)}},f=[{title:"Books",icon:nn,path:"/admin/books",color:"teal",description:"Add and manage books"},{title:"Content Manager",icon:Tu,path:"/admin/content",color:"blue",description:"Manage book content and chapters"},{title:"Analytics",icon:ju,path:"/admin/analytics",color:"green",description:"View detailed analytics and reports"},{title:"Categories",icon:ht,path:"/admin/categories",color:"purple",description:"Manage book categories"},{title:"Settings",icon:Ni,path:"/admin/settings",color:"gray",description:"Configure application settings"}];return s.jsx(Le,{maxW:"container.xl",py:8,children:s.jsxs(Ef,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[s.jsxs(Me,{direction:{base:"column",md:"row"},justify:"space-between",align:"center",mb:8,p:6,bg:a,borderRadius:"lg",borderWidth:"1px",borderColor:g,boxShadow:"sm",children:[s.jsxs(ve,{spacing:4,children:[s.jsx(Xr,{size:"lg",name:n==null?void 0:n.email,src:(l=n==null?void 0:n.user_metadata)==null?void 0:l.avatar_url,bg:"blue.500"}),s.jsxs(we,{align:"start",spacing:1,children:[s.jsx(ke,{size:"lg",children:"Welcome Back!"}),s.jsx(oe,{color:v,children:n==null?void 0:n.email}),s.jsx(dt,{colorScheme:"green",children:"Admin"})]})]}),s.jsx(be,{leftIcon:s.jsx(on,{}),onClick:u,colorScheme:"red",variant:"outline",mt:{base:4,md:0},children:"Sign Out"})]}),s.jsxs(Of,{columns:{base:1,md:2,lg:4},spacing:6,mb:8,initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[s.jsx(Vr,{label:"Total Books",value:t.totalBooks,icon:nn,increase:12,bg:d}),s.jsx(Vr,{label:"Categories",value:t.totalCategories,icon:ht,increase:5,bg:d}),s.jsx(Vr,{label:"Recent Views",value:t.recentViews,icon:Mu,increase:22,bg:d}),s.jsx(Vr,{label:"Completion Rate",value:`${t.completionRate}%`,icon:Du,increase:8,bg:d,children:s.jsx(ji,{value:t.completionRate,size:"sm",colorScheme:"green",mt:2})})]}),s.jsx(Ct,{columns:{base:1,md:2},spacing:6,children:f.map((c,_)=>s.jsx(os,{as:Ae,to:c.path,bg:a,borderWidth:"1px",borderColor:g,borderRadius:"lg",overflow:"hidden",cursor:"pointer",_hover:{transform:"translateY(-2px)",shadow:"md"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2,delay:.1*(_+1),ease:"easeOut"},children:s.jsx(Qr,{children:s.jsxs(ve,{spacing:4,children:[s.jsx(Me,{p:3,bg:`${c.color}.100`,color:`${c.color}.500`,borderRadius:"lg",align:"center",justify:"center",children:s.jsx(ze,{as:c.icon,boxSize:6})}),s.jsxs(we,{align:"start",spacing:1,children:[s.jsx(ke,{size:"md",children:c.title}),s.jsx(oe,{color:v,fontSize:"sm",children:c.description})]})]})})},c.title))})]})})},Vr=({label:n,value:e,icon:t,increase:r,bg:i,children:o})=>s.jsx(os,{p:6,bg:i,borderRadius:"lg",initial:{scale:.95},animate:{scale:1},whileHover:{scale:1.02},transition:{duration:.2},children:s.jsxs(jt,{children:[s.jsxs(ve,{spacing:4,mb:2,children:[s.jsx(Me,{p:2,bg:"blue.500",color:"white",borderRadius:"lg",align:"center",justify:"center",children:s.jsx(ze,{as:t,boxSize:6})}),s.jsx(St,{fontSize:"lg",fontWeight:"medium",children:n})]}),s.jsx(At,{fontSize:"3xl",fontWeight:"bold",children:e}),s.jsxs(ya,{children:[s.jsx(ma,{type:"increase"}),r,"% since last month"]}),o]})}),Sf=Ps({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"});function Af(){this.__data__=[],this.size=0}var Tf=Af;function Cf(n,e){return n===e||n!==n&&e!==e}var as=Cf,Pf=as;function Lf(n,e){for(var t=n.length;t--;)if(Pf(n[t][0],e))return t;return-1}var kn=Lf,Rf=kn,Nf=Array.prototype,If=Nf.splice;function Df(n){var e=this.__data__,t=Rf(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():If.call(e,t,1),--this.size,!0}var Mf=Df,Bf=kn;function $f(n){var e=this.__data__,t=Bf(e,n);return t<0?void 0:e[t][1]}var qf=$f,Uf=kn;function Ff(n){return Uf(this.__data__,n)>-1}var zf=Ff,Hf=kn;function Wf(n,e){var t=this.__data__,r=Hf(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}var Gf=Wf,Kf=Tf,Vf=Mf,Yf=qf,Jf=zf,Zf=Gf;function lr(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}lr.prototype.clear=Kf;lr.prototype.delete=Vf;lr.prototype.get=Yf;lr.prototype.has=Jf;lr.prototype.set=Zf;var En=lr,Xf=En;function Qf(){this.__data__=new Xf,this.size=0}var ed=Qf;function td(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}var rd=td;function nd(n){return this.__data__.get(n)}var id=nd;function od(n){return this.__data__.has(n)}var ad=od,sd=typeof Te=="object"&&Te&&Te.Object===Object&&Te,ss=sd,ld=ss,cd=typeof self=="object"&&self&&self.Object===Object&&self,ud=ld||cd||Function("return this")(),bt=ud,fd=bt,dd=fd.Symbol,Ii=dd,$o=Ii,ls=Object.prototype,hd=ls.hasOwnProperty,pd=ls.toString,Or=$o?$o.toStringTag:void 0;function gd(n){var e=hd.call(n,Or),t=n[Or];try{n[Or]=void 0;var r=!0}catch{}var i=pd.call(n);return r&&(e?n[Or]=t:delete n[Or]),i}var vd=gd,yd=Object.prototype,md=yd.toString;function bd(n){return md.call(n)}var _d=bd,qo=Ii,xd=vd,wd=_d,kd="[object Null]",Ed="[object Undefined]",Uo=qo?qo.toStringTag:void 0;function Od(n){return n==null?n===void 0?Ed:kd:Uo&&Uo in Object(n)?xd(n):wd(n)}var On=Od;function jd(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var cs=jd,Sd=On,Ad=cs,Td="[object AsyncFunction]",Cd="[object Function]",Pd="[object GeneratorFunction]",Ld="[object Proxy]";function Rd(n){if(!Ad(n))return!1;var e=Sd(n);return e==Cd||e==Pd||e==Td||e==Ld}var us=Rd,Nd=bt,Id=Nd["__core-js_shared__"],Dd=Id,Gn=Dd,Fo=function(){var n=/[^.]+$/.exec(Gn&&Gn.keys&&Gn.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function Md(n){return!!Fo&&Fo in n}var Bd=Md,$d=Function.prototype,qd=$d.toString;function Ud(n){if(n!=null){try{return qd.call(n)}catch{}try{return n+""}catch{}}return""}var fs=Ud,Fd=us,zd=Bd,Hd=cs,Wd=fs,Gd=/[\\^$.*+?()[\]{}|]/g,Kd=/^\[object .+?Constructor\]$/,Vd=Function.prototype,Yd=Object.prototype,Jd=Vd.toString,Zd=Yd.hasOwnProperty,Xd=RegExp("^"+Jd.call(Zd).replace(Gd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qd(n){if(!Hd(n)||zd(n))return!1;var e=Fd(n)?Xd:Kd;return e.test(Wd(n))}var eh=Qd;function th(n,e){return n==null?void 0:n[e]}var rh=th,nh=eh,ih=rh;function oh(n,e){var t=ih(n,e);return nh(t)?t:void 0}var cr=oh,ah=cr,sh=bt,lh=ah(sh,"Map"),Di=lh,ch=cr,uh=ch(Object,"create"),jn=uh,zo=jn;function fh(){this.__data__=zo?zo(null):{},this.size=0}var dh=fh;function hh(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var ph=hh,gh=jn,vh="__lodash_hash_undefined__",yh=Object.prototype,mh=yh.hasOwnProperty;function bh(n){var e=this.__data__;if(gh){var t=e[n];return t===vh?void 0:t}return mh.call(e,n)?e[n]:void 0}var _h=bh,xh=jn,wh=Object.prototype,kh=wh.hasOwnProperty;function Eh(n){var e=this.__data__;return xh?e[n]!==void 0:kh.call(e,n)}var Oh=Eh,jh=jn,Sh="__lodash_hash_undefined__";function Ah(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=jh&&e===void 0?Sh:e,this}var Th=Ah,Ch=dh,Ph=ph,Lh=_h,Rh=Oh,Nh=Th;function ur(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}ur.prototype.clear=Ch;ur.prototype.delete=Ph;ur.prototype.get=Lh;ur.prototype.has=Rh;ur.prototype.set=Nh;var Ih=ur,Ho=Ih,Dh=En,Mh=Di;function Bh(){this.size=0,this.__data__={hash:new Ho,map:new(Mh||Dh),string:new Ho}}var $h=Bh;function qh(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}var Uh=qh,Fh=Uh;function zh(n,e){var t=n.__data__;return Fh(e)?t[typeof e=="string"?"string":"hash"]:t.map}var Sn=zh,Hh=Sn;function Wh(n){var e=Hh(this,n).delete(n);return this.size-=e?1:0,e}var Gh=Wh,Kh=Sn;function Vh(n){return Kh(this,n).get(n)}var Yh=Vh,Jh=Sn;function Zh(n){return Jh(this,n).has(n)}var Xh=Zh,Qh=Sn;function ep(n,e){var t=Qh(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}var tp=ep,rp=$h,np=Gh,ip=Yh,op=Xh,ap=tp;function fr(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}fr.prototype.clear=rp;fr.prototype.delete=np;fr.prototype.get=ip;fr.prototype.has=op;fr.prototype.set=ap;var ds=fr,sp=En,lp=Di,cp=ds,up=200;function fp(n,e){var t=this.__data__;if(t instanceof sp){var r=t.__data__;if(!lp||r.length<up-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new cp(r)}return t.set(n,e),this.size=t.size,this}var dp=fp,hp=En,pp=ed,gp=rd,vp=id,yp=ad,mp=dp;function dr(n){var e=this.__data__=new hp(n);this.size=e.size}dr.prototype.clear=pp;dr.prototype.delete=gp;dr.prototype.get=vp;dr.prototype.has=yp;dr.prototype.set=mp;var bp=dr,_p="__lodash_hash_undefined__";function xp(n){return this.__data__.set(n,_p),this}var wp=xp;function kp(n){return this.__data__.has(n)}var Ep=kp,Op=ds,jp=wp,Sp=Ep;function cn(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new Op;++e<t;)this.add(n[e])}cn.prototype.add=cn.prototype.push=jp;cn.prototype.has=Sp;var Ap=cn;function Tp(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}var Cp=Tp;function Pp(n,e){return n.has(e)}var Lp=Pp,Rp=Ap,Np=Cp,Ip=Lp,Dp=1,Mp=2;function Bp(n,e,t,r,i,o){var a=t&Dp,g=n.length,d=e.length;if(g!=d&&!(a&&d>g))return!1;var v=o.get(n),u=o.get(e);if(v&&u)return v==e&&u==n;var f=-1,l=!0,c=t&Mp?new Rp:void 0;for(o.set(n,e),o.set(e,n);++f<g;){var _=n[f],y=e[f];if(r)var b=a?r(y,_,f,e,n,o):r(_,y,f,n,e,o);if(b!==void 0){if(b)continue;l=!1;break}if(c){if(!Np(e,function(h,m){if(!Ip(c,m)&&(_===h||i(_,h,t,r,o)))return c.push(m)})){l=!1;break}}else if(!(_===y||i(_,y,t,r,o))){l=!1;break}}return o.delete(n),o.delete(e),l}var hs=Bp,$p=bt,qp=$p.Uint8Array,Up=qp;function Fp(n){var e=-1,t=Array(n.size);return n.forEach(function(r,i){t[++e]=[i,r]}),t}var zp=Fp;function Hp(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var Wp=Hp,Wo=Ii,Go=Up,Gp=as,Kp=hs,Vp=zp,Yp=Wp,Jp=1,Zp=2,Xp="[object Boolean]",Qp="[object Date]",eg="[object Error]",tg="[object Map]",rg="[object Number]",ng="[object RegExp]",ig="[object Set]",og="[object String]",ag="[object Symbol]",sg="[object ArrayBuffer]",lg="[object DataView]",Ko=Wo?Wo.prototype:void 0,Kn=Ko?Ko.valueOf:void 0;function cg(n,e,t,r,i,o,a){switch(t){case lg:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case sg:return!(n.byteLength!=e.byteLength||!o(new Go(n),new Go(e)));case Xp:case Qp:case rg:return Gp(+n,+e);case eg:return n.name==e.name&&n.message==e.message;case ng:case og:return n==e+"";case tg:var g=Vp;case ig:var d=r&Jp;if(g||(g=Yp),n.size!=e.size&&!d)return!1;var v=a.get(n);if(v)return v==e;r|=Zp,a.set(n,e);var u=Kp(g(n),g(e),r,i,o,a);return a.delete(n),u;case ag:if(Kn)return Kn.call(n)==Kn.call(e)}return!1}var ug=cg;function fg(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}var dg=fg,hg=Array.isArray,Mi=hg,pg=dg,gg=Mi;function vg(n,e,t){var r=e(n);return gg(n)?r:pg(r,t(n))}var yg=vg;function mg(n,e){for(var t=-1,r=n==null?0:n.length,i=0,o=[];++t<r;){var a=n[t];e(a,t,n)&&(o[i++]=a)}return o}var bg=mg;function _g(){return[]}var xg=_g,wg=bg,kg=xg,Eg=Object.prototype,Og=Eg.propertyIsEnumerable,Vo=Object.getOwnPropertySymbols,jg=Vo?function(n){return n==null?[]:(n=Object(n),wg(Vo(n),function(e){return Og.call(n,e)}))}:kg,Sg=jg;function Ag(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var Tg=Ag;function Cg(n){return n!=null&&typeof n=="object"}var An=Cg,Pg=On,Lg=An,Rg="[object Arguments]";function Ng(n){return Lg(n)&&Pg(n)==Rg}var Ig=Ng,Yo=Ig,Dg=An,ps=Object.prototype,Mg=ps.hasOwnProperty,Bg=ps.propertyIsEnumerable,$g=Yo(function(){return arguments}())?Yo:function(n){return Dg(n)&&Mg.call(n,"callee")&&!Bg.call(n,"callee")},qg=$g,un={exports:{}};function Ug(){return!1}var Fg=Ug;un.exports;(function(n,e){var t=bt,r=Fg,i=e&&!e.nodeType&&e,o=i&&!0&&n&&!n.nodeType&&n,a=o&&o.exports===i,g=a?t.Buffer:void 0,d=g?g.isBuffer:void 0,v=d||r;n.exports=v})(un,un.exports);var gs=un.exports,zg=9007199254740991,Hg=/^(?:0|[1-9]\d*)$/;function Wg(n,e){var t=typeof n;return e=e??zg,!!e&&(t=="number"||t!="symbol"&&Hg.test(n))&&n>-1&&n%1==0&&n<e}var Gg=Wg,Kg=9007199254740991;function Vg(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=Kg}var vs=Vg,Yg=On,Jg=vs,Zg=An,Xg="[object Arguments]",Qg="[object Array]",ev="[object Boolean]",tv="[object Date]",rv="[object Error]",nv="[object Function]",iv="[object Map]",ov="[object Number]",av="[object Object]",sv="[object RegExp]",lv="[object Set]",cv="[object String]",uv="[object WeakMap]",fv="[object ArrayBuffer]",dv="[object DataView]",hv="[object Float32Array]",pv="[object Float64Array]",gv="[object Int8Array]",vv="[object Int16Array]",yv="[object Int32Array]",mv="[object Uint8Array]",bv="[object Uint8ClampedArray]",_v="[object Uint16Array]",xv="[object Uint32Array]",Se={};Se[hv]=Se[pv]=Se[gv]=Se[vv]=Se[yv]=Se[mv]=Se[bv]=Se[_v]=Se[xv]=!0;Se[Xg]=Se[Qg]=Se[fv]=Se[ev]=Se[dv]=Se[tv]=Se[rv]=Se[nv]=Se[iv]=Se[ov]=Se[av]=Se[sv]=Se[lv]=Se[cv]=Se[uv]=!1;function wv(n){return Zg(n)&&Jg(n.length)&&!!Se[Yg(n)]}var kv=wv;function Ev(n){return function(e){return n(e)}}var Ov=Ev,fn={exports:{}};fn.exports;(function(n,e){var t=ss,r=e&&!e.nodeType&&e,i=r&&!0&&n&&!n.nodeType&&n,o=i&&i.exports===r,a=o&&t.process,g=function(){try{var d=i&&i.require&&i.require("util").types;return d||a&&a.binding&&a.binding("util")}catch{}}();n.exports=g})(fn,fn.exports);var jv=fn.exports,Sv=kv,Av=Ov,Jo=jv,Zo=Jo&&Jo.isTypedArray,Tv=Zo?Av(Zo):Sv,ys=Tv,Cv=Tg,Pv=qg,Lv=Mi,Rv=gs,Nv=Gg,Iv=ys,Dv=Object.prototype,Mv=Dv.hasOwnProperty;function Bv(n,e){var t=Lv(n),r=!t&&Pv(n),i=!t&&!r&&Rv(n),o=!t&&!r&&!i&&Iv(n),a=t||r||i||o,g=a?Cv(n.length,String):[],d=g.length;for(var v in n)(e||Mv.call(n,v))&&!(a&&(v=="length"||i&&(v=="offset"||v=="parent")||o&&(v=="buffer"||v=="byteLength"||v=="byteOffset")||Nv(v,d)))&&g.push(v);return g}var $v=Bv,qv=Object.prototype;function Uv(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||qv;return n===t}var Fv=Uv;function zv(n,e){return function(t){return n(e(t))}}var Hv=zv,Wv=Hv,Gv=Wv(Object.keys,Object),Kv=Gv,Vv=Fv,Yv=Kv,Jv=Object.prototype,Zv=Jv.hasOwnProperty;function Xv(n){if(!Vv(n))return Yv(n);var e=[];for(var t in Object(n))Zv.call(n,t)&&t!="constructor"&&e.push(t);return e}var Qv=Xv,ey=us,ty=vs;function ry(n){return n!=null&&ty(n.length)&&!ey(n)}var ny=ry,iy=$v,oy=Qv,ay=ny;function sy(n){return ay(n)?iy(n):oy(n)}var ly=sy,cy=yg,uy=Sg,fy=ly;function dy(n){return cy(n,fy,uy)}var hy=dy,Xo=hy,py=1,gy=Object.prototype,vy=gy.hasOwnProperty;function yy(n,e,t,r,i,o){var a=t&py,g=Xo(n),d=g.length,v=Xo(e),u=v.length;if(d!=u&&!a)return!1;for(var f=d;f--;){var l=g[f];if(!(a?l in e:vy.call(e,l)))return!1}var c=o.get(n),_=o.get(e);if(c&&_)return c==e&&_==n;var y=!0;o.set(n,e),o.set(e,n);for(var b=a;++f<d;){l=g[f];var h=n[l],m=e[l];if(r)var x=a?r(m,h,l,e,n,o):r(h,m,l,n,e,o);if(!(x===void 0?h===m||i(h,m,t,r,o):x)){y=!1;break}b||(b=l=="constructor")}if(y&&!b){var p=n.constructor,w=e.constructor;p!=w&&"constructor"in n&&"constructor"in e&&!(typeof p=="function"&&p instanceof p&&typeof w=="function"&&w instanceof w)&&(y=!1)}return o.delete(n),o.delete(e),y}var my=yy,by=cr,_y=bt,xy=by(_y,"DataView"),wy=xy,ky=cr,Ey=bt,Oy=ky(Ey,"Promise"),jy=Oy,Sy=cr,Ay=bt,Ty=Sy(Ay,"Set"),Cy=Ty,Py=cr,Ly=bt,Ry=Py(Ly,"WeakMap"),Ny=Ry,_i=wy,xi=Di,wi=jy,ki=Cy,Ei=Ny,ms=On,hr=fs,Qo="[object Map]",Iy="[object Object]",ea="[object Promise]",ta="[object Set]",ra="[object WeakMap]",na="[object DataView]",Dy=hr(_i),My=hr(xi),By=hr(wi),$y=hr(ki),qy=hr(Ei),Dt=ms;(_i&&Dt(new _i(new ArrayBuffer(1)))!=na||xi&&Dt(new xi)!=Qo||wi&&Dt(wi.resolve())!=ea||ki&&Dt(new ki)!=ta||Ei&&Dt(new Ei)!=ra)&&(Dt=function(n){var e=ms(n),t=e==Iy?n.constructor:void 0,r=t?hr(t):"";if(r)switch(r){case Dy:return na;case My:return Qo;case By:return ea;case $y:return ta;case qy:return ra}return e});var Uy=Dt,Vn=bp,Fy=hs,zy=ug,Hy=my,ia=Uy,oa=Mi,aa=gs,Wy=ys,Gy=1,sa="[object Arguments]",la="[object Array]",Yr="[object Object]",Ky=Object.prototype,ca=Ky.hasOwnProperty;function Vy(n,e,t,r,i,o){var a=oa(n),g=oa(e),d=a?la:ia(n),v=g?la:ia(e);d=d==sa?Yr:d,v=v==sa?Yr:v;var u=d==Yr,f=v==Yr,l=d==v;if(l&&aa(n)){if(!aa(e))return!1;a=!0,u=!1}if(l&&!u)return o||(o=new Vn),a||Wy(n)?Fy(n,e,t,r,i,o):zy(n,e,d,t,r,i,o);if(!(t&Gy)){var c=u&&ca.call(n,"__wrapped__"),_=f&&ca.call(e,"__wrapped__");if(c||_){var y=c?n.value():n,b=_?e.value():e;return o||(o=new Vn),i(y,b,t,r,o)}}return l?(o||(o=new Vn),Hy(n,e,t,r,i,o)):!1}var Yy=Vy,Jy=Yy,ua=An;function bs(n,e,t,r,i){return n===e?!0:n==null||e==null||!ua(n)&&!ua(e)?n!==n&&e!==e:Jy(n,e,t,r,bs,i)}var Zy=bs,Xy=Zy;function Qy(n,e){return Xy(n,e)}var em=Qy,_s={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(n,e){(function(r,i){n.exports=i()})(typeof self<"u"?self:Te,function(){return function(t){var r={};function i(o){if(r[o])return r[o].exports;var a=r[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=t,i.c=r,i.d=function(o,a,g){i.o(o,a)||Object.defineProperty(o,a,{configurable:!1,enumerable:!0,get:g})},i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,"a",a),a},i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},i.p="",i(i.s=109)}([function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(17),a=i(18),g=i(19),d=i(45),v=i(46),u=i(47),f=i(48),l=i(49),c=i(12),_=i(32),y=i(33),b=i(31),h=i(1),m={Scope:h.Scope,create:h.create,find:h.find,query:h.query,register:h.register,Container:o.default,Format:a.default,Leaf:g.default,Embed:f.default,Scroll:d.default,Block:u.default,Inline:v.default,Text:l.default,Attributor:{Attribute:c.default,Class:_.default,Style:y.default,Store:b.default}};r.default=m},function(t,r,i){var o=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,m){h.__proto__=m}||function(h,m){for(var x in m)m.hasOwnProperty(x)&&(h[x]=m[x])};return function(h,m){b(h,m);function x(){this.constructor=h}h.prototype=m===null?Object.create(m):(x.prototype=m.prototype,new x)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=function(b){o(h,b);function h(m){var x=this;return m="[Parchment] "+m,x=b.call(this,m)||this,x.message=m,x.name=x.constructor.name,x}return h}(Error);r.ParchmentError=a;var g={},d={},v={},u={};r.DATA_KEY="__blot";var f;(function(b){b[b.TYPE=3]="TYPE",b[b.LEVEL=12]="LEVEL",b[b.ATTRIBUTE=13]="ATTRIBUTE",b[b.BLOT=14]="BLOT",b[b.INLINE=7]="INLINE",b[b.BLOCK=11]="BLOCK",b[b.BLOCK_BLOT=10]="BLOCK_BLOT",b[b.INLINE_BLOT=6]="INLINE_BLOT",b[b.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",b[b.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",b[b.ANY=15]="ANY"})(f=r.Scope||(r.Scope={}));function l(b,h){var m=_(b);if(m==null)throw new a("Unable to create "+b+" blot");var x=m,p=b instanceof Node||b.nodeType===Node.TEXT_NODE?b:x.create(h);return new x(p,h)}r.create=l;function c(b,h){return h===void 0&&(h=!1),b==null?null:b[r.DATA_KEY]!=null?b[r.DATA_KEY].blot:h?c(b.parentNode,h):null}r.find=c;function _(b,h){h===void 0&&(h=f.ANY);var m;if(typeof b=="string")m=u[b]||g[b];else if(b instanceof Text||b.nodeType===Node.TEXT_NODE)m=u.text;else if(typeof b=="number")b&f.LEVEL&f.BLOCK?m=u.block:b&f.LEVEL&f.INLINE&&(m=u.inline);else if(b instanceof HTMLElement){var x=(b.getAttribute("class")||"").split(/\s+/);for(var p in x)if(m=d[x[p]],m)break;m=m||v[b.tagName]}return m==null?null:h&f.LEVEL&m.scope&&h&f.TYPE&m.scope?m:null}r.query=_;function y(){for(var b=[],h=0;h<arguments.length;h++)b[h]=arguments[h];if(b.length>1)return b.map(function(p){return y(p)});var m=b[0];if(typeof m.blotName!="string"&&typeof m.attrName!="string")throw new a("Invalid definition");if(m.blotName==="abstract")throw new a("Cannot register abstract class");if(u[m.blotName||m.attrName]=m,typeof m.keyName=="string")g[m.keyName]=m;else if(m.className!=null&&(d[m.className]=m),m.tagName!=null){Array.isArray(m.tagName)?m.tagName=m.tagName.map(function(p){return p.toUpperCase()}):m.tagName=m.tagName.toUpperCase();var x=Array.isArray(m.tagName)?m.tagName:[m.tagName];x.forEach(function(p){(v[p]==null||m.className==null)&&(v[p]=m)})}return m}r.register=y},function(t,r,i){var o=i(51),a=i(11),g=i(3),d=i(20),v="\0",u=function(f){Array.isArray(f)?this.ops=f:f!=null&&Array.isArray(f.ops)?this.ops=f.ops:this.ops=[]};u.prototype.insert=function(f,l){var c={};return f.length===0?this:(c.insert=f,l!=null&&typeof l=="object"&&Object.keys(l).length>0&&(c.attributes=l),this.push(c))},u.prototype.delete=function(f){return f<=0?this:this.push({delete:f})},u.prototype.retain=function(f,l){if(f<=0)return this;var c={retain:f};return l!=null&&typeof l=="object"&&Object.keys(l).length>0&&(c.attributes=l),this.push(c)},u.prototype.push=function(f){var l=this.ops.length,c=this.ops[l-1];if(f=g(!0,{},f),typeof c=="object"){if(typeof f.delete=="number"&&typeof c.delete=="number")return this.ops[l-1]={delete:c.delete+f.delete},this;if(typeof c.delete=="number"&&f.insert!=null&&(l-=1,c=this.ops[l-1],typeof c!="object"))return this.ops.unshift(f),this;if(a(f.attributes,c.attributes)){if(typeof f.insert=="string"&&typeof c.insert=="string")return this.ops[l-1]={insert:c.insert+f.insert},typeof f.attributes=="object"&&(this.ops[l-1].attributes=f.attributes),this;if(typeof f.retain=="number"&&typeof c.retain=="number")return this.ops[l-1]={retain:c.retain+f.retain},typeof f.attributes=="object"&&(this.ops[l-1].attributes=f.attributes),this}}return l===this.ops.length?this.ops.push(f):this.ops.splice(l,0,f),this},u.prototype.chop=function(){var f=this.ops[this.ops.length-1];return f&&f.retain&&!f.attributes&&this.ops.pop(),this},u.prototype.filter=function(f){return this.ops.filter(f)},u.prototype.forEach=function(f){this.ops.forEach(f)},u.prototype.map=function(f){return this.ops.map(f)},u.prototype.partition=function(f){var l=[],c=[];return this.forEach(function(_){var y=f(_)?l:c;y.push(_)}),[l,c]},u.prototype.reduce=function(f,l){return this.ops.reduce(f,l)},u.prototype.changeLength=function(){return this.reduce(function(f,l){return l.insert?f+d.length(l):l.delete?f-l.delete:f},0)},u.prototype.length=function(){return this.reduce(function(f,l){return f+d.length(l)},0)},u.prototype.slice=function(f,l){f=f||0,typeof l!="number"&&(l=1/0);for(var c=[],_=d.iterator(this.ops),y=0;y<l&&_.hasNext();){var b;y<f?b=_.next(f-y):(b=_.next(l-y),c.push(b)),y+=d.length(b)}return new u(c)},u.prototype.compose=function(f){var l=d.iterator(this.ops),c=d.iterator(f.ops),_=[],y=c.peek();if(y!=null&&typeof y.retain=="number"&&y.attributes==null){for(var b=y.retain;l.peekType()==="insert"&&l.peekLength()<=b;)b-=l.peekLength(),_.push(l.next());y.retain-b>0&&c.next(y.retain-b)}for(var h=new u(_);l.hasNext()||c.hasNext();)if(c.peekType()==="insert")h.push(c.next());else if(l.peekType()==="delete")h.push(l.next());else{var m=Math.min(l.peekLength(),c.peekLength()),x=l.next(m),p=c.next(m);if(typeof p.retain=="number"){var w={};typeof x.retain=="number"?w.retain=m:w.insert=x.insert;var T=d.attributes.compose(x.attributes,p.attributes,typeof x.retain=="number");if(T&&(w.attributes=T),h.push(w),!c.hasNext()&&a(h.ops[h.ops.length-1],w)){var S=new u(l.rest());return h.concat(S).chop()}}else typeof p.delete=="number"&&typeof x.retain=="number"&&h.push(p)}return h.chop()},u.prototype.concat=function(f){var l=new u(this.ops.slice());return f.ops.length>0&&(l.push(f.ops[0]),l.ops=l.ops.concat(f.ops.slice(1))),l},u.prototype.diff=function(f,l){if(this.ops===f.ops)return new u;var c=[this,f].map(function(m){return m.map(function(x){if(x.insert!=null)return typeof x.insert=="string"?x.insert:v;var p=m===f?"on":"with";throw new Error("diff() called "+p+" non-document")}).join("")}),_=new u,y=o(c[0],c[1],l),b=d.iterator(this.ops),h=d.iterator(f.ops);return y.forEach(function(m){for(var x=m[1].length;x>0;){var p=0;switch(m[0]){case o.INSERT:p=Math.min(h.peekLength(),x),_.push(h.next(p));break;case o.DELETE:p=Math.min(x,b.peekLength()),b.next(p),_.delete(p);break;case o.EQUAL:p=Math.min(b.peekLength(),h.peekLength(),x);var w=b.next(p),T=h.next(p);a(w.insert,T.insert)?_.retain(p,d.attributes.diff(w.attributes,T.attributes)):_.push(T).delete(p);break}x-=p}}),_.chop()},u.prototype.eachLine=function(f,l){l=l||`
`;for(var c=d.iterator(this.ops),_=new u,y=0;c.hasNext();){if(c.peekType()!=="insert")return;var b=c.peek(),h=d.length(b)-c.peekLength(),m=typeof b.insert=="string"?b.insert.indexOf(l,h)-h:-1;if(m<0)_.push(c.next());else if(m>0)_.push(c.next(m));else{if(f(_,c.next(1).attributes||{},y)===!1)return;y+=1,_=new u}}_.length()>0&&f(_,{},y)},u.prototype.transform=function(f,l){if(l=!!l,typeof f=="number")return this.transformPosition(f,l);for(var c=d.iterator(this.ops),_=d.iterator(f.ops),y=new u;c.hasNext()||_.hasNext();)if(c.peekType()==="insert"&&(l||_.peekType()!=="insert"))y.retain(d.length(c.next()));else if(_.peekType()==="insert")y.push(_.next());else{var b=Math.min(c.peekLength(),_.peekLength()),h=c.next(b),m=_.next(b);if(h.delete)continue;m.delete?y.push(m):y.retain(b,d.attributes.transform(h.attributes,m.attributes,l))}return y.chop()},u.prototype.transformPosition=function(f,l){l=!!l;for(var c=d.iterator(this.ops),_=0;c.hasNext()&&_<=f;){var y=c.peekLength(),b=c.peekType();if(c.next(),b==="delete"){f-=Math.min(y,f-_);continue}else b==="insert"&&(_<f||!l)&&(f+=y);_+=y}return f},t.exports=u},function(t,r){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=Object.defineProperty,g=Object.getOwnPropertyDescriptor,d=function(c){return typeof Array.isArray=="function"?Array.isArray(c):o.call(c)==="[object Array]"},v=function(c){if(!c||o.call(c)!=="[object Object]")return!1;var _=i.call(c,"constructor"),y=c.constructor&&c.constructor.prototype&&i.call(c.constructor.prototype,"isPrototypeOf");if(c.constructor&&!_&&!y)return!1;var b;for(b in c);return typeof b>"u"||i.call(c,b)},u=function(c,_){a&&_.name==="__proto__"?a(c,_.name,{enumerable:!0,configurable:!0,value:_.newValue,writable:!0}):c[_.name]=_.newValue},f=function(c,_){if(_==="__proto__")if(i.call(c,_)){if(g)return g(c,_).value}else return;return c[_]};t.exports=function l(){var c,_,y,b,h,m,x=arguments[0],p=1,w=arguments.length,T=!1;for(typeof x=="boolean"&&(T=x,x=arguments[1]||{},p=2),(x==null||typeof x!="object"&&typeof x!="function")&&(x={});p<w;++p)if(c=arguments[p],c!=null)for(_ in c)y=f(x,_),b=f(c,_),x!==b&&(T&&b&&(v(b)||(h=d(b)))?(h?(h=!1,m=y&&d(y)?y:[]):m=y&&v(y)?y:{},u(x,{name:_,newValue:l(T,m,b)})):typeof b<"u"&&u(x,{name:_,newValue:b}));return x}},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BlockEmbed=r.bubbleFormats=void 0;var o=function(){function k(E,C){for(var L=0;L<C.length;L++){var M=C[L];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(E,M.key,M)}}return function(E,C,L){return C&&k(E.prototype,C),L&&k(E,L),E}}(),a=function k(E,C,L){E===null&&(E=Function.prototype);var M=Object.getOwnPropertyDescriptor(E,C);if(M===void 0){var z=Object.getPrototypeOf(E);return z===null?void 0:k(z,C,L)}else{if("value"in M)return M.value;var B=M.get;return B===void 0?void 0:B.call(L)}},g=i(3),d=x(g),v=i(2),u=x(v),f=i(0),l=x(f),c=i(16),_=x(c),y=i(6),b=x(y),h=i(7),m=x(h);function x(k){return k&&k.__esModule?k:{default:k}}function p(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function w(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function T(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var S=1,O=function(k){T(E,k);function E(){return p(this,E),w(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return o(E,[{key:"attach",value:function(){a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"attach",this).call(this),this.attributes=new l.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new u.default().insert(this.value(),(0,d.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(L,M){var z=l.default.query(L,l.default.Scope.BLOCK_ATTRIBUTE);z!=null&&this.attributes.attribute(z,M)}},{key:"formatAt",value:function(L,M,z,B){this.format(z,B)}},{key:"insertAt",value:function(L,M,z){if(typeof M=="string"&&M.endsWith(`
`)){var B=l.default.create(P.blotName);this.parent.insertBefore(B,L===0?this:this.next),B.insertAt(0,M.slice(0,-1))}else a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"insertAt",this).call(this,L,M,z)}}]),E}(l.default.Embed);O.scope=l.default.Scope.BLOCK_BLOT;var P=function(k){T(E,k);function E(C){p(this,E);var L=w(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,C));return L.cache={},L}return o(E,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(l.default.Leaf).reduce(function(L,M){return M.length()===0?L:L.insert(M.value(),j(M))},new u.default).insert(`
`,j(this))),this.cache.delta}},{key:"deleteAt",value:function(L,M){a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"deleteAt",this).call(this,L,M),this.cache={}}},{key:"formatAt",value:function(L,M,z,B){M<=0||(l.default.query(z,l.default.Scope.BLOCK)?L+M===this.length()&&this.format(z,B):a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"formatAt",this).call(this,L,Math.min(M,this.length()-L-1),z,B),this.cache={})}},{key:"insertAt",value:function(L,M,z){if(z!=null)return a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"insertAt",this).call(this,L,M,z);if(M.length!==0){var B=M.split(`
`),K=B.shift();K.length>0&&(L<this.length()-1||this.children.tail==null?a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"insertAt",this).call(this,Math.min(L,this.length()-1),K):this.children.tail.insertAt(this.children.tail.length(),K),this.cache={});var q=this;B.reduce(function(D,A){return q=q.split(D,!0),q.insertAt(0,A),A.length},L+K.length)}}},{key:"insertBefore",value:function(L,M){var z=this.children.head;a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"insertBefore",this).call(this,L,M),z instanceof _.default&&z.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"length",this).call(this)+S),this.cache.length}},{key:"moveChildren",value:function(L,M){a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"moveChildren",this).call(this,L,M),this.cache={}}},{key:"optimize",value:function(L){a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"optimize",this).call(this,L),this.cache={}}},{key:"path",value:function(L){return a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"path",this).call(this,L,!0)}},{key:"removeChild",value:function(L){a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"removeChild",this).call(this,L),this.cache={}}},{key:"split",value:function(L){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(M&&(L===0||L>=this.length()-S)){var z=this.clone();return L===0?(this.parent.insertBefore(z,this),this):(this.parent.insertBefore(z,this.next),z)}else{var B=a(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"split",this).call(this,L,M);return this.cache={},B}}}]),E}(l.default.Block);P.blotName="block",P.tagName="P",P.defaultChild="break",P.allowedChildren=[b.default,l.default.Embed,m.default];function j(k){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k==null||(typeof k.formats=="function"&&(E=(0,d.default)(E,k.formats())),k.parent==null||k.parent.blotName=="scroll"||k.parent.statics.scope!==k.statics.scope)?E:j(k.parent,E)}r.bubbleFormats=j,r.BlockEmbed=O,r.default=P},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.overload=r.expandConfig=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},a=function(){function q(D,A){var N=[],I=!0,H=!1,U=void 0;try{for(var R=D[Symbol.iterator](),$;!(I=($=R.next()).done)&&(N.push($.value),!(A&&N.length===A));I=!0);}catch(G){H=!0,U=G}finally{try{!I&&R.return&&R.return()}finally{if(H)throw U}}return N}return function(D,A){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return q(D,A);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function q(D,A){for(var N=0;N<A.length;N++){var I=A[N];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(D,I.key,I)}}return function(D,A,N){return A&&q(D.prototype,A),N&&q(D,N),D}}();i(50);var d=i(2),v=j(d),u=i(14),f=j(u),l=i(8),c=j(l),_=i(9),y=j(_),b=i(0),h=j(b),m=i(15),x=j(m),p=i(3),w=j(p),T=i(10),S=j(T),O=i(34),P=j(O);function j(q){return q&&q.__esModule?q:{default:q}}function k(q,D,A){return D in q?Object.defineProperty(q,D,{value:A,enumerable:!0,configurable:!0,writable:!0}):q[D]=A,q}function E(q,D){if(!(q instanceof D))throw new TypeError("Cannot call a class as a function")}var C=(0,S.default)("quill"),L=function(){g(q,null,[{key:"debug",value:function(A){A===!0&&(A="log"),S.default.level(A)}},{key:"find",value:function(A){return A.__quill||h.default.find(A)}},{key:"import",value:function(A){return this.imports[A]==null&&C.error("Cannot import "+A+". Are you sure it was registered?"),this.imports[A]}},{key:"register",value:function(A,N){var I=this,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof A!="string"){var U=A.attrName||A.blotName;typeof U=="string"?this.register("formats/"+U,A,N):Object.keys(A).forEach(function(R){I.register(R,A[R],N)})}else this.imports[A]!=null&&!H&&C.warn("Overwriting "+A+" with",N),this.imports[A]=N,(A.startsWith("blots/")||A.startsWith("formats/"))&&N.blotName!=="abstract"?h.default.register(N):A.startsWith("modules")&&typeof N.register=="function"&&N.register()}}]);function q(D){var A=this,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(E(this,q),this.options=M(D,N),this.container=this.options.container,this.container==null)return C.error("Invalid Quill container",D);this.options.debug&&q.debug(this.options.debug);var I=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new c.default,this.scroll=h.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new f.default(this.scroll),this.selection=new x.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(c.default.events.EDITOR_CHANGE,function(U){U===c.default.events.TEXT_CHANGE&&A.root.classList.toggle("ql-blank",A.editor.isBlank())}),this.emitter.on(c.default.events.SCROLL_UPDATE,function(U,R){var $=A.selection.lastRange,G=$&&$.length===0?$.index:void 0;z.call(A,function(){return A.editor.update(null,R,G)},U)});var H=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+I+"<p><br></p></div>");this.setContents(H),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return g(q,[{key:"addContainer",value:function(A){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof A=="string"){var I=A;A=document.createElement("div"),A.classList.add(I)}return this.container.insertBefore(A,N),A}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(A,N,I){var H=this,U=B(A,N,I),R=a(U,4);return A=R[0],N=R[1],I=R[3],z.call(this,function(){return H.editor.deleteText(A,N)},I,A,-1*N)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(A),this.container.classList.toggle("ql-disabled",!A)}},{key:"focus",value:function(){var A=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=A,this.scrollIntoView()}},{key:"format",value:function(A,N){var I=this,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c.default.sources.API;return z.call(this,function(){var U=I.getSelection(!0),R=new v.default;if(U==null)return R;if(h.default.query(A,h.default.Scope.BLOCK))R=I.editor.formatLine(U.index,U.length,k({},A,N));else{if(U.length===0)return I.selection.format(A,N),R;R=I.editor.formatText(U.index,U.length,k({},A,N))}return I.setSelection(U,c.default.sources.SILENT),R},H)}},{key:"formatLine",value:function(A,N,I,H,U){var R=this,$=void 0,G=B(A,N,I,H,U),W=a(G,4);return A=W[0],N=W[1],$=W[2],U=W[3],z.call(this,function(){return R.editor.formatLine(A,N,$)},U,A,0)}},{key:"formatText",value:function(A,N,I,H,U){var R=this,$=void 0,G=B(A,N,I,H,U),W=a(G,4);return A=W[0],N=W[1],$=W[2],U=W[3],z.call(this,function(){return R.editor.formatText(A,N,$)},U,A,0)}},{key:"getBounds",value:function(A){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,I=void 0;typeof A=="number"?I=this.selection.getBounds(A,N):I=this.selection.getBounds(A.index,A.length);var H=this.container.getBoundingClientRect();return{bottom:I.bottom-H.top,height:I.height,left:I.left-H.left,right:I.right-H.left,top:I.top-H.top,width:I.width}}},{key:"getContents",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-A,I=B(A,N),H=a(I,2);return A=H[0],N=H[1],this.editor.getContents(A,N)}},{key:"getFormat",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof A=="number"?this.editor.getFormat(A,N):this.editor.getFormat(A.index,A.length)}},{key:"getIndex",value:function(A){return A.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(A){return this.scroll.leaf(A)}},{key:"getLine",value:function(A){return this.scroll.line(A)}},{key:"getLines",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof A!="number"?this.scroll.lines(A.index,A.length):this.scroll.lines(A,N)}},{key:"getModule",value:function(A){return this.theme.modules[A]}},{key:"getSelection",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return A&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-A,I=B(A,N),H=a(I,2);return A=H[0],N=H[1],this.editor.getText(A,N)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(A,N,I){var H=this,U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:q.sources.API;return z.call(this,function(){return H.editor.insertEmbed(A,N,I)},U,A)}},{key:"insertText",value:function(A,N,I,H,U){var R=this,$=void 0,G=B(A,0,I,H,U),W=a(G,4);return A=W[0],$=W[2],U=W[3],z.call(this,function(){return R.editor.insertText(A,N,$)},U,A,N.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(A,N,I){this.clipboard.dangerouslyPasteHTML(A,N,I)}},{key:"removeFormat",value:function(A,N,I){var H=this,U=B(A,N,I),R=a(U,4);return A=R[0],N=R[1],I=R[3],z.call(this,function(){return H.editor.removeFormat(A,N)},I,A)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(A){var N=this,I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c.default.sources.API;return z.call(this,function(){A=new v.default(A);var H=N.getLength(),U=N.editor.deleteText(0,H),R=N.editor.applyDelta(A),$=R.ops[R.ops.length-1];$!=null&&typeof $.insert=="string"&&$.insert[$.insert.length-1]===`
`&&(N.editor.deleteText(N.getLength()-1,1),R.delete(1));var G=U.compose(R);return G},I)}},{key:"setSelection",value:function(A,N,I){if(A==null)this.selection.setRange(null,N||q.sources.API);else{var H=B(A,N,I),U=a(H,4);A=U[0],N=U[1],I=U[3],this.selection.setRange(new m.Range(A,N),I),I!==c.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(A){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c.default.sources.API,I=new v.default().insert(A);return this.setContents(I,N)}},{key:"update",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:c.default.sources.USER,N=this.scroll.update(A);return this.selection.update(A),N}},{key:"updateContents",value:function(A){var N=this,I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c.default.sources.API;return z.call(this,function(){return A=new v.default(A),N.editor.applyDelta(A,I)},I,!0)}}]),q}();L.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},L.events=c.default.events,L.sources=c.default.sources,L.version="1.3.7",L.imports={delta:v.default,parchment:h.default,"core/module":y.default,"core/theme":P.default};function M(q,D){if(D=(0,w.default)(!0,{container:q,modules:{clipboard:!0,keyboard:!0,history:!0}},D),!D.theme||D.theme===L.DEFAULTS.theme)D.theme=P.default;else if(D.theme=L.import("themes/"+D.theme),D.theme==null)throw new Error("Invalid theme "+D.theme+". Did you register it?");var A=(0,w.default)(!0,{},D.theme.DEFAULTS);[A,D].forEach(function(H){H.modules=H.modules||{},Object.keys(H.modules).forEach(function(U){H.modules[U]===!0&&(H.modules[U]={})})});var N=Object.keys(A.modules).concat(Object.keys(D.modules)),I=N.reduce(function(H,U){var R=L.import("modules/"+U);return R==null?C.error("Cannot load "+U+" module. Are you sure you registered it?"):H[U]=R.DEFAULTS||{},H},{});return D.modules!=null&&D.modules.toolbar&&D.modules.toolbar.constructor!==Object&&(D.modules.toolbar={container:D.modules.toolbar}),D=(0,w.default)(!0,{},L.DEFAULTS,{modules:I},A,D),["bounds","container","scrollingContainer"].forEach(function(H){typeof D[H]=="string"&&(D[H]=document.querySelector(D[H]))}),D.modules=Object.keys(D.modules).reduce(function(H,U){return D.modules[U]&&(H[U]=D.modules[U]),H},{}),D}function z(q,D,A,N){if(this.options.strict&&!this.isEnabled()&&D===c.default.sources.USER)return new v.default;var I=A==null?null:this.getSelection(),H=this.editor.delta,U=q();if(I!=null&&(A===!0&&(A=I.index),N==null?I=K(I,U,D):N!==0&&(I=K(I,A,N,D)),this.setSelection(I,c.default.sources.SILENT)),U.length()>0){var R,$=[c.default.events.TEXT_CHANGE,U,H,D];if((R=this.emitter).emit.apply(R,[c.default.events.EDITOR_CHANGE].concat($)),D!==c.default.sources.SILENT){var G;(G=this.emitter).emit.apply(G,$)}}return U}function B(q,D,A,N,I){var H={};return typeof q.index=="number"&&typeof q.length=="number"?typeof D!="number"?(I=N,N=A,A=D,D=q.length,q=q.index):(D=q.length,q=q.index):typeof D!="number"&&(I=N,N=A,A=D,D=0),(typeof A>"u"?"undefined":o(A))==="object"?(H=A,I=N):typeof A=="string"&&(N!=null?H[A]=N:I=A),I=I||c.default.sources.API,[q,D,H,I]}function K(q,D,A,N){if(q==null)return null;var I=void 0,H=void 0;if(D instanceof v.default){var U=[q.index,q.index+q.length].map(function(W){return D.transformPosition(W,N!==c.default.sources.USER)}),R=a(U,2);I=R[0],H=R[1]}else{var $=[q.index,q.index+q.length].map(function(W){return W<D||W===D&&N===c.default.sources.USER?W:A>=0?W+A:Math.max(D,W+A)}),G=a($,2);I=G[0],H=G[1]}return new m.Range(I,H-I)}r.expandConfig=M,r.overload=B,r.default=L},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function b(h,m){for(var x=0;x<m.length;x++){var p=m[x];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(h,p.key,p)}}return function(h,m,x){return m&&b(h.prototype,m),x&&b(h,x),h}}(),a=function b(h,m,x){h===null&&(h=Function.prototype);var p=Object.getOwnPropertyDescriptor(h,m);if(p===void 0){var w=Object.getPrototypeOf(h);return w===null?void 0:b(w,m,x)}else{if("value"in p)return p.value;var T=p.get;return T===void 0?void 0:T.call(x)}},g=i(7),d=f(g),v=i(0),u=f(v);function f(b){return b&&b.__esModule?b:{default:b}}function l(b,h){if(!(b instanceof h))throw new TypeError("Cannot call a class as a function")}function c(b,h){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:b}function _(b,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);b.prototype=Object.create(h&&h.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(b,h):b.__proto__=h)}var y=function(b){_(h,b);function h(){return l(this,h),c(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}return o(h,[{key:"formatAt",value:function(x,p,w,T){if(h.compare(this.statics.blotName,w)<0&&u.default.query(w,u.default.Scope.BLOT)){var S=this.isolate(x,p);T&&S.wrap(w,T)}else a(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"formatAt",this).call(this,x,p,w,T)}},{key:"optimize",value:function(x){if(a(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"optimize",this).call(this,x),this.parent instanceof h&&h.compare(this.statics.blotName,this.parent.statics.blotName)>0){var p=this.parent.isolate(this.offset(),this.length());this.moveChildren(p),p.wrap(this)}}}],[{key:"compare",value:function(x,p){var w=h.order.indexOf(x),T=h.order.indexOf(p);return w>=0||T>=0?w-T:x===p?0:x<p?-1:1}}]),h}(u.default.Inline);y.allowedChildren=[y,u.default.Embed,d.default],y.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(0),a=g(o);function g(l){return l&&l.__esModule?l:{default:l}}function d(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function v(l,c){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:l}function u(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(l,c):l.__proto__=c)}var f=function(l){u(c,l);function c(){return d(this,c),v(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return c}(a.default.Text);r.default=f},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function m(x,p){for(var w=0;w<p.length;w++){var T=p[w];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(x,T.key,T)}}return function(x,p,w){return p&&m(x.prototype,p),w&&m(x,w),x}}(),a=function m(x,p,w){x===null&&(x=Function.prototype);var T=Object.getOwnPropertyDescriptor(x,p);if(T===void 0){var S=Object.getPrototypeOf(x);return S===null?void 0:m(S,p,w)}else{if("value"in T)return T.value;var O=T.get;return O===void 0?void 0:O.call(w)}},g=i(54),d=f(g),v=i(10),u=f(v);function f(m){return m&&m.__esModule?m:{default:m}}function l(m,x){if(!(m instanceof x))throw new TypeError("Cannot call a class as a function")}function c(m,x){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:m}function _(m,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);m.prototype=Object.create(x&&x.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(m,x):m.__proto__=x)}var y=(0,u.default)("quill:events"),b=["selectionchange","mousedown","mouseup","click"];b.forEach(function(m){document.addEventListener(m,function(){for(var x=arguments.length,p=Array(x),w=0;w<x;w++)p[w]=arguments[w];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(T){if(T.__quill&&T.__quill.emitter){var S;(S=T.__quill.emitter).handleDOM.apply(S,p)}})})});var h=function(m){_(x,m);function x(){l(this,x);var p=c(this,(x.__proto__||Object.getPrototypeOf(x)).call(this));return p.listeners={},p.on("error",y.error),p}return o(x,[{key:"emit",value:function(){y.log.apply(y,arguments),a(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(w){for(var T=arguments.length,S=Array(T>1?T-1:0),O=1;O<T;O++)S[O-1]=arguments[O];(this.listeners[w.type]||[]).forEach(function(P){var j=P.node,k=P.handler;(w.target===j||j.contains(w.target))&&k.apply(void 0,[w].concat(S))})}},{key:"listenDOM",value:function(w,T,S){this.listeners[w]||(this.listeners[w]=[]),this.listeners[w].push({node:T,handler:S})}}]),x}(d.default);h.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},h.sources={API:"api",SILENT:"silent",USER:"user"},r.default=h},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});function o(g,d){if(!(g instanceof d))throw new TypeError("Cannot call a class as a function")}var a=function g(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o(this,g),this.quill=d,this.options=v};a.DEFAULTS={},r.default=a},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=["error","warn","log","info"],a="warn";function g(v){if(o.indexOf(v)<=o.indexOf(a)){for(var u,f=arguments.length,l=Array(f>1?f-1:0),c=1;c<f;c++)l[c-1]=arguments[c];(u=console)[v].apply(u,l)}}function d(v){return o.reduce(function(u,f){return u[f]=g.bind(console,f,v),u},{})}g.level=d.level=function(v){a=v},r.default=d},function(t,r,i){var o=Array.prototype.slice,a=i(52),g=i(53),d=t.exports=function(l,c,_){return _||(_={}),l===c?!0:l instanceof Date&&c instanceof Date?l.getTime()===c.getTime():!l||!c||typeof l!="object"&&typeof c!="object"?_.strict?l===c:l==c:f(l,c,_)};function v(l){return l==null}function u(l){return!(!l||typeof l!="object"||typeof l.length!="number"||typeof l.copy!="function"||typeof l.slice!="function"||l.length>0&&typeof l[0]!="number")}function f(l,c,_){var y,b;if(v(l)||v(c)||l.prototype!==c.prototype)return!1;if(g(l))return g(c)?(l=o.call(l),c=o.call(c),d(l,c,_)):!1;if(u(l)){if(!u(c)||l.length!==c.length)return!1;for(y=0;y<l.length;y++)if(l[y]!==c[y])return!1;return!0}try{var h=a(l),m=a(c)}catch{return!1}if(h.length!=m.length)return!1;for(h.sort(),m.sort(),y=h.length-1;y>=0;y--)if(h[y]!=m[y])return!1;for(y=h.length-1;y>=0;y--)if(b=h[y],!d(l[b],c[b],_))return!1;return typeof l==typeof c}},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(1),a=function(){function g(d,v,u){u===void 0&&(u={}),this.attrName=d,this.keyName=v;var f=o.Scope.TYPE&o.Scope.ATTRIBUTE;u.scope!=null?this.scope=u.scope&o.Scope.LEVEL|f:this.scope=o.Scope.ATTRIBUTE,u.whitelist!=null&&(this.whitelist=u.whitelist)}return g.keys=function(d){return[].map.call(d.attributes,function(v){return v.name})},g.prototype.add=function(d,v){return this.canAdd(d,v)?(d.setAttribute(this.keyName,v),!0):!1},g.prototype.canAdd=function(d,v){var u=o.query(d,o.Scope.BLOT&(this.scope|o.Scope.TYPE));return u==null?!1:this.whitelist==null?!0:typeof v=="string"?this.whitelist.indexOf(v.replace(/["']/g,""))>-1:this.whitelist.indexOf(v)>-1},g.prototype.remove=function(d){d.removeAttribute(this.keyName)},g.prototype.value=function(d){var v=d.getAttribute(this.keyName);return this.canAdd(d,v)&&v?v:""},g}();r.default=a},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Code=void 0;var o=function(){function O(P,j){var k=[],E=!0,C=!1,L=void 0;try{for(var M=P[Symbol.iterator](),z;!(E=(z=M.next()).done)&&(k.push(z.value),!(j&&k.length===j));E=!0);}catch(B){C=!0,L=B}finally{try{!E&&M.return&&M.return()}finally{if(C)throw L}}return k}return function(P,j){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return O(P,j);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function O(P,j){for(var k=0;k<j.length;k++){var E=j[k];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(P,E.key,E)}}return function(P,j,k){return j&&O(P.prototype,j),k&&O(P,k),P}}(),g=function O(P,j,k){P===null&&(P=Function.prototype);var E=Object.getOwnPropertyDescriptor(P,j);if(E===void 0){var C=Object.getPrototypeOf(P);return C===null?void 0:O(C,j,k)}else{if("value"in E)return E.value;var L=E.get;return L===void 0?void 0:L.call(k)}},d=i(2),v=m(d),u=i(0),f=m(u),l=i(4),c=m(l),_=i(6),y=m(_),b=i(7),h=m(b);function m(O){return O&&O.__esModule?O:{default:O}}function x(O,P){if(!(O instanceof P))throw new TypeError("Cannot call a class as a function")}function p(O,P){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:O}function w(O,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);O.prototype=Object.create(P&&P.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(O,P):O.__proto__=P)}var T=function(O){w(P,O);function P(){return x(this,P),p(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}return P}(y.default);T.blotName="code",T.tagName="CODE";var S=function(O){w(P,O);function P(){return x(this,P),p(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}return a(P,[{key:"delta",value:function(){var k=this,E=this.domNode.textContent;return E.endsWith(`
`)&&(E=E.slice(0,-1)),E.split(`
`).reduce(function(C,L){return C.insert(L).insert(`
`,k.formats())},new v.default)}},{key:"format",value:function(k,E){if(!(k===this.statics.blotName&&E)){var C=this.descendant(h.default,this.length()-1),L=o(C,1),M=L[0];M!=null&&M.deleteAt(M.length()-1,1),g(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"format",this).call(this,k,E)}}},{key:"formatAt",value:function(k,E,C,L){if(E!==0&&!(f.default.query(C,f.default.Scope.BLOCK)==null||C===this.statics.blotName&&L===this.statics.formats(this.domNode))){var M=this.newlineIndex(k);if(!(M<0||M>=k+E)){var z=this.newlineIndex(k,!0)+1,B=M-z+1,K=this.isolate(z,B),q=K.next;K.format(C,L),q instanceof P&&q.formatAt(0,k-z+E-B,C,L)}}}},{key:"insertAt",value:function(k,E,C){if(C==null){var L=this.descendant(h.default,k),M=o(L,2),z=M[0],B=M[1];z.insertAt(B,E)}}},{key:"length",value:function(){var k=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?k:k+1}},{key:"newlineIndex",value:function(k){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(E)return this.domNode.textContent.slice(0,k).lastIndexOf(`
`);var C=this.domNode.textContent.slice(k).indexOf(`
`);return C>-1?k+C:-1}},{key:"optimize",value:function(k){this.domNode.textContent.endsWith(`
`)||this.appendChild(f.default.create("text",`
`)),g(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"optimize",this).call(this,k);var E=this.next;E!=null&&E.prev===this&&E.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===E.statics.formats(E.domNode)&&(E.optimize(k),E.moveChildren(this),E.remove())}},{key:"replace",value:function(k){g(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"replace",this).call(this,k),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(E){var C=f.default.find(E);C==null?E.parentNode.removeChild(E):C instanceof f.default.Embed?C.remove():C.unwrap()})}}],[{key:"create",value:function(k){var E=g(P.__proto__||Object.getPrototypeOf(P),"create",this).call(this,k);return E.setAttribute("spellcheck",!1),E}},{key:"formats",value:function(){return!0}}]),P}(c.default);S.blotName="code-block",S.tagName="PRE",S.TAB="  ",r.Code=T,r.default=S},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},a=function(){function q(D,A){var N=[],I=!0,H=!1,U=void 0;try{for(var R=D[Symbol.iterator](),$;!(I=($=R.next()).done)&&(N.push($.value),!(A&&N.length===A));I=!0);}catch(G){H=!0,U=G}finally{try{!I&&R.return&&R.return()}finally{if(H)throw U}}return N}return function(D,A){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return q(D,A);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function q(D,A){for(var N=0;N<A.length;N++){var I=A[N];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(D,I.key,I)}}return function(D,A,N){return A&&q(D.prototype,A),N&&q(D,N),D}}(),d=i(2),v=E(d),u=i(20),f=E(u),l=i(0),c=E(l),_=i(13),y=E(_),b=i(24),h=E(b),m=i(4),x=E(m),p=i(16),w=E(p),T=i(21),S=E(T),O=i(11),P=E(O),j=i(3),k=E(j);function E(q){return q&&q.__esModule?q:{default:q}}function C(q,D,A){return D in q?Object.defineProperty(q,D,{value:A,enumerable:!0,configurable:!0,writable:!0}):q[D]=A,q}function L(q,D){if(!(q instanceof D))throw new TypeError("Cannot call a class as a function")}var M=/^[ -~]*$/,z=function(){function q(D){L(this,q),this.scroll=D,this.delta=this.getDelta()}return g(q,[{key:"applyDelta",value:function(A){var N=this,I=!1;this.scroll.update();var H=this.scroll.length();return this.scroll.batchStart(),A=K(A),A.reduce(function(U,R){var $=R.retain||R.delete||R.insert.length||1,G=R.attributes||{};if(R.insert!=null){if(typeof R.insert=="string"){var W=R.insert;W.endsWith(`
`)&&I&&(I=!1,W=W.slice(0,-1)),U>=H&&!W.endsWith(`
`)&&(I=!0),N.scroll.insertAt(U,W);var J=N.scroll.line(U),re=a(J,2),ce=re[0],ue=re[1],he=(0,k.default)({},(0,m.bubbleFormats)(ce));if(ce instanceof x.default){var xe=ce.descendant(c.default.Leaf,ue),Ne=a(xe,1),Ee=Ne[0];he=(0,k.default)(he,(0,m.bubbleFormats)(Ee))}G=f.default.attributes.diff(he,G)||{}}else if(o(R.insert)==="object"){var V=Object.keys(R.insert)[0];if(V==null)return U;N.scroll.insertAt(U,V,R.insert[V])}H+=$}return Object.keys(G).forEach(function(Y){N.scroll.formatAt(U,$,Y,G[Y])}),U+$},0),A.reduce(function(U,R){return typeof R.delete=="number"?(N.scroll.deleteAt(U,R.delete),U):U+(R.retain||R.insert.length||1)},0),this.scroll.batchEnd(),this.update(A)}},{key:"deleteText",value:function(A,N){return this.scroll.deleteAt(A,N),this.update(new v.default().retain(A).delete(N))}},{key:"formatLine",value:function(A,N){var I=this,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(H).forEach(function(U){if(!(I.scroll.whitelist!=null&&!I.scroll.whitelist[U])){var R=I.scroll.lines(A,Math.max(N,1)),$=N;R.forEach(function(G){var W=G.length();if(!(G instanceof y.default))G.format(U,H[U]);else{var J=A-G.offset(I.scroll),re=G.newlineIndex(J+$)-J+1;G.formatAt(J,re,U,H[U])}$-=W})}}),this.scroll.optimize(),this.update(new v.default().retain(A).retain(N,(0,S.default)(H)))}},{key:"formatText",value:function(A,N){var I=this,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(H).forEach(function(U){I.scroll.formatAt(A,N,U,H[U])}),this.update(new v.default().retain(A).retain(N,(0,S.default)(H)))}},{key:"getContents",value:function(A,N){return this.delta.slice(A,A+N)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(A,N){return A.concat(N.delta())},new v.default)}},{key:"getFormat",value:function(A){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,I=[],H=[];N===0?this.scroll.path(A).forEach(function(R){var $=a(R,1),G=$[0];G instanceof x.default?I.push(G):G instanceof c.default.Leaf&&H.push(G)}):(I=this.scroll.lines(A,N),H=this.scroll.descendants(c.default.Leaf,A,N));var U=[I,H].map(function(R){if(R.length===0)return{};for(var $=(0,m.bubbleFormats)(R.shift());Object.keys($).length>0;){var G=R.shift();if(G==null)return $;$=B((0,m.bubbleFormats)(G),$)}return $});return k.default.apply(k.default,U)}},{key:"getText",value:function(A,N){return this.getContents(A,N).filter(function(I){return typeof I.insert=="string"}).map(function(I){return I.insert}).join("")}},{key:"insertEmbed",value:function(A,N,I){return this.scroll.insertAt(A,N,I),this.update(new v.default().retain(A).insert(C({},N,I)))}},{key:"insertText",value:function(A,N){var I=this,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return N=N.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(A,N),Object.keys(H).forEach(function(U){I.scroll.formatAt(A,N.length,U,H[U])}),this.update(new v.default().retain(A).insert(N,(0,S.default)(H)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var A=this.scroll.children.head;return A.statics.blotName!==x.default.blotName||A.children.length>1?!1:A.children.head instanceof w.default}},{key:"removeFormat",value:function(A,N){var I=this.getText(A,N),H=this.scroll.line(A+N),U=a(H,2),R=U[0],$=U[1],G=0,W=new v.default;R!=null&&(R instanceof y.default?G=R.newlineIndex($)-$+1:G=R.length()-$,W=R.delta().slice($,$+G-1).insert(`
`));var J=this.getContents(A,N+G),re=J.diff(new v.default().insert(I).concat(W)),ce=new v.default().retain(A).concat(re);return this.applyDelta(ce)}},{key:"update",value:function(A){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,H=this.delta;if(N.length===1&&N[0].type==="characterData"&&N[0].target.data.match(M)&&c.default.find(N[0].target)){var U=c.default.find(N[0].target),R=(0,m.bubbleFormats)(U),$=U.offset(this.scroll),G=N[0].oldValue.replace(h.default.CONTENTS,""),W=new v.default().insert(G),J=new v.default().insert(U.value()),re=new v.default().retain($).concat(W.diff(J,I));A=re.reduce(function(ce,ue){return ue.insert?ce.insert(ue.insert,R):ce.push(ue)},new v.default),this.delta=H.compose(A)}else this.delta=this.getDelta(),(!A||!(0,P.default)(H.compose(A),this.delta))&&(A=H.diff(this.delta,I));return A}}]),q}();function B(q,D){return Object.keys(D).reduce(function(A,N){return q[N]==null||(D[N]===q[N]?A[N]=D[N]:Array.isArray(D[N])?D[N].indexOf(q[N])<0&&(A[N]=D[N].concat([q[N]])):A[N]=[D[N],q[N]]),A},{})}function K(q){return q.reduce(function(D,A){if(A.insert===1){var N=(0,S.default)(A.attributes);return delete N.image,D.insert({image:A.attributes.image},N)}if(A.attributes!=null&&(A.attributes.list===!0||A.attributes.bullet===!0)&&(A=(0,S.default)(A),A.attributes.list?A.attributes.list="ordered":(A.attributes.list="bullet",delete A.attributes.bullet)),typeof A.insert=="string"){var I=A.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return D.insert(I,A.attributes)}return D.push(A)},new v.default)}r.default=z},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Range=void 0;var o=function(){function O(P,j){var k=[],E=!0,C=!1,L=void 0;try{for(var M=P[Symbol.iterator](),z;!(E=(z=M.next()).done)&&(k.push(z.value),!(j&&k.length===j));E=!0);}catch(B){C=!0,L=B}finally{try{!E&&M.return&&M.return()}finally{if(C)throw L}}return k}return function(P,j){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return O(P,j);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function O(P,j){for(var k=0;k<j.length;k++){var E=j[k];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(P,E.key,E)}}return function(P,j,k){return j&&O(P.prototype,j),k&&O(P,k),P}}(),g=i(0),d=h(g),v=i(21),u=h(v),f=i(11),l=h(f),c=i(8),_=h(c),y=i(10),b=h(y);function h(O){return O&&O.__esModule?O:{default:O}}function m(O){if(Array.isArray(O)){for(var P=0,j=Array(O.length);P<O.length;P++)j[P]=O[P];return j}else return Array.from(O)}function x(O,P){if(!(O instanceof P))throw new TypeError("Cannot call a class as a function")}var p=(0,b.default)("quill:selection"),w=function O(P){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;x(this,O),this.index=P,this.length=j},T=function(){function O(P,j){var k=this;x(this,O),this.emitter=j,this.scroll=P,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=d.default.create("cursor",this),this.lastRange=this.savedRange=new w(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){k.mouseDown||setTimeout(k.update.bind(k,_.default.sources.USER),1)}),this.emitter.on(_.default.events.EDITOR_CHANGE,function(E,C){E===_.default.events.TEXT_CHANGE&&C.length()>0&&k.update(_.default.sources.SILENT)}),this.emitter.on(_.default.events.SCROLL_BEFORE_UPDATE,function(){if(k.hasFocus()){var E=k.getNativeRange();E!=null&&E.start.node!==k.cursor.textNode&&k.emitter.once(_.default.events.SCROLL_UPDATE,function(){try{k.setNativeRange(E.start.node,E.start.offset,E.end.node,E.end.offset)}catch{}})}}),this.emitter.on(_.default.events.SCROLL_OPTIMIZE,function(E,C){if(C.range){var L=C.range,M=L.startNode,z=L.startOffset,B=L.endNode,K=L.endOffset;k.setNativeRange(M,z,B,K)}}),this.update(_.default.sources.SILENT)}return a(O,[{key:"handleComposition",value:function(){var j=this;this.root.addEventListener("compositionstart",function(){j.composing=!0}),this.root.addEventListener("compositionend",function(){if(j.composing=!1,j.cursor.parent){var k=j.cursor.restore();if(!k)return;setTimeout(function(){j.setNativeRange(k.startNode,k.startOffset,k.endNode,k.endOffset)},1)}})}},{key:"handleDragging",value:function(){var j=this;this.emitter.listenDOM("mousedown",document.body,function(){j.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){j.mouseDown=!1,j.update(_.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(j,k){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[j])){this.scroll.update();var E=this.getNativeRange();if(!(E==null||!E.native.collapsed||d.default.query(j,d.default.Scope.BLOCK))){if(E.start.node!==this.cursor.textNode){var C=d.default.find(E.start.node,!1);if(C==null)return;if(C instanceof d.default.Leaf){var L=C.split(E.start.offset);C.parent.insertBefore(this.cursor,L)}else C.insertBefore(this.cursor,E.start.node);this.cursor.attach()}this.cursor.format(j,k),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(j){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=this.scroll.length();j=Math.min(j,E-1),k=Math.min(j+k,E-1)-j;var C=void 0,L=this.scroll.leaf(j),M=o(L,2),z=M[0],B=M[1];if(z==null)return null;var K=z.position(B,!0),q=o(K,2);C=q[0],B=q[1];var D=document.createRange();if(k>0){D.setStart(C,B);var A=this.scroll.leaf(j+k),N=o(A,2);if(z=N[0],B=N[1],z==null)return null;var I=z.position(B,!0),H=o(I,2);return C=H[0],B=H[1],D.setEnd(C,B),D.getBoundingClientRect()}else{var U="left",R=void 0;return C instanceof Text?(B<C.data.length?(D.setStart(C,B),D.setEnd(C,B+1)):(D.setStart(C,B-1),D.setEnd(C,B),U="right"),R=D.getBoundingClientRect()):(R=z.domNode.getBoundingClientRect(),B>0&&(U="right")),{bottom:R.top+R.height,height:R.height,left:R[U],right:R[U],top:R.top,width:0}}}},{key:"getNativeRange",value:function(){var j=document.getSelection();if(j==null||j.rangeCount<=0)return null;var k=j.getRangeAt(0);if(k==null)return null;var E=this.normalizeNative(k);return p.info("getNativeRange",E),E}},{key:"getRange",value:function(){var j=this.getNativeRange();if(j==null)return[null,null];var k=this.normalizedToRange(j);return[k,j]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(j){var k=this,E=[[j.start.node,j.start.offset]];j.native.collapsed||E.push([j.end.node,j.end.offset]);var C=E.map(function(z){var B=o(z,2),K=B[0],q=B[1],D=d.default.find(K,!0),A=D.offset(k.scroll);return q===0?A:D instanceof d.default.Container?A+D.length():A+D.index(K,q)}),L=Math.min(Math.max.apply(Math,m(C)),this.scroll.length()-1),M=Math.min.apply(Math,[L].concat(m(C)));return new w(M,L-M)}},{key:"normalizeNative",value:function(j){if(!S(this.root,j.startContainer)||!j.collapsed&&!S(this.root,j.endContainer))return null;var k={start:{node:j.startContainer,offset:j.startOffset},end:{node:j.endContainer,offset:j.endOffset},native:j};return[k.start,k.end].forEach(function(E){for(var C=E.node,L=E.offset;!(C instanceof Text)&&C.childNodes.length>0;)if(C.childNodes.length>L)C=C.childNodes[L],L=0;else if(C.childNodes.length===L)C=C.lastChild,L=C instanceof Text?C.data.length:C.childNodes.length+1;else break;E.node=C,E.offset=L}),k}},{key:"rangeToNative",value:function(j){var k=this,E=j.collapsed?[j.index]:[j.index,j.index+j.length],C=[],L=this.scroll.length();return E.forEach(function(M,z){M=Math.min(L-1,M);var B=void 0,K=k.scroll.leaf(M),q=o(K,2),D=q[0],A=q[1],N=D.position(A,z!==0),I=o(N,2);B=I[0],A=I[1],C.push(B,A)}),C.length<2&&(C=C.concat(C)),C}},{key:"scrollIntoView",value:function(j){var k=this.lastRange;if(k!=null){var E=this.getBounds(k.index,k.length);if(E!=null){var C=this.scroll.length()-1,L=this.scroll.line(Math.min(k.index,C)),M=o(L,1),z=M[0],B=z;if(k.length>0){var K=this.scroll.line(Math.min(k.index+k.length,C)),q=o(K,1);B=q[0]}if(!(z==null||B==null)){var D=j.getBoundingClientRect();E.top<D.top?j.scrollTop-=D.top-E.top:E.bottom>D.bottom&&(j.scrollTop+=E.bottom-D.bottom)}}}}},{key:"setNativeRange",value:function(j,k){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:j,C=arguments.length>3&&arguments[3]!==void 0?arguments[3]:k,L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(p.info("setNativeRange",j,k,E,C),!(j!=null&&(this.root.parentNode==null||j.parentNode==null||E.parentNode==null))){var M=document.getSelection();if(M!=null)if(j!=null){this.hasFocus()||this.root.focus();var z=(this.getNativeRange()||{}).native;if(z==null||L||j!==z.startContainer||k!==z.startOffset||E!==z.endContainer||C!==z.endOffset){j.tagName=="BR"&&(k=[].indexOf.call(j.parentNode.childNodes,j),j=j.parentNode),E.tagName=="BR"&&(C=[].indexOf.call(E.parentNode.childNodes,E),E=E.parentNode);var B=document.createRange();B.setStart(j,k),B.setEnd(E,C),M.removeAllRanges(),M.addRange(B)}}else M.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(j){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.default.sources.API;if(typeof k=="string"&&(E=k,k=!1),p.info("setRange",j),j!=null){var C=this.rangeToNative(j);this.setNativeRange.apply(this,m(C).concat([k]))}else this.setNativeRange(null);this.update(E)}},{key:"update",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.default.sources.USER,k=this.lastRange,E=this.getRange(),C=o(E,2),L=C[0],M=C[1];if(this.lastRange=L,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,l.default)(k,this.lastRange)){var z;!this.composing&&M!=null&&M.native.collapsed&&M.start.node!==this.cursor.textNode&&this.cursor.restore();var B=[_.default.events.SELECTION_CHANGE,(0,u.default)(this.lastRange),(0,u.default)(k),j];if((z=this.emitter).emit.apply(z,[_.default.events.EDITOR_CHANGE].concat(B)),j!==_.default.sources.SILENT){var K;(K=this.emitter).emit.apply(K,B)}}}}]),O}();function S(O,P){try{P.parentNode}catch{return!1}return P instanceof Text&&(P=P.parentNode),O.contains(P)}r.Range=w,r.default=T},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function _(y,b){for(var h=0;h<b.length;h++){var m=b[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(y,m.key,m)}}return function(y,b,h){return b&&_(y.prototype,b),h&&_(y,h),y}}(),a=function _(y,b,h){y===null&&(y=Function.prototype);var m=Object.getOwnPropertyDescriptor(y,b);if(m===void 0){var x=Object.getPrototypeOf(y);return x===null?void 0:_(x,b,h)}else{if("value"in m)return m.value;var p=m.get;return p===void 0?void 0:p.call(h)}},g=i(0),d=v(g);function v(_){return _&&_.__esModule?_:{default:_}}function u(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function f(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function l(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var c=function(_){l(y,_);function y(){return u(this,y),f(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return o(y,[{key:"insertInto",value:function(h,m){h.children.length===0?a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"insertInto",this).call(this,h,m):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),y}(d.default.Embed);c.blotName="break",c.tagName="BR",r.default=c},function(t,r,i){var o=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,c){l.__proto__=c}||function(l,c){for(var _ in c)c.hasOwnProperty(_)&&(l[_]=c[_])};return function(l,c){f(l,c);function _(){this.constructor=l}l.prototype=c===null?Object.create(c):(_.prototype=c.prototype,new _)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(44),g=i(30),d=i(1),v=function(f){o(l,f);function l(c){var _=f.call(this,c)||this;return _.build(),_}return l.prototype.appendChild=function(c){this.insertBefore(c)},l.prototype.attach=function(){f.prototype.attach.call(this),this.children.forEach(function(c){c.attach()})},l.prototype.build=function(){var c=this;this.children=new a.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(_){try{var y=u(_);c.insertBefore(y,c.children.head||void 0)}catch(b){if(b instanceof d.ParchmentError)return;throw b}})},l.prototype.deleteAt=function(c,_){if(c===0&&_===this.length())return this.remove();this.children.forEachAt(c,_,function(y,b,h){y.deleteAt(b,h)})},l.prototype.descendant=function(c,_){var y=this.children.find(_),b=y[0],h=y[1];return c.blotName==null&&c(b)||c.blotName!=null&&b instanceof c?[b,h]:b instanceof l?b.descendant(c,h):[null,-1]},l.prototype.descendants=function(c,_,y){_===void 0&&(_=0),y===void 0&&(y=Number.MAX_VALUE);var b=[],h=y;return this.children.forEachAt(_,y,function(m,x,p){(c.blotName==null&&c(m)||c.blotName!=null&&m instanceof c)&&b.push(m),m instanceof l&&(b=b.concat(m.descendants(c,x,h))),h-=p}),b},l.prototype.detach=function(){this.children.forEach(function(c){c.detach()}),f.prototype.detach.call(this)},l.prototype.formatAt=function(c,_,y,b){this.children.forEachAt(c,_,function(h,m,x){h.formatAt(m,x,y,b)})},l.prototype.insertAt=function(c,_,y){var b=this.children.find(c),h=b[0],m=b[1];if(h)h.insertAt(m,_,y);else{var x=y==null?d.create("text",_):d.create(_,y);this.appendChild(x)}},l.prototype.insertBefore=function(c,_){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(y){return c instanceof y}))throw new d.ParchmentError("Cannot insert "+c.statics.blotName+" into "+this.statics.blotName);c.insertInto(this,_)},l.prototype.length=function(){return this.children.reduce(function(c,_){return c+_.length()},0)},l.prototype.moveChildren=function(c,_){this.children.forEach(function(y){c.insertBefore(y,_)})},l.prototype.optimize=function(c){if(f.prototype.optimize.call(this,c),this.children.length===0)if(this.statics.defaultChild!=null){var _=d.create(this.statics.defaultChild);this.appendChild(_),_.optimize(c)}else this.remove()},l.prototype.path=function(c,_){_===void 0&&(_=!1);var y=this.children.find(c,_),b=y[0],h=y[1],m=[[this,c]];return b instanceof l?m.concat(b.path(h,_)):(b!=null&&m.push([b,h]),m)},l.prototype.removeChild=function(c){this.children.remove(c)},l.prototype.replace=function(c){c instanceof l&&c.moveChildren(this),f.prototype.replace.call(this,c)},l.prototype.split=function(c,_){if(_===void 0&&(_=!1),!_){if(c===0)return this;if(c===this.length())return this.next}var y=this.clone();return this.parent.insertBefore(y,this.next),this.children.forEachAt(c,this.length(),function(b,h,m){b=b.split(h,_),y.appendChild(b)}),y},l.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},l.prototype.update=function(c,_){var y=this,b=[],h=[];c.forEach(function(m){m.target===y.domNode&&m.type==="childList"&&(b.push.apply(b,m.addedNodes),h.push.apply(h,m.removedNodes))}),h.forEach(function(m){if(!(m.parentNode!=null&&m.tagName!=="IFRAME"&&document.body.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var x=d.find(m);x!=null&&(x.domNode.parentNode==null||x.domNode.parentNode===y.domNode)&&x.detach()}}),b.filter(function(m){return m.parentNode==y.domNode}).sort(function(m,x){return m===x?0:m.compareDocumentPosition(x)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(m){var x=null;m.nextSibling!=null&&(x=d.find(m.nextSibling));var p=u(m);(p.next!=x||p.next==null)&&(p.parent!=null&&p.parent.removeChild(y),y.insertBefore(p,x||void 0))})},l}(g.default);function u(f){var l=d.find(f);if(l==null)try{l=d.create(f)}catch{l=d.create(d.Scope.INLINE),[].slice.call(f.childNodes).forEach(function(_){l.domNode.appendChild(_)}),f.parentNode&&f.parentNode.replaceChild(l.domNode,f),l.attach()}return l}r.default=v},function(t,r,i){var o=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,c){l.__proto__=c}||function(l,c){for(var _ in c)c.hasOwnProperty(_)&&(l[_]=c[_])};return function(l,c){f(l,c);function _(){this.constructor=l}l.prototype=c===null?Object.create(c):(_.prototype=c.prototype,new _)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(12),g=i(31),d=i(17),v=i(1),u=function(f){o(l,f);function l(c){var _=f.call(this,c)||this;return _.attributes=new g.default(_.domNode),_}return l.formats=function(c){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return c.tagName.toLowerCase()},l.prototype.format=function(c,_){var y=v.query(c);y instanceof a.default?this.attributes.attribute(y,_):_&&y!=null&&(c!==this.statics.blotName||this.formats()[c]!==_)&&this.replaceWith(c,_)},l.prototype.formats=function(){var c=this.attributes.values(),_=this.statics.formats(this.domNode);return _!=null&&(c[this.statics.blotName]=_),c},l.prototype.replaceWith=function(c,_){var y=f.prototype.replaceWith.call(this,c,_);return this.attributes.copy(y),y},l.prototype.update=function(c,_){var y=this;f.prototype.update.call(this,c,_),c.some(function(b){return b.target===y.domNode&&b.type==="attributes"})&&this.attributes.build()},l.prototype.wrap=function(c,_){var y=f.prototype.wrap.call(this,c,_);return y instanceof l&&y.statics.scope===this.statics.scope&&this.attributes.move(y),y},l}(d.default);r.default=u},function(t,r,i){var o=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var l in f)f.hasOwnProperty(l)&&(u[l]=f[l])};return function(u,f){v(u,f);function l(){this.constructor=u}u.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(30),g=i(1),d=function(v){o(u,v);function u(){return v!==null&&v.apply(this,arguments)||this}return u.value=function(f){return!0},u.prototype.index=function(f,l){return this.domNode===f||this.domNode.compareDocumentPosition(f)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(l,1):-1},u.prototype.position=function(f,l){var c=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return f>0&&(c+=1),[this.parent.domNode,c]},u.prototype.value=function(){var f;return f={},f[this.statics.blotName]=this.statics.value(this.domNode)||!0,f},u.scope=g.Scope.INLINE_BLOT,u}(a.default);r.default=d},function(t,r,i){var o=i(11),a=i(3),g={attributes:{compose:function(v,u,f){typeof v!="object"&&(v={}),typeof u!="object"&&(u={});var l=a(!0,{},u);f||(l=Object.keys(l).reduce(function(_,y){return l[y]!=null&&(_[y]=l[y]),_},{}));for(var c in v)v[c]!==void 0&&u[c]===void 0&&(l[c]=v[c]);return Object.keys(l).length>0?l:void 0},diff:function(v,u){typeof v!="object"&&(v={}),typeof u!="object"&&(u={});var f=Object.keys(v).concat(Object.keys(u)).reduce(function(l,c){return o(v[c],u[c])||(l[c]=u[c]===void 0?null:u[c]),l},{});return Object.keys(f).length>0?f:void 0},transform:function(v,u,f){if(typeof v!="object")return u;if(typeof u=="object"){if(!f)return u;var l=Object.keys(u).reduce(function(c,_){return v[_]===void 0&&(c[_]=u[_]),c},{});return Object.keys(l).length>0?l:void 0}}},iterator:function(v){return new d(v)},length:function(v){return typeof v.delete=="number"?v.delete:typeof v.retain=="number"?v.retain:typeof v.insert=="string"?v.insert.length:1}};function d(v){this.ops=v,this.index=0,this.offset=0}d.prototype.hasNext=function(){return this.peekLength()<1/0},d.prototype.next=function(v){v||(v=1/0);var u=this.ops[this.index];if(u){var f=this.offset,l=g.length(u);if(v>=l-f?(v=l-f,this.index+=1,this.offset=0):this.offset+=v,typeof u.delete=="number")return{delete:v};var c={};return u.attributes&&(c.attributes=u.attributes),typeof u.retain=="number"?c.retain=v:typeof u.insert=="string"?c.insert=u.insert.substr(f,v):c.insert=u.insert,c}else return{retain:1/0}},d.prototype.peek=function(){return this.ops[this.index]},d.prototype.peekLength=function(){return this.ops[this.index]?g.length(this.ops[this.index])-this.offset:1/0},d.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},d.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var v=this.offset,u=this.index,f=this.next(),l=this.ops.slice(this.index);return this.offset=v,this.index=u,[f].concat(l)}else return[]},t.exports=g},function(t,r){var i=function(){function o(y,b){return b!=null&&y instanceof b}var a;try{a=Map}catch{a=function(){}}var g;try{g=Set}catch{g=function(){}}var d;try{d=Promise}catch{d=function(){}}function v(y,b,h,m,x){typeof b=="object"&&(h=b.depth,m=b.prototype,x=b.includeNonEnumerable,b=b.circular);var p=[],w=[],T=typeof Buffer<"u";typeof b>"u"&&(b=!0),typeof h>"u"&&(h=1/0);function S(O,P){if(O===null)return null;if(P===0)return O;var j,k;if(typeof O!="object")return O;if(o(O,a))j=new a;else if(o(O,g))j=new g;else if(o(O,d))j=new d(function(D,A){O.then(function(N){D(S(N,P-1))},function(N){A(S(N,P-1))})});else if(v.__isArray(O))j=[];else if(v.__isRegExp(O))j=new RegExp(O.source,_(O)),O.lastIndex&&(j.lastIndex=O.lastIndex);else if(v.__isDate(O))j=new Date(O.getTime());else{if(T&&Buffer.isBuffer(O))return Buffer.allocUnsafe?j=Buffer.allocUnsafe(O.length):j=new Buffer(O.length),O.copy(j),j;o(O,Error)?j=Object.create(O):typeof m>"u"?(k=Object.getPrototypeOf(O),j=Object.create(k)):(j=Object.create(m),k=m)}if(b){var E=p.indexOf(O);if(E!=-1)return w[E];p.push(O),w.push(j)}o(O,a)&&O.forEach(function(D,A){var N=S(A,P-1),I=S(D,P-1);j.set(N,I)}),o(O,g)&&O.forEach(function(D){var A=S(D,P-1);j.add(A)});for(var C in O){var L;k&&(L=Object.getOwnPropertyDescriptor(k,C)),!(L&&L.set==null)&&(j[C]=S(O[C],P-1))}if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(O),C=0;C<M.length;C++){var z=M[C],B=Object.getOwnPropertyDescriptor(O,z);B&&!B.enumerable&&!x||(j[z]=S(O[z],P-1),B.enumerable||Object.defineProperty(j,z,{enumerable:!1}))}if(x)for(var K=Object.getOwnPropertyNames(O),C=0;C<K.length;C++){var q=K[C],B=Object.getOwnPropertyDescriptor(O,q);B&&B.enumerable||(j[q]=S(O[q],P-1),Object.defineProperty(j,q,{enumerable:!1}))}return j}return S(y,h)}v.clonePrototype=function(b){if(b===null)return null;var h=function(){};return h.prototype=b,new h};function u(y){return Object.prototype.toString.call(y)}v.__objToStr=u;function f(y){return typeof y=="object"&&u(y)==="[object Date]"}v.__isDate=f;function l(y){return typeof y=="object"&&u(y)==="[object Array]"}v.__isArray=l;function c(y){return typeof y=="object"&&u(y)==="[object RegExp]"}v.__isRegExp=c;function _(y){var b="";return y.global&&(b+="g"),y.ignoreCase&&(b+="i"),y.multiline&&(b+="m"),b}return v.__getRegExpFlags=_,v}();typeof t=="object"&&t.exports&&(t.exports=i)},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function j(k,E){var C=[],L=!0,M=!1,z=void 0;try{for(var B=k[Symbol.iterator](),K;!(L=(K=B.next()).done)&&(C.push(K.value),!(E&&C.length===E));L=!0);}catch(q){M=!0,z=q}finally{try{!L&&B.return&&B.return()}finally{if(M)throw z}}return C}return function(k,E){if(Array.isArray(k))return k;if(Symbol.iterator in Object(k))return j(k,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function j(k,E){for(var C=0;C<E.length;C++){var L=E[C];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(k,L.key,L)}}return function(k,E,C){return E&&j(k.prototype,E),C&&j(k,C),k}}(),g=function j(k,E,C){k===null&&(k=Function.prototype);var L=Object.getOwnPropertyDescriptor(k,E);if(L===void 0){var M=Object.getPrototypeOf(k);return M===null?void 0:j(M,E,C)}else{if("value"in L)return L.value;var z=L.get;return z===void 0?void 0:z.call(C)}},d=i(0),v=p(d),u=i(8),f=p(u),l=i(4),c=p(l),_=i(16),y=p(_),b=i(13),h=p(b),m=i(25),x=p(m);function p(j){return j&&j.__esModule?j:{default:j}}function w(j,k){if(!(j instanceof k))throw new TypeError("Cannot call a class as a function")}function T(j,k){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:j}function S(j,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);j.prototype=Object.create(k&&k.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(j,k):j.__proto__=k)}function O(j){return j instanceof c.default||j instanceof l.BlockEmbed}var P=function(j){S(k,j);function k(E,C){w(this,k);var L=T(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,E));return L.emitter=C.emitter,Array.isArray(C.whitelist)&&(L.whitelist=C.whitelist.reduce(function(M,z){return M[z]=!0,M},{})),L.domNode.addEventListener("DOMNodeInserted",function(){}),L.optimize(),L.enable(),L}return a(k,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(C,L){var M=this.line(C),z=o(M,2),B=z[0],K=z[1],q=this.line(C+L),D=o(q,1),A=D[0];if(g(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"deleteAt",this).call(this,C,L),A!=null&&B!==A&&K>0){if(B instanceof l.BlockEmbed||A instanceof l.BlockEmbed){this.optimize();return}if(B instanceof h.default){var N=B.newlineIndex(B.length(),!0);if(N>-1&&(B=B.split(N+1),B===A)){this.optimize();return}}else if(A instanceof h.default){var I=A.newlineIndex(0);I>-1&&A.split(I+1)}var H=A.children.head instanceof y.default?null:A.children.head;B.moveChildren(A,H),B.remove()}this.optimize()}},{key:"enable",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",C)}},{key:"formatAt",value:function(C,L,M,z){this.whitelist!=null&&!this.whitelist[M]||(g(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"formatAt",this).call(this,C,L,M,z),this.optimize())}},{key:"insertAt",value:function(C,L,M){if(!(M!=null&&this.whitelist!=null&&!this.whitelist[L])){if(C>=this.length())if(M==null||v.default.query(L,v.default.Scope.BLOCK)==null){var z=v.default.create(this.statics.defaultChild);this.appendChild(z),M==null&&L.endsWith(`
`)&&(L=L.slice(0,-1)),z.insertAt(0,L,M)}else{var B=v.default.create(L,M);this.appendChild(B)}else g(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"insertAt",this).call(this,C,L,M);this.optimize()}}},{key:"insertBefore",value:function(C,L){if(C.statics.scope===v.default.Scope.INLINE_BLOT){var M=v.default.create(this.statics.defaultChild);M.appendChild(C),C=M}g(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"insertBefore",this).call(this,C,L)}},{key:"leaf",value:function(C){return this.path(C).pop()||[null,-1]}},{key:"line",value:function(C){return C===this.length()?this.line(C-1):this.descendant(O,C)}},{key:"lines",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,M=function z(B,K,q){var D=[],A=q;return B.children.forEachAt(K,q,function(N,I,H){O(N)?D.push(N):N instanceof v.default.Container&&(D=D.concat(z(N,I,A))),A-=H}),D};return M(this,C,L)}},{key:"optimize",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(g(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"optimize",this).call(this,C,L),C.length>0&&this.emitter.emit(f.default.events.SCROLL_OPTIMIZE,C,L))}},{key:"path",value:function(C){return g(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"path",this).call(this,C).slice(1)}},{key:"update",value:function(C){if(this.batch!==!0){var L=f.default.sources.USER;typeof C=="string"&&(L=C),Array.isArray(C)||(C=this.observer.takeRecords()),C.length>0&&this.emitter.emit(f.default.events.SCROLL_BEFORE_UPDATE,L,C),g(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"update",this).call(this,C.concat([])),C.length>0&&this.emitter.emit(f.default.events.SCROLL_UPDATE,L,C)}}}]),k}(v.default.Scroll);P.blotName="scroll",P.className="ql-editor",P.tagName="DIV",P.defaultChild="block",P.allowedChildren=[c.default,l.BlockEmbed,x.default],r.default=P},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SHORTKEY=r.default=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},a=function(){function R($,G){var W=[],J=!0,re=!1,ce=void 0;try{for(var ue=$[Symbol.iterator](),he;!(J=(he=ue.next()).done)&&(W.push(he.value),!(G&&W.length===G));J=!0);}catch(xe){re=!0,ce=xe}finally{try{!J&&ue.return&&ue.return()}finally{if(re)throw ce}}return W}return function($,G){if(Array.isArray($))return $;if(Symbol.iterator in Object($))return R($,G);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function R($,G){for(var W=0;W<G.length;W++){var J=G[W];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty($,J.key,J)}}return function($,G,W){return G&&R($.prototype,G),W&&R($,W),$}}(),d=i(21),v=j(d),u=i(11),f=j(u),l=i(3),c=j(l),_=i(2),y=j(_),b=i(20),h=j(b),m=i(0),x=j(m),p=i(5),w=j(p),T=i(10),S=j(T),O=i(9),P=j(O);function j(R){return R&&R.__esModule?R:{default:R}}function k(R,$,G){return $ in R?Object.defineProperty(R,$,{value:G,enumerable:!0,configurable:!0,writable:!0}):R[$]=G,R}function E(R,$){if(!(R instanceof $))throw new TypeError("Cannot call a class as a function")}function C(R,$){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $&&(typeof $=="object"||typeof $=="function")?$:R}function L(R,$){if(typeof $!="function"&&$!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof $);R.prototype=Object.create($&&$.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),$&&(Object.setPrototypeOf?Object.setPrototypeOf(R,$):R.__proto__=$)}var M=(0,S.default)("quill:keyboard"),z=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",B=function(R){L($,R),g($,null,[{key:"match",value:function(W,J){return J=U(J),["altKey","ctrlKey","metaKey","shiftKey"].some(function(re){return!!J[re]!==W[re]&&J[re]!==null})?!1:J.key===(W.which||W.keyCode)}}]);function $(G,W){E(this,$);var J=C(this,($.__proto__||Object.getPrototypeOf($)).call(this,G,W));return J.bindings={},Object.keys(J.options.bindings).forEach(function(re){re==="list autofill"&&G.scroll.whitelist!=null&&!G.scroll.whitelist.list||J.options.bindings[re]&&J.addBinding(J.options.bindings[re])}),J.addBinding({key:$.keys.ENTER,shiftKey:null},N),J.addBinding({key:$.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(J.addBinding({key:$.keys.BACKSPACE},{collapsed:!0},q),J.addBinding({key:$.keys.DELETE},{collapsed:!0},D)):(J.addBinding({key:$.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},q),J.addBinding({key:$.keys.DELETE},{collapsed:!0,suffix:/^.?$/},D)),J.addBinding({key:$.keys.BACKSPACE},{collapsed:!1},A),J.addBinding({key:$.keys.DELETE},{collapsed:!1},A),J.addBinding({key:$.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},q),J.listen(),J}return g($,[{key:"addBinding",value:function(W){var J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ce=U(W);if(ce==null||ce.key==null)return M.warn("Attempted to add invalid keyboard binding",ce);typeof J=="function"&&(J={handler:J}),typeof re=="function"&&(re={handler:re}),ce=(0,c.default)(ce,J,re),this.bindings[ce.key]=this.bindings[ce.key]||[],this.bindings[ce.key].push(ce)}},{key:"listen",value:function(){var W=this;this.quill.root.addEventListener("keydown",function(J){if(!J.defaultPrevented){var re=J.which||J.keyCode,ce=(W.bindings[re]||[]).filter(function(Ce){return $.match(J,Ce)});if(ce.length!==0){var ue=W.quill.getSelection();if(!(ue==null||!W.quill.hasFocus())){var he=W.quill.getLine(ue.index),xe=a(he,2),Ne=xe[0],Ee=xe[1],V=W.quill.getLeaf(ue.index),Y=a(V,2),ee=Y[0],te=Y[1],Z=ue.length===0?[ee,te]:W.quill.getLeaf(ue.index+ue.length),pe=a(Z,2),fe=pe[0],de=pe[1],Re=ee instanceof x.default.Text?ee.value().slice(0,te):"",et=fe instanceof x.default.Text?fe.value().slice(de):"",Oe={collapsed:ue.length===0,empty:ue.length===0&&Ne.length()<=1,format:W.quill.getFormat(ue),offset:Ee,prefix:Re,suffix:et},Dr=ce.some(function(Ce){if(Ce.collapsed!=null&&Ce.collapsed!==Oe.collapsed||Ce.empty!=null&&Ce.empty!==Oe.empty||Ce.offset!=null&&Ce.offset!==Oe.offset)return!1;if(Array.isArray(Ce.format)){if(Ce.format.every(function(it){return Oe.format[it]==null}))return!1}else if(o(Ce.format)==="object"&&!Object.keys(Ce.format).every(function(it){return Ce.format[it]===!0?Oe.format[it]!=null:Ce.format[it]===!1?Oe.format[it]==null:(0,f.default)(Ce.format[it],Oe.format[it])}))return!1;return Ce.prefix!=null&&!Ce.prefix.test(Oe.prefix)||Ce.suffix!=null&&!Ce.suffix.test(Oe.suffix)?!1:Ce.handler.call(W,ue,Oe)!==!0});Dr&&J.preventDefault()}}}})}}]),$}(P.default);B.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},B.DEFAULTS={bindings:{bold:H("bold"),italic:H("italic"),underline:H("underline"),indent:{key:B.keys.TAB,format:["blockquote","indent","list"],handler:function($,G){if(G.collapsed&&G.offset!==0)return!0;this.quill.format("indent","+1",w.default.sources.USER)}},outdent:{key:B.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function($,G){if(G.collapsed&&G.offset!==0)return!0;this.quill.format("indent","-1",w.default.sources.USER)}},"outdent backspace":{key:B.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function($,G){G.format.indent!=null?this.quill.format("indent","-1",w.default.sources.USER):G.format.list!=null&&this.quill.format("list",!1,w.default.sources.USER)}},"indent code-block":I(!0),"outdent code-block":I(!1),"remove tab":{key:B.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function($){this.quill.deleteText($.index-1,1,w.default.sources.USER)}},tab:{key:B.keys.TAB,handler:function($){this.quill.history.cutoff();var G=new y.default().retain($.index).delete($.length).insert("	");this.quill.updateContents(G,w.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection($.index+1,w.default.sources.SILENT)}},"list empty enter":{key:B.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function($,G){this.quill.format("list",!1,w.default.sources.USER),G.format.indent&&this.quill.format("indent",!1,w.default.sources.USER)}},"checklist enter":{key:B.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function($){var G=this.quill.getLine($.index),W=a(G,2),J=W[0],re=W[1],ce=(0,c.default)({},J.formats(),{list:"checked"}),ue=new y.default().retain($.index).insert(`
`,ce).retain(J.length()-re-1).retain(1,{list:"unchecked"});this.quill.updateContents(ue,w.default.sources.USER),this.quill.setSelection($.index+1,w.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:B.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function($,G){var W=this.quill.getLine($.index),J=a(W,2),re=J[0],ce=J[1],ue=new y.default().retain($.index).insert(`
`,G.format).retain(re.length()-ce-1).retain(1,{header:null});this.quill.updateContents(ue,w.default.sources.USER),this.quill.setSelection($.index+1,w.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function($,G){var W=G.prefix.length,J=this.quill.getLine($.index),re=a(J,2),ce=re[0],ue=re[1];if(ue>W)return!0;var he=void 0;switch(G.prefix.trim()){case"[]":case"[ ]":he="unchecked";break;case"[x]":he="checked";break;case"-":case"*":he="bullet";break;default:he="ordered"}this.quill.insertText($.index," ",w.default.sources.USER),this.quill.history.cutoff();var xe=new y.default().retain($.index-ue).delete(W+1).retain(ce.length()-2-ue).retain(1,{list:he});this.quill.updateContents(xe,w.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection($.index-W,w.default.sources.SILENT)}},"code exit":{key:B.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function($){var G=this.quill.getLine($.index),W=a(G,2),J=W[0],re=W[1],ce=new y.default().retain($.index+J.length()-re-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(ce,w.default.sources.USER)}},"embed left":K(B.keys.LEFT,!1),"embed left shift":K(B.keys.LEFT,!0),"embed right":K(B.keys.RIGHT,!1),"embed right shift":K(B.keys.RIGHT,!0)}};function K(R,$){var G,W=R===B.keys.LEFT?"prefix":"suffix";return G={key:R,shiftKey:$,altKey:null},k(G,W,/^$/),k(G,"handler",function(re){var ce=re.index;R===B.keys.RIGHT&&(ce+=re.length+1);var ue=this.quill.getLeaf(ce),he=a(ue,1),xe=he[0];return xe instanceof x.default.Embed?(R===B.keys.LEFT?$?this.quill.setSelection(re.index-1,re.length+1,w.default.sources.USER):this.quill.setSelection(re.index-1,w.default.sources.USER):$?this.quill.setSelection(re.index,re.length+1,w.default.sources.USER):this.quill.setSelection(re.index+re.length+1,w.default.sources.USER),!1):!0}),G}function q(R,$){if(!(R.index===0||this.quill.getLength()<=1)){var G=this.quill.getLine(R.index),W=a(G,1),J=W[0],re={};if($.offset===0){var ce=this.quill.getLine(R.index-1),ue=a(ce,1),he=ue[0];if(he!=null&&he.length()>1){var xe=J.formats(),Ne=this.quill.getFormat(R.index-1,1);re=h.default.attributes.diff(xe,Ne)||{}}}var Ee=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test($.prefix)?2:1;this.quill.deleteText(R.index-Ee,Ee,w.default.sources.USER),Object.keys(re).length>0&&this.quill.formatLine(R.index-Ee,Ee,re,w.default.sources.USER),this.quill.focus()}}function D(R,$){var G=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test($.suffix)?2:1;if(!(R.index>=this.quill.getLength()-G)){var W={},J=0,re=this.quill.getLine(R.index),ce=a(re,1),ue=ce[0];if($.offset>=ue.length()-1){var he=this.quill.getLine(R.index+1),xe=a(he,1),Ne=xe[0];if(Ne){var Ee=ue.formats(),V=this.quill.getFormat(R.index,1);W=h.default.attributes.diff(Ee,V)||{},J=Ne.length()}}this.quill.deleteText(R.index,G,w.default.sources.USER),Object.keys(W).length>0&&this.quill.formatLine(R.index+J-1,G,W,w.default.sources.USER)}}function A(R){var $=this.quill.getLines(R),G={};if($.length>1){var W=$[0].formats(),J=$[$.length-1].formats();G=h.default.attributes.diff(J,W)||{}}this.quill.deleteText(R,w.default.sources.USER),Object.keys(G).length>0&&this.quill.formatLine(R.index,1,G,w.default.sources.USER),this.quill.setSelection(R.index,w.default.sources.SILENT),this.quill.focus()}function N(R,$){var G=this;R.length>0&&this.quill.scroll.deleteAt(R.index,R.length);var W=Object.keys($.format).reduce(function(J,re){return x.default.query(re,x.default.Scope.BLOCK)&&!Array.isArray($.format[re])&&(J[re]=$.format[re]),J},{});this.quill.insertText(R.index,`
`,W,w.default.sources.USER),this.quill.setSelection(R.index+1,w.default.sources.SILENT),this.quill.focus(),Object.keys($.format).forEach(function(J){W[J]==null&&(Array.isArray($.format[J])||J!=="link"&&G.quill.format(J,$.format[J],w.default.sources.USER))})}function I(R){return{key:B.keys.TAB,shiftKey:!R,format:{"code-block":!0},handler:function(G){var W=x.default.query("code-block"),J=G.index,re=G.length,ce=this.quill.scroll.descendant(W,J),ue=a(ce,2),he=ue[0],xe=ue[1];if(he!=null){var Ne=this.quill.getIndex(he),Ee=he.newlineIndex(xe,!0)+1,V=he.newlineIndex(Ne+xe+re),Y=he.domNode.textContent.slice(Ee,V).split(`
`);xe=0,Y.forEach(function(ee,te){R?(he.insertAt(Ee+xe,W.TAB),xe+=W.TAB.length,te===0?J+=W.TAB.length:re+=W.TAB.length):ee.startsWith(W.TAB)&&(he.deleteAt(Ee+xe,W.TAB.length),xe-=W.TAB.length,te===0?J-=W.TAB.length:re-=W.TAB.length),xe+=ee.length+1}),this.quill.update(w.default.sources.USER),this.quill.setSelection(J,re,w.default.sources.SILENT)}}}}function H(R){return{key:R[0].toUpperCase(),shortKey:!0,handler:function(G,W){this.quill.format(R,!W.format[R],w.default.sources.USER)}}}function U(R){if(typeof R=="string"||typeof R=="number")return U({key:R});if((typeof R>"u"?"undefined":o(R))==="object"&&(R=(0,v.default)(R,!1)),typeof R.key=="string")if(B.keys[R.key.toUpperCase()]!=null)R.key=B.keys[R.key.toUpperCase()];else if(R.key.length===1)R.key=R.key.toUpperCase().charCodeAt(0);else return null;return R.shortKey&&(R[z]=R.shortKey,delete R.shortKey),R}r.default=B,r.SHORTKEY=z},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function h(m,x){var p=[],w=!0,T=!1,S=void 0;try{for(var O=m[Symbol.iterator](),P;!(w=(P=O.next()).done)&&(p.push(P.value),!(x&&p.length===x));w=!0);}catch(j){T=!0,S=j}finally{try{!w&&O.return&&O.return()}finally{if(T)throw S}}return p}return function(m,x){if(Array.isArray(m))return m;if(Symbol.iterator in Object(m))return h(m,x);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function h(m,x,p){m===null&&(m=Function.prototype);var w=Object.getOwnPropertyDescriptor(m,x);if(w===void 0){var T=Object.getPrototypeOf(m);return T===null?void 0:h(T,x,p)}else{if("value"in w)return w.value;var S=w.get;return S===void 0?void 0:S.call(p)}},g=function(){function h(m,x){for(var p=0;p<x.length;p++){var w=x[p];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(m,w.key,w)}}return function(m,x,p){return x&&h(m.prototype,x),p&&h(m,p),m}}(),d=i(0),v=l(d),u=i(7),f=l(u);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function _(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function y(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var b=function(h){y(m,h),g(m,null,[{key:"value",value:function(){}}]);function m(x,p){c(this,m);var w=_(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,x));return w.selection=p,w.textNode=document.createTextNode(m.CONTENTS),w.domNode.appendChild(w.textNode),w._length=0,w}return g(m,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(p,w){if(this._length!==0)return a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,p,w);for(var T=this,S=0;T!=null&&T.statics.scope!==v.default.Scope.BLOCK_BLOT;)S+=T.offset(T.parent),T=T.parent;T!=null&&(this._length=m.CONTENTS.length,T.optimize(),T.formatAt(S,m.CONTENTS.length,p,w),this._length=0)}},{key:"index",value:function(p,w){return p===this.textNode?0:a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"index",this).call(this,p,w)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var p=this.textNode,w=this.selection.getNativeRange(),T=void 0,S=void 0,O=void 0;if(w!=null&&w.start.node===p&&w.end.node===p){var P=[p,w.start.offset,w.end.offset];T=P[0],S=P[1],O=P[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==m.CONTENTS){var j=this.textNode.data.split(m.CONTENTS).join("");this.next instanceof f.default?(T=this.next.domNode,this.next.insertAt(0,j),this.textNode.data=m.CONTENTS):(this.textNode.data=j,this.parent.insertBefore(v.default.create(this.textNode),this),this.textNode=document.createTextNode(m.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),S!=null){var k=[S,O].map(function(C){return Math.max(0,Math.min(T.data.length,C-1))}),E=o(k,2);return S=E[0],O=E[1],{startNode:T,startOffset:S,endNode:T,endOffset:O}}}}},{key:"update",value:function(p,w){var T=this;if(p.some(function(O){return O.type==="characterData"&&O.target===T.textNode})){var S=this.restore();S&&(w.range=S)}}},{key:"value",value:function(){return""}}]),m}(v.default.Embed);b.blotName="cursor",b.className="ql-cursor",b.tagName="span",b.CONTENTS="\uFEFF",r.default=b},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(0),a=v(o),g=i(4),d=v(g);function v(_){return _&&_.__esModule?_:{default:_}}function u(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function f(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function l(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var c=function(_){l(y,_);function y(){return u(this,y),f(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return y}(a.default.Container);c.allowedChildren=[d.default,g.BlockEmbed,c],r.default=c},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.ColorStyle=r.ColorClass=r.ColorAttributor=void 0;var o=function(){function b(h,m){for(var x=0;x<m.length;x++){var p=m[x];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(h,p.key,p)}}return function(h,m,x){return m&&b(h.prototype,m),x&&b(h,x),h}}(),a=function b(h,m,x){h===null&&(h=Function.prototype);var p=Object.getOwnPropertyDescriptor(h,m);if(p===void 0){var w=Object.getPrototypeOf(h);return w===null?void 0:b(w,m,x)}else{if("value"in p)return p.value;var T=p.get;return T===void 0?void 0:T.call(x)}},g=i(0),d=v(g);function v(b){return b&&b.__esModule?b:{default:b}}function u(b,h){if(!(b instanceof h))throw new TypeError("Cannot call a class as a function")}function f(b,h){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:b}function l(b,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);b.prototype=Object.create(h&&h.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(b,h):b.__proto__=h)}var c=function(b){l(h,b);function h(){return u(this,h),f(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}return o(h,[{key:"value",value:function(x){var p=a(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"value",this).call(this,x);return p.startsWith("rgb(")?(p=p.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+p.split(",").map(function(w){return("00"+parseInt(w).toString(16)).slice(-2)}).join("")):p}}]),h}(d.default.Attributor.Style),_=new d.default.Attributor.Class("color","ql-color",{scope:d.default.Scope.INLINE}),y=new c("color","color",{scope:d.default.Scope.INLINE});r.ColorAttributor=c,r.ColorClass=_,r.ColorStyle=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.sanitize=r.default=void 0;var o=function(){function y(b,h){for(var m=0;m<h.length;m++){var x=h[m];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(b,x.key,x)}}return function(b,h,m){return h&&y(b.prototype,h),m&&y(b,m),b}}(),a=function y(b,h,m){b===null&&(b=Function.prototype);var x=Object.getOwnPropertyDescriptor(b,h);if(x===void 0){var p=Object.getPrototypeOf(b);return p===null?void 0:y(p,h,m)}else{if("value"in x)return x.value;var w=x.get;return w===void 0?void 0:w.call(m)}},g=i(6),d=v(g);function v(y){return y&&y.__esModule?y:{default:y}}function u(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")}function f(y,b){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:y}function l(y,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);y.prototype=Object.create(b&&b.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(y,b):y.__proto__=b)}var c=function(y){l(b,y);function b(){return u(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,[{key:"format",value:function(m,x){if(m!==this.statics.blotName||!x)return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,m,x);x=this.constructor.sanitize(x),this.domNode.setAttribute("href",x)}}],[{key:"create",value:function(m){var x=a(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,m);return m=this.sanitize(m),x.setAttribute("href",m),x.setAttribute("rel","noopener noreferrer"),x.setAttribute("target","_blank"),x}},{key:"formats",value:function(m){return m.getAttribute("href")}},{key:"sanitize",value:function(m){return _(m,this.PROTOCOL_WHITELIST)?m:this.SANITIZED_URL}}]),b}(d.default);c.blotName="link",c.tagName="A",c.SANITIZED_URL="about:blank",c.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function _(y,b){var h=document.createElement("a");h.href=y;var m=h.href.slice(0,h.href.indexOf(":"));return b.indexOf(m)>-1}r.default=c,r.sanitize=_},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},a=function(){function b(h,m){for(var x=0;x<m.length;x++){var p=m[x];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(h,p.key,p)}}return function(h,m,x){return m&&b(h.prototype,m),x&&b(h,x),h}}(),g=i(23),d=f(g),v=i(107),u=f(v);function f(b){return b&&b.__esModule?b:{default:b}}function l(b,h){if(!(b instanceof h))throw new TypeError("Cannot call a class as a function")}var c=0;function _(b,h){b.setAttribute(h,b.getAttribute(h)!=="true")}var y=function(){function b(h){var m=this;l(this,b),this.select=h,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){m.togglePicker()}),this.label.addEventListener("keydown",function(x){switch(x.keyCode){case d.default.keys.ENTER:m.togglePicker();break;case d.default.keys.ESCAPE:m.escape(),x.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return a(b,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),_(this.label,"aria-expanded"),_(this.options,"aria-hidden")}},{key:"buildItem",value:function(m){var x=this,p=document.createElement("span");return p.tabIndex="0",p.setAttribute("role","button"),p.classList.add("ql-picker-item"),m.hasAttribute("value")&&p.setAttribute("data-value",m.getAttribute("value")),m.textContent&&p.setAttribute("data-label",m.textContent),p.addEventListener("click",function(){x.selectItem(p,!0)}),p.addEventListener("keydown",function(w){switch(w.keyCode){case d.default.keys.ENTER:x.selectItem(p,!0),w.preventDefault();break;case d.default.keys.ESCAPE:x.escape(),w.preventDefault();break}}),p}},{key:"buildLabel",value:function(){var m=document.createElement("span");return m.classList.add("ql-picker-label"),m.innerHTML=u.default,m.tabIndex="0",m.setAttribute("role","button"),m.setAttribute("aria-expanded","false"),this.container.appendChild(m),m}},{key:"buildOptions",value:function(){var m=this,x=document.createElement("span");x.classList.add("ql-picker-options"),x.setAttribute("aria-hidden","true"),x.tabIndex="-1",x.id="ql-picker-options-"+c,c+=1,this.label.setAttribute("aria-controls",x.id),this.options=x,[].slice.call(this.select.options).forEach(function(p){var w=m.buildItem(p);x.appendChild(w),p.selected===!0&&m.selectItem(w)}),this.container.appendChild(x)}},{key:"buildPicker",value:function(){var m=this;[].slice.call(this.select.attributes).forEach(function(x){m.container.setAttribute(x.name,x.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var m=this;this.close(),setTimeout(function(){return m.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(m){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p=this.container.querySelector(".ql-selected");if(m!==p&&(p!=null&&p.classList.remove("ql-selected"),m!=null&&(m.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(m.parentNode.children,m),m.hasAttribute("data-value")?this.label.setAttribute("data-value",m.getAttribute("data-value")):this.label.removeAttribute("data-value"),m.hasAttribute("data-label")?this.label.setAttribute("data-label",m.getAttribute("data-label")):this.label.removeAttribute("data-label"),x))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":o(Event))==="object"){var w=document.createEvent("Event");w.initEvent("change",!0,!0),this.select.dispatchEvent(w)}this.close()}}},{key:"update",value:function(){var m=void 0;if(this.select.selectedIndex>-1){var x=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];m=this.select.options[this.select.selectedIndex],this.selectItem(x)}else this.selectItem(null);var p=m!=null&&m!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",p)}}]),b}();r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(0),a=M(o),g=i(5),d=M(g),v=i(4),u=M(v),f=i(16),l=M(f),c=i(25),_=M(c),y=i(24),b=M(y),h=i(35),m=M(h),x=i(6),p=M(x),w=i(22),T=M(w),S=i(7),O=M(S),P=i(55),j=M(P),k=i(42),E=M(k),C=i(23),L=M(C);function M(z){return z&&z.__esModule?z:{default:z}}d.default.register({"blots/block":u.default,"blots/block/embed":v.BlockEmbed,"blots/break":l.default,"blots/container":_.default,"blots/cursor":b.default,"blots/embed":m.default,"blots/inline":p.default,"blots/scroll":T.default,"blots/text":O.default,"modules/clipboard":j.default,"modules/history":E.default,"modules/keyboard":L.default}),a.default.register(u.default,l.default,b.default,p.default,T.default,O.default),r.default=d.default},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(1),a=function(){function g(d){this.domNode=d,this.domNode[o.DATA_KEY]={blot:this}}return Object.defineProperty(g.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),g.create=function(d){if(this.tagName==null)throw new o.ParchmentError("Blot definition missing tagName");var v;return Array.isArray(this.tagName)?(typeof d=="string"&&(d=d.toUpperCase(),parseInt(d).toString()===d&&(d=parseInt(d))),typeof d=="number"?v=document.createElement(this.tagName[d-1]):this.tagName.indexOf(d)>-1?v=document.createElement(d):v=document.createElement(this.tagName[0])):v=document.createElement(this.tagName),this.className&&v.classList.add(this.className),v},g.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},g.prototype.clone=function(){var d=this.domNode.cloneNode(!1);return o.create(d)},g.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[o.DATA_KEY]},g.prototype.deleteAt=function(d,v){var u=this.isolate(d,v);u.remove()},g.prototype.formatAt=function(d,v,u,f){var l=this.isolate(d,v);if(o.query(u,o.Scope.BLOT)!=null&&f)l.wrap(u,f);else if(o.query(u,o.Scope.ATTRIBUTE)!=null){var c=o.create(this.statics.scope);l.wrap(c),c.format(u,f)}},g.prototype.insertAt=function(d,v,u){var f=u==null?o.create("text",v):o.create(v,u),l=this.split(d);this.parent.insertBefore(f,l)},g.prototype.insertInto=function(d,v){v===void 0&&(v=null),this.parent!=null&&this.parent.children.remove(this);var u=null;d.children.insertBefore(this,v),v!=null&&(u=v.domNode),(this.domNode.parentNode!=d.domNode||this.domNode.nextSibling!=u)&&d.domNode.insertBefore(this.domNode,u),this.parent=d,this.attach()},g.prototype.isolate=function(d,v){var u=this.split(d);return u.split(v),u},g.prototype.length=function(){return 1},g.prototype.offset=function(d){return d===void 0&&(d=this.parent),this.parent==null||this==d?0:this.parent.children.offset(this)+this.parent.offset(d)},g.prototype.optimize=function(d){this.domNode[o.DATA_KEY]!=null&&delete this.domNode[o.DATA_KEY].mutations},g.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},g.prototype.replace=function(d){d.parent!=null&&(d.parent.insertBefore(this,d.next),d.remove())},g.prototype.replaceWith=function(d,v){var u=typeof d=="string"?o.create(d,v):d;return u.replace(this),u},g.prototype.split=function(d,v){return d===0?this:this.next},g.prototype.update=function(d,v){},g.prototype.wrap=function(d,v){var u=typeof d=="string"?o.create(d,v):d;return this.parent!=null&&this.parent.insertBefore(u,this.next),u.appendChild(this),u},g.blotName="abstract",g}();r.default=a},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(12),a=i(32),g=i(33),d=i(1),v=function(){function u(f){this.attributes={},this.domNode=f,this.build()}return u.prototype.attribute=function(f,l){l?f.add(this.domNode,l)&&(f.value(this.domNode)!=null?this.attributes[f.attrName]=f:delete this.attributes[f.attrName]):(f.remove(this.domNode),delete this.attributes[f.attrName])},u.prototype.build=function(){var f=this;this.attributes={};var l=o.default.keys(this.domNode),c=a.default.keys(this.domNode),_=g.default.keys(this.domNode);l.concat(c).concat(_).forEach(function(y){var b=d.query(y,d.Scope.ATTRIBUTE);b instanceof o.default&&(f.attributes[b.attrName]=b)})},u.prototype.copy=function(f){var l=this;Object.keys(this.attributes).forEach(function(c){var _=l.attributes[c].value(l.domNode);f.format(c,_)})},u.prototype.move=function(f){var l=this;this.copy(f),Object.keys(this.attributes).forEach(function(c){l.attributes[c].remove(l.domNode)}),this.attributes={}},u.prototype.values=function(){var f=this;return Object.keys(this.attributes).reduce(function(l,c){return l[c]=f.attributes[c].value(f.domNode),l},{})},u}();r.default=v},function(t,r,i){var o=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var l in f)f.hasOwnProperty(l)&&(u[l]=f[l])};return function(u,f){v(u,f);function l(){this.constructor=u}u.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(12);function g(v,u){var f=v.getAttribute("class")||"";return f.split(/\s+/).filter(function(l){return l.indexOf(u+"-")===0})}var d=function(v){o(u,v);function u(){return v!==null&&v.apply(this,arguments)||this}return u.keys=function(f){return(f.getAttribute("class")||"").split(/\s+/).map(function(l){return l.split("-").slice(0,-1).join("-")})},u.prototype.add=function(f,l){return this.canAdd(f,l)?(this.remove(f),f.classList.add(this.keyName+"-"+l),!0):!1},u.prototype.remove=function(f){var l=g(f,this.keyName);l.forEach(function(c){f.classList.remove(c)}),f.classList.length===0&&f.removeAttribute("class")},u.prototype.value=function(f){var l=g(f,this.keyName)[0]||"",c=l.slice(this.keyName.length+1);return this.canAdd(f,c)?c:""},u}(a.default);r.default=d},function(t,r,i){var o=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var l in f)f.hasOwnProperty(l)&&(u[l]=f[l])};return function(u,f){v(u,f);function l(){this.constructor=u}u.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(12);function g(v){var u=v.split("-"),f=u.slice(1).map(function(l){return l[0].toUpperCase()+l.slice(1)}).join("");return u[0]+f}var d=function(v){o(u,v);function u(){return v!==null&&v.apply(this,arguments)||this}return u.keys=function(f){return(f.getAttribute("style")||"").split(";").map(function(l){var c=l.split(":");return c[0].trim()})},u.prototype.add=function(f,l){return this.canAdd(f,l)?(f.style[g(this.keyName)]=l,!0):!1},u.prototype.remove=function(f){f.style[g(this.keyName)]="",f.getAttribute("style")||f.removeAttribute("style")},u.prototype.value=function(f){var l=f.style[g(this.keyName)];return this.canAdd(f,l)?l:""},u}(a.default);r.default=d},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function d(v,u){for(var f=0;f<u.length;f++){var l=u[f];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(v,l.key,l)}}return function(v,u,f){return u&&d(v.prototype,u),f&&d(v,f),v}}();function a(d,v){if(!(d instanceof v))throw new TypeError("Cannot call a class as a function")}var g=function(){function d(v,u){a(this,d),this.quill=v,this.options=u,this.modules={}}return o(d,[{key:"init",value:function(){var u=this;Object.keys(this.options.modules).forEach(function(f){u.modules[f]==null&&u.addModule(f)})}},{key:"addModule",value:function(u){var f=this.quill.constructor.import("modules/"+u);return this.modules[u]=new f(this.quill,this.options.modules[u]||{}),this.modules[u]}}]),d}();g.DEFAULTS={modules:{}},g.themes={default:g},r.default=g},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function h(m,x){for(var p=0;p<x.length;p++){var w=x[p];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(m,w.key,w)}}return function(m,x,p){return x&&h(m.prototype,x),p&&h(m,p),m}}(),a=function h(m,x,p){m===null&&(m=Function.prototype);var w=Object.getOwnPropertyDescriptor(m,x);if(w===void 0){var T=Object.getPrototypeOf(m);return T===null?void 0:h(T,x,p)}else{if("value"in w)return w.value;var S=w.get;return S===void 0?void 0:S.call(p)}},g=i(0),d=f(g),v=i(7),u=f(v);function f(h){return h&&h.__esModule?h:{default:h}}function l(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function c(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function _(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var y="\uFEFF",b=function(h){_(m,h);function m(x){l(this,m);var p=c(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,x));return p.contentNode=document.createElement("span"),p.contentNode.setAttribute("contenteditable",!1),[].slice.call(p.domNode.childNodes).forEach(function(w){p.contentNode.appendChild(w)}),p.leftGuard=document.createTextNode(y),p.rightGuard=document.createTextNode(y),p.domNode.appendChild(p.leftGuard),p.domNode.appendChild(p.contentNode),p.domNode.appendChild(p.rightGuard),p}return o(m,[{key:"index",value:function(p,w){return p===this.leftGuard?0:p===this.rightGuard?1:a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"index",this).call(this,p,w)}},{key:"restore",value:function(p){var w=void 0,T=void 0,S=p.data.split(y).join("");if(p===this.leftGuard)if(this.prev instanceof u.default){var O=this.prev.length();this.prev.insertAt(O,S),w={startNode:this.prev.domNode,startOffset:O+S.length}}else T=document.createTextNode(S),this.parent.insertBefore(d.default.create(T),this),w={startNode:T,startOffset:S.length};else p===this.rightGuard&&(this.next instanceof u.default?(this.next.insertAt(0,S),w={startNode:this.next.domNode,startOffset:S.length}):(T=document.createTextNode(S),this.parent.insertBefore(d.default.create(T),this.next),w={startNode:T,startOffset:S.length}));return p.data=y,w}},{key:"update",value:function(p,w){var T=this;p.forEach(function(S){if(S.type==="characterData"&&(S.target===T.leftGuard||S.target===T.rightGuard)){var O=T.restore(S.target);O&&(w.range=O)}})}}]),m}(d.default.Embed);r.default=b},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.AlignStyle=r.AlignClass=r.AlignAttribute=void 0;var o=i(0),a=g(o);function g(l){return l&&l.__esModule?l:{default:l}}var d={scope:a.default.Scope.BLOCK,whitelist:["right","center","justify"]},v=new a.default.Attributor.Attribute("align","align",d),u=new a.default.Attributor.Class("align","ql-align",d),f=new a.default.Attributor.Style("align","text-align",d);r.AlignAttribute=v,r.AlignClass=u,r.AlignStyle=f},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.BackgroundStyle=r.BackgroundClass=void 0;var o=i(0),a=d(o),g=i(26);function d(f){return f&&f.__esModule?f:{default:f}}var v=new a.default.Attributor.Class("background","ql-bg",{scope:a.default.Scope.INLINE}),u=new g.ColorAttributor("background","background-color",{scope:a.default.Scope.INLINE});r.BackgroundClass=v,r.BackgroundStyle=u},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.DirectionStyle=r.DirectionClass=r.DirectionAttribute=void 0;var o=i(0),a=g(o);function g(l){return l&&l.__esModule?l:{default:l}}var d={scope:a.default.Scope.BLOCK,whitelist:["rtl"]},v=new a.default.Attributor.Attribute("direction","dir",d),u=new a.default.Attributor.Class("direction","ql-direction",d),f=new a.default.Attributor.Style("direction","direction",d);r.DirectionAttribute=v,r.DirectionClass=u,r.DirectionStyle=f},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.FontClass=r.FontStyle=void 0;var o=function(){function h(m,x){for(var p=0;p<x.length;p++){var w=x[p];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(m,w.key,w)}}return function(m,x,p){return x&&h(m.prototype,x),p&&h(m,p),m}}(),a=function h(m,x,p){m===null&&(m=Function.prototype);var w=Object.getOwnPropertyDescriptor(m,x);if(w===void 0){var T=Object.getPrototypeOf(m);return T===null?void 0:h(T,x,p)}else{if("value"in w)return w.value;var S=w.get;return S===void 0?void 0:S.call(p)}},g=i(0),d=v(g);function v(h){return h&&h.__esModule?h:{default:h}}function u(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")}function f(h,m){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:h}function l(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(h,m):h.__proto__=m)}var c={scope:d.default.Scope.INLINE,whitelist:["serif","monospace"]},_=new d.default.Attributor.Class("font","ql-font",c),y=function(h){l(m,h);function m(){return u(this,m),f(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return o(m,[{key:"value",value:function(p){return a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"value",this).call(this,p).replace(/["']/g,"")}}]),m}(d.default.Attributor.Style),b=new y("font","font-family",c);r.FontStyle=b,r.FontClass=_},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SizeStyle=r.SizeClass=void 0;var o=i(0),a=g(o);function g(u){return u&&u.__esModule?u:{default:u}}var d=new a.default.Attributor.Class("size","ql-size",{scope:a.default.Scope.INLINE,whitelist:["small","large","huge"]}),v=new a.default.Attributor.Style("size","font-size",{scope:a.default.Scope.INLINE,whitelist:["10px","18px","32px"]});r.SizeClass=d,r.SizeStyle=v},function(t,r,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.getLastChangeIndex=r.default=void 0;var o=function(){function x(p,w){for(var T=0;T<w.length;T++){var S=w[T];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(p,S.key,S)}}return function(p,w,T){return w&&x(p.prototype,w),T&&x(p,T),p}}(),a=i(0),g=l(a),d=i(5),v=l(d),u=i(9),f=l(u);function l(x){return x&&x.__esModule?x:{default:x}}function c(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function _(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function y(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var b=function(x){y(p,x);function p(w,T){c(this,p);var S=_(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,w,T));return S.lastRecorded=0,S.ignoreChange=!1,S.clear(),S.quill.on(v.default.events.EDITOR_CHANGE,function(O,P,j,k){O!==v.default.events.TEXT_CHANGE||S.ignoreChange||(!S.options.userOnly||k===v.default.sources.USER?S.record(P,j):S.transform(P))}),S.quill.keyboard.addBinding({key:"Z",shortKey:!0},S.undo.bind(S)),S.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},S.redo.bind(S)),/Win/i.test(navigator.platform)&&S.quill.keyboard.addBinding({key:"Y",shortKey:!0},S.redo.bind(S)),S}return o(p,[{key:"change",value:function(T,S){if(this.stack[T].length!==0){var O=this.stack[T].pop();this.stack[S].push(O),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(O[T],v.default.sources.USER),this.ignoreChange=!1;var P=m(O[T]);this.quill.setSelection(P)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(T,S){if(T.ops.length!==0){this.stack.redo=[];var O=this.quill.getContents().diff(S),P=Date.now();if(this.lastRecorded+this.options.delay>P&&this.stack.undo.length>0){var j=this.stack.undo.pop();O=O.compose(j.undo),T=j.redo.compose(T)}else this.lastRecorded=P;this.stack.undo.push({redo:T,undo:O}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(T){this.stack.undo.forEach(function(S){S.undo=T.transform(S.undo,!0),S.redo=T.transform(S.redo,!0)}),this.stack.redo.forEach(function(S){S.undo=T.transform(S.undo,!0),S.redo=T.transform(S.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),p}(f.default);b.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function h(x){var p=x.ops[x.ops.length-1];return p==null?!1:p.insert!=null?typeof p.insert=="string"&&p.insert.endsWith(`
`):p.attributes!=null?Object.keys(p.attributes).some(function(w){return g.default.query(w,g.default.Scope.BLOCK)!=null}):!1}function m(x){var p=x.reduce(function(T,S){return T+=S.delete||0,T},0),w=x.length()-p;return h(x)&&(w-=1),w}r.default=b,r.getLastChangeIndex=m},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BaseTooltip=void 0;var o=function(){function N(I,H){for(var U=0;U<H.length;U++){var R=H[U];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(I,R.key,R)}}return function(I,H,U){return H&&N(I.prototype,H),U&&N(I,U),I}}(),a=function N(I,H,U){I===null&&(I=Function.prototype);var R=Object.getOwnPropertyDescriptor(I,H);if(R===void 0){var $=Object.getPrototypeOf(I);return $===null?void 0:N($,H,U)}else{if("value"in R)return R.value;var G=R.get;return G===void 0?void 0:G.call(U)}},g=i(3),d=P(g),v=i(2),u=P(v),f=i(8),l=P(f),c=i(23),_=P(c),y=i(34),b=P(y),h=i(59),m=P(h),x=i(60),p=P(x),w=i(28),T=P(w),S=i(61),O=P(S);function P(N){return N&&N.__esModule?N:{default:N}}function j(N,I){if(!(N instanceof I))throw new TypeError("Cannot call a class as a function")}function k(N,I){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:N}function E(N,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);N.prototype=Object.create(I&&I.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(N,I):N.__proto__=I)}var C=[!1,"center","right","justify"],L=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],M=[!1,"serif","monospace"],z=["1","2","3",!1],B=["small",!1,"large","huge"],K=function(N){E(I,N);function I(H,U){j(this,I);var R=k(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,H,U)),$=function G(W){if(!document.body.contains(H.root))return document.body.removeEventListener("click",G);R.tooltip!=null&&!R.tooltip.root.contains(W.target)&&document.activeElement!==R.tooltip.textbox&&!R.quill.hasFocus()&&R.tooltip.hide(),R.pickers!=null&&R.pickers.forEach(function(J){J.container.contains(W.target)||J.close()})};return H.emitter.listenDOM("click",document.body,$),R}return o(I,[{key:"addModule",value:function(U){var R=a(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"addModule",this).call(this,U);return U==="toolbar"&&this.extendToolbar(R),R}},{key:"buildButtons",value:function(U,R){U.forEach(function($){var G=$.getAttribute("class")||"";G.split(/\s+/).forEach(function(W){if(W.startsWith("ql-")&&(W=W.slice(3),R[W]!=null))if(W==="direction")$.innerHTML=R[W][""]+R[W].rtl;else if(typeof R[W]=="string")$.innerHTML=R[W];else{var J=$.value||"";J!=null&&R[W][J]&&($.innerHTML=R[W][J])}})})}},{key:"buildPickers",value:function(U,R){var $=this;this.pickers=U.map(function(W){if(W.classList.contains("ql-align"))return W.querySelector("option")==null&&A(W,C),new p.default(W,R.align);if(W.classList.contains("ql-background")||W.classList.contains("ql-color")){var J=W.classList.contains("ql-background")?"background":"color";return W.querySelector("option")==null&&A(W,L,J==="background"?"#ffffff":"#000000"),new m.default(W,R[J])}else return W.querySelector("option")==null&&(W.classList.contains("ql-font")?A(W,M):W.classList.contains("ql-header")?A(W,z):W.classList.contains("ql-size")&&A(W,B)),new T.default(W)});var G=function(){$.pickers.forEach(function(J){J.update()})};this.quill.on(l.default.events.EDITOR_CHANGE,G)}}]),I}(b.default);K.DEFAULTS=(0,d.default)(!0,{},b.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var I=this,H=this.container.querySelector("input.ql-image[type=file]");H==null&&(H=document.createElement("input"),H.setAttribute("type","file"),H.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),H.classList.add("ql-image"),H.addEventListener("change",function(){if(H.files!=null&&H.files[0]!=null){var U=new FileReader;U.onload=function(R){var $=I.quill.getSelection(!0);I.quill.updateContents(new u.default().retain($.index).delete($.length).insert({image:R.target.result}),l.default.sources.USER),I.quill.setSelection($.index+1,l.default.sources.SILENT),H.value=""},U.readAsDataURL(H.files[0])}}),this.container.appendChild(H)),H.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var q=function(N){E(I,N);function I(H,U){j(this,I);var R=k(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,H,U));return R.textbox=R.root.querySelector('input[type="text"]'),R.listen(),R}return o(I,[{key:"listen",value:function(){var U=this;this.textbox.addEventListener("keydown",function(R){_.default.match(R,"enter")?(U.save(),R.preventDefault()):_.default.match(R,"escape")&&(U.cancel(),R.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),R!=null?this.textbox.value=R:U!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+U)||""),this.root.setAttribute("data-mode",U)}},{key:"restoreFocus",value:function(){var U=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=U}},{key:"save",value:function(){var U=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var R=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",U,l.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",U,l.default.sources.USER)),this.quill.root.scrollTop=R;break}case"video":U=D(U);case"formula":{if(!U)break;var $=this.quill.getSelection(!0);if($!=null){var G=$.index+$.length;this.quill.insertEmbed(G,this.root.getAttribute("data-mode"),U,l.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(G+1," ",l.default.sources.USER),this.quill.setSelection(G+2,l.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),I}(O.default);function D(N){var I=N.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||N.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return I?(I[1]||"https")+"://www.youtube.com/embed/"+I[2]+"?showinfo=0":(I=N.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(I[1]||"https")+"://player.vimeo.com/video/"+I[2]+"/":N}function A(N,I){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;I.forEach(function(U){var R=document.createElement("option");U===H?R.setAttribute("selected","selected"):R.setAttribute("value",U),N.appendChild(R)})}r.BaseTooltip=q,r.default=K},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function a(){this.head=this.tail=null,this.length=0}return a.prototype.append=function(){for(var g=[],d=0;d<arguments.length;d++)g[d]=arguments[d];this.insertBefore(g[0],null),g.length>1&&this.append.apply(this,g.slice(1))},a.prototype.contains=function(g){for(var d,v=this.iterator();d=v();)if(d===g)return!0;return!1},a.prototype.insertBefore=function(g,d){g&&(g.next=d,d!=null?(g.prev=d.prev,d.prev!=null&&(d.prev.next=g),d.prev=g,d===this.head&&(this.head=g)):this.tail!=null?(this.tail.next=g,g.prev=this.tail,this.tail=g):(g.prev=null,this.head=this.tail=g),this.length+=1)},a.prototype.offset=function(g){for(var d=0,v=this.head;v!=null;){if(v===g)return d;d+=v.length(),v=v.next}return-1},a.prototype.remove=function(g){this.contains(g)&&(g.prev!=null&&(g.prev.next=g.next),g.next!=null&&(g.next.prev=g.prev),g===this.head&&(this.head=g.next),g===this.tail&&(this.tail=g.prev),this.length-=1)},a.prototype.iterator=function(g){return g===void 0&&(g=this.head),function(){var d=g;return g!=null&&(g=g.next),d}},a.prototype.find=function(g,d){d===void 0&&(d=!1);for(var v,u=this.iterator();v=u();){var f=v.length();if(g<f||d&&g===f&&(v.next==null||v.next.length()!==0))return[v,g];g-=f}return[null,0]},a.prototype.forEach=function(g){for(var d,v=this.iterator();d=v();)g(d)},a.prototype.forEachAt=function(g,d,v){if(!(d<=0))for(var u=this.find(g),f=u[0],l=u[1],c,_=g-l,y=this.iterator(f);(c=y())&&_<g+d;){var b=c.length();g>_?v(c,g-_,Math.min(d,_+b-g)):v(c,0,Math.min(b,g+d-_)),_+=b}},a.prototype.map=function(g){return this.reduce(function(d,v){return d.push(g(v)),d},[])},a.prototype.reduce=function(g,d){for(var v,u=this.iterator();v=u();)d=g(d,v);return d},a}();r.default=o},function(t,r,i){var o=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,c){l.__proto__=c}||function(l,c){for(var _ in c)c.hasOwnProperty(_)&&(l[_]=c[_])};return function(l,c){f(l,c);function _(){this.constructor=l}l.prototype=c===null?Object.create(c):(_.prototype=c.prototype,new _)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(17),g=i(1),d={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},v=100,u=function(f){o(l,f);function l(c){var _=f.call(this,c)||this;return _.scroll=_,_.observer=new MutationObserver(function(y){_.update(y)}),_.observer.observe(_.domNode,d),_.attach(),_}return l.prototype.detach=function(){f.prototype.detach.call(this),this.observer.disconnect()},l.prototype.deleteAt=function(c,_){this.update(),c===0&&_===this.length()?this.children.forEach(function(y){y.remove()}):f.prototype.deleteAt.call(this,c,_)},l.prototype.formatAt=function(c,_,y,b){this.update(),f.prototype.formatAt.call(this,c,_,y,b)},l.prototype.insertAt=function(c,_,y){this.update(),f.prototype.insertAt.call(this,c,_,y)},l.prototype.optimize=function(c,_){var y=this;c===void 0&&(c=[]),_===void 0&&(_={}),f.prototype.optimize.call(this,_);for(var b=[].slice.call(this.observer.takeRecords());b.length>0;)c.push(b.pop());for(var h=function(w,T){T===void 0&&(T=!0),!(w==null||w===y)&&w.domNode.parentNode!=null&&(w.domNode[g.DATA_KEY].mutations==null&&(w.domNode[g.DATA_KEY].mutations=[]),T&&h(w.parent))},m=function(w){w.domNode[g.DATA_KEY]==null||w.domNode[g.DATA_KEY].mutations==null||(w instanceof a.default&&w.children.forEach(m),w.optimize(_))},x=c,p=0;x.length>0;p+=1){if(p>=v)throw new Error("[Parchment] Maximum optimize iterations reached");for(x.forEach(function(w){var T=g.find(w.target,!0);T!=null&&(T.domNode===w.target&&(w.type==="childList"?(h(g.find(w.previousSibling,!1)),[].forEach.call(w.addedNodes,function(S){var O=g.find(S,!1);h(O,!1),O instanceof a.default&&O.children.forEach(function(P){h(P,!1)})})):w.type==="attributes"&&h(T.prev)),h(T))}),this.children.forEach(m),x=[].slice.call(this.observer.takeRecords()),b=x.slice();b.length>0;)c.push(b.pop())}},l.prototype.update=function(c,_){var y=this;_===void 0&&(_={}),c=c||this.observer.takeRecords(),c.map(function(b){var h=g.find(b.target,!0);return h==null?null:h.domNode[g.DATA_KEY].mutations==null?(h.domNode[g.DATA_KEY].mutations=[b],h):(h.domNode[g.DATA_KEY].mutations.push(b),null)}).forEach(function(b){b==null||b===y||b.domNode[g.DATA_KEY]==null||b.update(b.domNode[g.DATA_KEY].mutations||[],_)}),this.domNode[g.DATA_KEY].mutations!=null&&f.prototype.update.call(this,this.domNode[g.DATA_KEY].mutations,_),this.optimize(c,_)},l.blotName="scroll",l.defaultChild="block",l.scope=g.Scope.BLOCK_BLOT,l.tagName="DIV",l}(a.default);r.default=u},function(t,r,i){var o=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,l){f.__proto__=l}||function(f,l){for(var c in l)l.hasOwnProperty(c)&&(f[c]=l[c])};return function(f,l){u(f,l);function c(){this.constructor=f}f.prototype=l===null?Object.create(l):(c.prototype=l.prototype,new c)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(18),g=i(1);function d(u,f){if(Object.keys(u).length!==Object.keys(f).length)return!1;for(var l in u)if(u[l]!==f[l])return!1;return!0}var v=function(u){o(f,u);function f(){return u!==null&&u.apply(this,arguments)||this}return f.formats=function(l){if(l.tagName!==f.tagName)return u.formats.call(this,l)},f.prototype.format=function(l,c){var _=this;l===this.statics.blotName&&!c?(this.children.forEach(function(y){y instanceof a.default||(y=y.wrap(f.blotName,!0)),_.attributes.copy(y)}),this.unwrap()):u.prototype.format.call(this,l,c)},f.prototype.formatAt=function(l,c,_,y){if(this.formats()[_]!=null||g.query(_,g.Scope.ATTRIBUTE)){var b=this.isolate(l,c);b.format(_,y)}else u.prototype.formatAt.call(this,l,c,_,y)},f.prototype.optimize=function(l){u.prototype.optimize.call(this,l);var c=this.formats();if(Object.keys(c).length===0)return this.unwrap();var _=this.next;_ instanceof f&&_.prev===this&&d(c,_.formats())&&(_.moveChildren(this),_.remove())},f.blotName="inline",f.scope=g.Scope.INLINE_BLOT,f.tagName="SPAN",f}(a.default);r.default=v},function(t,r,i){var o=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var l in f)f.hasOwnProperty(l)&&(u[l]=f[l])};return function(u,f){v(u,f);function l(){this.constructor=u}u.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(18),g=i(1),d=function(v){o(u,v);function u(){return v!==null&&v.apply(this,arguments)||this}return u.formats=function(f){var l=g.query(u.blotName).tagName;if(f.tagName!==l)return v.formats.call(this,f)},u.prototype.format=function(f,l){g.query(f,g.Scope.BLOCK)!=null&&(f===this.statics.blotName&&!l?this.replaceWith(u.blotName):v.prototype.format.call(this,f,l))},u.prototype.formatAt=function(f,l,c,_){g.query(c,g.Scope.BLOCK)!=null?this.format(c,_):v.prototype.formatAt.call(this,f,l,c,_)},u.prototype.insertAt=function(f,l,c){if(c==null||g.query(l,g.Scope.INLINE)!=null)v.prototype.insertAt.call(this,f,l,c);else{var _=this.split(f),y=g.create(l,c);_.parent.insertBefore(y,_)}},u.prototype.update=function(f,l){navigator.userAgent.match(/Trident/)?this.build():v.prototype.update.call(this,f,l)},u.blotName="block",u.scope=g.Scope.BLOCK_BLOT,u.tagName="P",u}(a.default);r.default=d},function(t,r,i){var o=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,u){v.__proto__=u}||function(v,u){for(var f in u)u.hasOwnProperty(f)&&(v[f]=u[f])};return function(v,u){d(v,u);function f(){this.constructor=v}v.prototype=u===null?Object.create(u):(f.prototype=u.prototype,new f)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(19),g=function(d){o(v,d);function v(){return d!==null&&d.apply(this,arguments)||this}return v.formats=function(u){},v.prototype.format=function(u,f){d.prototype.formatAt.call(this,0,this.length(),u,f)},v.prototype.formatAt=function(u,f,l,c){u===0&&f===this.length()?this.format(l,c):d.prototype.formatAt.call(this,u,f,l,c)},v.prototype.formats=function(){return this.statics.formats(this.domNode)},v}(a.default);r.default=g},function(t,r,i){var o=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var l in f)f.hasOwnProperty(l)&&(u[l]=f[l])};return function(u,f){v(u,f);function l(){this.constructor=u}u.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)}}();Object.defineProperty(r,"__esModule",{value:!0});var a=i(19),g=i(1),d=function(v){o(u,v);function u(f){var l=v.call(this,f)||this;return l.text=l.statics.value(l.domNode),l}return u.create=function(f){return document.createTextNode(f)},u.value=function(f){var l=f.data;return l.normalize&&(l=l.normalize()),l},u.prototype.deleteAt=function(f,l){this.domNode.data=this.text=this.text.slice(0,f)+this.text.slice(f+l)},u.prototype.index=function(f,l){return this.domNode===f?l:-1},u.prototype.insertAt=function(f,l,c){c==null?(this.text=this.text.slice(0,f)+l+this.text.slice(f),this.domNode.data=this.text):v.prototype.insertAt.call(this,f,l,c)},u.prototype.length=function(){return this.text.length},u.prototype.optimize=function(f){v.prototype.optimize.call(this,f),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof u&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},u.prototype.position=function(f,l){return[this.domNode,f]},u.prototype.split=function(f,l){if(l===void 0&&(l=!1),!l){if(f===0)return this;if(f===this.length())return this.next}var c=g.create(this.domNode.splitText(f));return this.parent.insertBefore(c,this.next),this.text=this.statics.value(this.domNode),c},u.prototype.update=function(f,l){var c=this;f.some(function(_){return _.type==="characterData"&&_.target===c.domNode})&&(this.text=this.statics.value(this.domNode))},u.prototype.value=function(){return this.text},u.blotName="text",u.scope=g.Scope.INLINE_BLOT,u}(a.default);r.default=d},function(t,r,i){var o=document.createElement("div");if(o.classList.toggle("test-class",!1),o.classList.contains("test-class")){var a=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(g,d){return arguments.length>1&&!this.contains(g)==!d?d:a.call(this,g)}}String.prototype.startsWith||(String.prototype.startsWith=function(g,d){return d=d||0,this.substr(d,g.length)===g}),String.prototype.endsWith||(String.prototype.endsWith=function(g,d){var v=this.toString();(typeof d!="number"||!isFinite(d)||Math.floor(d)!==d||d>v.length)&&(d=v.length),d-=g.length;var u=v.indexOf(g,d);return u!==-1&&u===d}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(d){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof d!="function")throw new TypeError("predicate must be a function");for(var v=Object(this),u=v.length>>>0,f=arguments[1],l,c=0;c<u;c++)if(l=v[c],d.call(f,l,c,v))return l}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,r){var i=-1,o=1,a=0;function g(p,w,T){if(p==w)return p?[[a,p]]:[];(T<0||p.length<T)&&(T=null);var S=f(p,w),O=p.substring(0,S);p=p.substring(S),w=w.substring(S),S=l(p,w);var P=p.substring(p.length-S);p=p.substring(0,p.length-S),w=w.substring(0,w.length-S);var j=d(p,w);return O&&j.unshift([a,O]),P&&j.push([a,P]),_(j),T!=null&&(j=h(j,T)),j=m(j),j}function d(p,w){var T;if(!p)return[[o,w]];if(!w)return[[i,p]];var S=p.length>w.length?p:w,O=p.length>w.length?w:p,P=S.indexOf(O);if(P!=-1)return T=[[o,S.substring(0,P)],[a,O],[o,S.substring(P+O.length)]],p.length>w.length&&(T[0][0]=T[2][0]=i),T;if(O.length==1)return[[i,p],[o,w]];var j=c(p,w);if(j){var k=j[0],E=j[1],C=j[2],L=j[3],M=j[4],z=g(k,C),B=g(E,L);return z.concat([[a,M]],B)}return v(p,w)}function v(p,w){for(var T=p.length,S=w.length,O=Math.ceil((T+S)/2),P=O,j=2*O,k=new Array(j),E=new Array(j),C=0;C<j;C++)k[C]=-1,E[C]=-1;k[P+1]=0,E[P+1]=0;for(var L=T-S,M=L%2!=0,z=0,B=0,K=0,q=0,D=0;D<O;D++){for(var A=-D+z;A<=D-B;A+=2){var N=P+A,I;A==-D||A!=D&&k[N-1]<k[N+1]?I=k[N+1]:I=k[N-1]+1;for(var H=I-A;I<T&&H<S&&p.charAt(I)==w.charAt(H);)I++,H++;if(k[N]=I,I>T)B+=2;else if(H>S)z+=2;else if(M){var U=P+L-A;if(U>=0&&U<j&&E[U]!=-1){var R=T-E[U];if(I>=R)return u(p,w,I,H)}}}for(var $=-D+K;$<=D-q;$+=2){var U=P+$,R;$==-D||$!=D&&E[U-1]<E[U+1]?R=E[U+1]:R=E[U-1]+1;for(var G=R-$;R<T&&G<S&&p.charAt(T-R-1)==w.charAt(S-G-1);)R++,G++;if(E[U]=R,R>T)q+=2;else if(G>S)K+=2;else if(!M){var N=P+L-$;if(N>=0&&N<j&&k[N]!=-1){var I=k[N],H=P+I-N;if(R=T-R,I>=R)return u(p,w,I,H)}}}}return[[i,p],[o,w]]}function u(p,w,T,S){var O=p.substring(0,T),P=w.substring(0,S),j=p.substring(T),k=w.substring(S),E=g(O,P),C=g(j,k);return E.concat(C)}function f(p,w){if(!p||!w||p.charAt(0)!=w.charAt(0))return 0;for(var T=0,S=Math.min(p.length,w.length),O=S,P=0;T<O;)p.substring(P,O)==w.substring(P,O)?(T=O,P=T):S=O,O=Math.floor((S-T)/2+T);return O}function l(p,w){if(!p||!w||p.charAt(p.length-1)!=w.charAt(w.length-1))return 0;for(var T=0,S=Math.min(p.length,w.length),O=S,P=0;T<O;)p.substring(p.length-O,p.length-P)==w.substring(w.length-O,w.length-P)?(T=O,P=T):S=O,O=Math.floor((S-T)/2+T);return O}function c(p,w){var T=p.length>w.length?p:w,S=p.length>w.length?w:p;if(T.length<4||S.length*2<T.length)return null;function O(B,K,q){for(var D=B.substring(q,q+Math.floor(B.length/4)),A=-1,N="",I,H,U,R;(A=K.indexOf(D,A+1))!=-1;){var $=f(B.substring(q),K.substring(A)),G=l(B.substring(0,q),K.substring(0,A));N.length<G+$&&(N=K.substring(A-G,A)+K.substring(A,A+$),I=B.substring(0,q-G),H=B.substring(q+$),U=K.substring(0,A-G),R=K.substring(A+$))}return N.length*2>=B.length?[I,H,U,R,N]:null}var P=O(T,S,Math.ceil(T.length/4)),j=O(T,S,Math.ceil(T.length/2)),k;if(!P&&!j)return null;j?P?k=P[4].length>j[4].length?P:j:k=j:k=P;var E,C,L,M;p.length>w.length?(E=k[0],C=k[1],L=k[2],M=k[3]):(L=k[0],M=k[1],E=k[2],C=k[3]);var z=k[4];return[E,C,L,M,z]}function _(p){p.push([a,""]);for(var w=0,T=0,S=0,O="",P="",j;w<p.length;)switch(p[w][0]){case o:S++,P+=p[w][1],w++;break;case i:T++,O+=p[w][1],w++;break;case a:T+S>1?(T!==0&&S!==0&&(j=f(P,O),j!==0&&(w-T-S>0&&p[w-T-S-1][0]==a?p[w-T-S-1][1]+=P.substring(0,j):(p.splice(0,0,[a,P.substring(0,j)]),w++),P=P.substring(j),O=O.substring(j)),j=l(P,O),j!==0&&(p[w][1]=P.substring(P.length-j)+p[w][1],P=P.substring(0,P.length-j),O=O.substring(0,O.length-j))),T===0?p.splice(w-S,T+S,[o,P]):S===0?p.splice(w-T,T+S,[i,O]):p.splice(w-T-S,T+S,[i,O],[o,P]),w=w-T-S+(T?1:0)+(S?1:0)+1):w!==0&&p[w-1][0]==a?(p[w-1][1]+=p[w][1],p.splice(w,1)):w++,S=0,T=0,O="",P="";break}p[p.length-1][1]===""&&p.pop();var k=!1;for(w=1;w<p.length-1;)p[w-1][0]==a&&p[w+1][0]==a&&(p[w][1].substring(p[w][1].length-p[w-1][1].length)==p[w-1][1]?(p[w][1]=p[w-1][1]+p[w][1].substring(0,p[w][1].length-p[w-1][1].length),p[w+1][1]=p[w-1][1]+p[w+1][1],p.splice(w-1,1),k=!0):p[w][1].substring(0,p[w+1][1].length)==p[w+1][1]&&(p[w-1][1]+=p[w+1][1],p[w][1]=p[w][1].substring(p[w+1][1].length)+p[w+1][1],p.splice(w+1,1),k=!0)),w++;k&&_(p)}var y=g;y.INSERT=o,y.DELETE=i,y.EQUAL=a,t.exports=y;function b(p,w){if(w===0)return[a,p];for(var T=0,S=0;S<p.length;S++){var O=p[S];if(O[0]===i||O[0]===a){var P=T+O[1].length;if(w===P)return[S+1,p];if(w<P){p=p.slice();var j=w-T,k=[O[0],O[1].slice(0,j)],E=[O[0],O[1].slice(j)];return p.splice(S,1,k,E),[S+1,p]}else T=P}}throw new Error("cursor_pos is out of bounds!")}function h(p,w){var T=b(p,w),S=T[1],O=T[0],P=S[O],j=S[O+1];if(P==null)return p;if(P[0]!==a)return p;if(j!=null&&P[1]+j[1]===j[1]+P[1])return S.splice(O,2,j,P),x(S,O,2);if(j!=null&&j[1].indexOf(P[1])===0){S.splice(O,2,[j[0],P[1]],[0,P[1]]);var k=j[1].slice(P[1].length);return k.length>0&&S.splice(O+2,0,[j[0],k]),x(S,O,3)}else return p}function m(p){for(var w=!1,T=function(j){return j.charCodeAt(0)>=56320&&j.charCodeAt(0)<=57343},S=function(j){return j.charCodeAt(j.length-1)>=55296&&j.charCodeAt(j.length-1)<=56319},O=2;O<p.length;O+=1)p[O-2][0]===a&&S(p[O-2][1])&&p[O-1][0]===i&&T(p[O-1][1])&&p[O][0]===o&&T(p[O][1])&&(w=!0,p[O-1][1]=p[O-2][1].slice(-1)+p[O-1][1],p[O][1]=p[O-2][1].slice(-1)+p[O][1],p[O-2][1]=p[O-2][1].slice(0,-1));if(!w)return p;for(var P=[],O=0;O<p.length;O+=1)p[O][1].length>0&&P.push(p[O]);return P}function x(p,w,T){for(var S=w+T-1;S>=0&&S>=w-1;S--)if(S+1<p.length){var O=p[S],P=p[S+1];O[0]===P[1]&&p.splice(S,2,[O[0],O[1]+P[1]])}return p}},function(t,r){r=t.exports=typeof Object.keys=="function"?Object.keys:i,r.shim=i;function i(o){var a=[];for(var g in o)a.push(g);return a}},function(t,r){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";r=t.exports=i?o:a,r.supported=o;function o(g){return Object.prototype.toString.call(g)=="[object Arguments]"}r.unsupported=a;function a(g){return g&&typeof g=="object"&&typeof g.length=="number"&&Object.prototype.hasOwnProperty.call(g,"callee")&&!Object.prototype.propertyIsEnumerable.call(g,"callee")||!1}},function(t,r){var i=Object.prototype.hasOwnProperty,o="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(o=!1));function g(v,u,f){this.fn=v,this.context=u,this.once=f||!1}function d(){this._events=new a,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],f,l;if(this._eventsCount===0)return u;for(l in f=this._events)i.call(f,l)&&u.push(o?l.slice(1):l);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},d.prototype.listeners=function(u,f){var l=o?o+u:u,c=this._events[l];if(f)return!!c;if(!c)return[];if(c.fn)return[c.fn];for(var _=0,y=c.length,b=new Array(y);_<y;_++)b[_]=c[_].fn;return b},d.prototype.emit=function(u,f,l,c,_,y){var b=o?o+u:u;if(!this._events[b])return!1;var h=this._events[b],m=arguments.length,x,p;if(h.fn){switch(h.once&&this.removeListener(u,h.fn,void 0,!0),m){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,f),!0;case 3:return h.fn.call(h.context,f,l),!0;case 4:return h.fn.call(h.context,f,l,c),!0;case 5:return h.fn.call(h.context,f,l,c,_),!0;case 6:return h.fn.call(h.context,f,l,c,_,y),!0}for(p=1,x=new Array(m-1);p<m;p++)x[p-1]=arguments[p];h.fn.apply(h.context,x)}else{var w=h.length,T;for(p=0;p<w;p++)switch(h[p].once&&this.removeListener(u,h[p].fn,void 0,!0),m){case 1:h[p].fn.call(h[p].context);break;case 2:h[p].fn.call(h[p].context,f);break;case 3:h[p].fn.call(h[p].context,f,l);break;case 4:h[p].fn.call(h[p].context,f,l,c);break;default:if(!x)for(T=1,x=new Array(m-1);T<m;T++)x[T-1]=arguments[T];h[p].fn.apply(h[p].context,x)}}return!0},d.prototype.on=function(u,f,l){var c=new g(f,l||this),_=o?o+u:u;return this._events[_]?this._events[_].fn?this._events[_]=[this._events[_],c]:this._events[_].push(c):(this._events[_]=c,this._eventsCount++),this},d.prototype.once=function(u,f,l){var c=new g(f,l||this,!0),_=o?o+u:u;return this._events[_]?this._events[_].fn?this._events[_]=[this._events[_],c]:this._events[_].push(c):(this._events[_]=c,this._eventsCount++),this},d.prototype.removeListener=function(u,f,l,c){var _=o?o+u:u;if(!this._events[_])return this;if(!f)return--this._eventsCount===0?this._events=new a:delete this._events[_],this;var y=this._events[_];if(y.fn)y.fn===f&&(!c||y.once)&&(!l||y.context===l)&&(--this._eventsCount===0?this._events=new a:delete this._events[_]);else{for(var b=0,h=[],m=y.length;b<m;b++)(y[b].fn!==f||c&&!y[b].once||l&&y[b].context!==l)&&h.push(y[b]);h.length?this._events[_]=h.length===1?h[0]:h:--this._eventsCount===0?this._events=new a:delete this._events[_]}return this},d.prototype.removeAllListeners=function(u){var f;return u?(f=o?o+u:u,this._events[f]&&(--this._eventsCount===0?this._events=new a:delete this._events[f])):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.prefixed=o,d.EventEmitter=d,typeof t<"u"&&(t.exports=d)},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.matchText=r.matchSpacing=r.matchNewline=r.matchBlot=r.matchAttributor=r.default=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},a=function(){function V(Y,ee){var te=[],Z=!0,pe=!1,fe=void 0;try{for(var de=Y[Symbol.iterator](),Re;!(Z=(Re=de.next()).done)&&(te.push(Re.value),!(ee&&te.length===ee));Z=!0);}catch(et){pe=!0,fe=et}finally{try{!Z&&de.return&&de.return()}finally{if(pe)throw fe}}return te}return function(Y,ee){if(Array.isArray(Y))return Y;if(Symbol.iterator in Object(Y))return V(Y,ee);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function V(Y,ee){for(var te=0;te<ee.length;te++){var Z=ee[te];Z.enumerable=Z.enumerable||!1,Z.configurable=!0,"value"in Z&&(Z.writable=!0),Object.defineProperty(Y,Z.key,Z)}}return function(Y,ee,te){return ee&&V(Y.prototype,ee),te&&V(Y,te),Y}}(),d=i(3),v=E(d),u=i(2),f=E(u),l=i(0),c=E(l),_=i(5),y=E(_),b=i(10),h=E(b),m=i(9),x=E(m),p=i(36),w=i(37),T=i(13),S=E(T),O=i(26),P=i(38),j=i(39),k=i(40);function E(V){return V&&V.__esModule?V:{default:V}}function C(V,Y,ee){return Y in V?Object.defineProperty(V,Y,{value:ee,enumerable:!0,configurable:!0,writable:!0}):V[Y]=ee,V}function L(V,Y){if(!(V instanceof Y))throw new TypeError("Cannot call a class as a function")}function M(V,Y){if(!V)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y&&(typeof Y=="object"||typeof Y=="function")?Y:V}function z(V,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Y);V.prototype=Object.create(Y&&Y.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}),Y&&(Object.setPrototypeOf?Object.setPrototypeOf(V,Y):V.__proto__=Y)}var B=(0,h.default)("quill:clipboard"),K="__ql-matcher",q=[[Node.TEXT_NODE,Ee],[Node.TEXT_NODE,he],["br",re],[Node.ELEMENT_NODE,he],[Node.ELEMENT_NODE,J],[Node.ELEMENT_NODE,xe],[Node.ELEMENT_NODE,W],[Node.ELEMENT_NODE,Ne],["li",ue],["b",G.bind(G,"bold")],["i",G.bind(G,"italic")],["style",ce]],D=[p.AlignAttribute,P.DirectionAttribute].reduce(function(V,Y){return V[Y.keyName]=Y,V},{}),A=[p.AlignStyle,w.BackgroundStyle,O.ColorStyle,P.DirectionStyle,j.FontStyle,k.SizeStyle].reduce(function(V,Y){return V[Y.keyName]=Y,V},{}),N=function(V){z(Y,V);function Y(ee,te){L(this,Y);var Z=M(this,(Y.__proto__||Object.getPrototypeOf(Y)).call(this,ee,te));return Z.quill.root.addEventListener("paste",Z.onPaste.bind(Z)),Z.container=Z.quill.addContainer("ql-clipboard"),Z.container.setAttribute("contenteditable",!0),Z.container.setAttribute("tabindex",-1),Z.matchers=[],q.concat(Z.options.matchers).forEach(function(pe){var fe=a(pe,2),de=fe[0],Re=fe[1];!te.matchVisual&&Re===xe||Z.addMatcher(de,Re)}),Z}return g(Y,[{key:"addMatcher",value:function(te,Z){this.matchers.push([te,Z])}},{key:"convert",value:function(te){if(typeof te=="string")return this.container.innerHTML=te.replace(/\>\r?\n +\</g,"><"),this.convert();var Z=this.quill.getFormat(this.quill.selection.savedRange.index);if(Z[S.default.blotName]){var pe=this.container.innerText;return this.container.innerHTML="",new f.default().insert(pe,C({},S.default.blotName,Z[S.default.blotName]))}var fe=this.prepareMatching(),de=a(fe,2),Re=de[0],et=de[1],Oe=$(this.container,Re,et);return U(Oe,`
`)&&Oe.ops[Oe.ops.length-1].attributes==null&&(Oe=Oe.compose(new f.default().retain(Oe.length()-1).delete(1))),B.log("convert",this.container.innerHTML,Oe),this.container.innerHTML="",Oe}},{key:"dangerouslyPasteHTML",value:function(te,Z){var pe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:y.default.sources.API;if(typeof te=="string")this.quill.setContents(this.convert(te),Z),this.quill.setSelection(0,y.default.sources.SILENT);else{var fe=this.convert(Z);this.quill.updateContents(new f.default().retain(te).concat(fe),pe),this.quill.setSelection(te+fe.length(),y.default.sources.SILENT)}}},{key:"onPaste",value:function(te){var Z=this;if(!(te.defaultPrevented||!this.quill.isEnabled())){var pe=this.quill.getSelection(),fe=new f.default().retain(pe.index),de=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(y.default.sources.SILENT),setTimeout(function(){fe=fe.concat(Z.convert()).delete(pe.length),Z.quill.updateContents(fe,y.default.sources.USER),Z.quill.setSelection(fe.length()-pe.length,y.default.sources.SILENT),Z.quill.scrollingContainer.scrollTop=de,Z.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var te=this,Z=[],pe=[];return this.matchers.forEach(function(fe){var de=a(fe,2),Re=de[0],et=de[1];switch(Re){case Node.TEXT_NODE:pe.push(et);break;case Node.ELEMENT_NODE:Z.push(et);break;default:[].forEach.call(te.container.querySelectorAll(Re),function(Oe){Oe[K]=Oe[K]||[],Oe[K].push(et)});break}}),[Z,pe]}}]),Y}(x.default);N.DEFAULTS={matchers:[],matchVisual:!0};function I(V,Y,ee){return(typeof Y>"u"?"undefined":o(Y))==="object"?Object.keys(Y).reduce(function(te,Z){return I(te,Z,Y[Z])},V):V.reduce(function(te,Z){return Z.attributes&&Z.attributes[Y]?te.push(Z):te.insert(Z.insert,(0,v.default)({},C({},Y,ee),Z.attributes))},new f.default)}function H(V){if(V.nodeType!==Node.ELEMENT_NODE)return{};var Y="__ql-computed-style";return V[Y]||(V[Y]=window.getComputedStyle(V))}function U(V,Y){for(var ee="",te=V.ops.length-1;te>=0&&ee.length<Y.length;--te){var Z=V.ops[te];if(typeof Z.insert!="string")break;ee=Z.insert+ee}return ee.slice(-1*Y.length)===Y}function R(V){if(V.childNodes.length===0)return!1;var Y=H(V);return["block","list-item"].indexOf(Y.display)>-1}function $(V,Y,ee){return V.nodeType===V.TEXT_NODE?ee.reduce(function(te,Z){return Z(V,te)},new f.default):V.nodeType===V.ELEMENT_NODE?[].reduce.call(V.childNodes||[],function(te,Z){var pe=$(Z,Y,ee);return Z.nodeType===V.ELEMENT_NODE&&(pe=Y.reduce(function(fe,de){return de(Z,fe)},pe),pe=(Z[K]||[]).reduce(function(fe,de){return de(Z,fe)},pe)),te.concat(pe)},new f.default):new f.default}function G(V,Y,ee){return I(ee,V,!0)}function W(V,Y){var ee=c.default.Attributor.Attribute.keys(V),te=c.default.Attributor.Class.keys(V),Z=c.default.Attributor.Style.keys(V),pe={};return ee.concat(te).concat(Z).forEach(function(fe){var de=c.default.query(fe,c.default.Scope.ATTRIBUTE);de!=null&&(pe[de.attrName]=de.value(V),pe[de.attrName])||(de=D[fe],de!=null&&(de.attrName===fe||de.keyName===fe)&&(pe[de.attrName]=de.value(V)||void 0),de=A[fe],de!=null&&(de.attrName===fe||de.keyName===fe)&&(de=A[fe],pe[de.attrName]=de.value(V)||void 0))}),Object.keys(pe).length>0&&(Y=I(Y,pe)),Y}function J(V,Y){var ee=c.default.query(V);if(ee==null)return Y;if(ee.prototype instanceof c.default.Embed){var te={},Z=ee.value(V);Z!=null&&(te[ee.blotName]=Z,Y=new f.default().insert(te,ee.formats(V)))}else typeof ee.formats=="function"&&(Y=I(Y,ee.blotName,ee.formats(V)));return Y}function re(V,Y){return U(Y,`
`)||Y.insert(`
`),Y}function ce(){return new f.default}function ue(V,Y){var ee=c.default.query(V);if(ee==null||ee.blotName!=="list-item"||!U(Y,`
`))return Y;for(var te=-1,Z=V.parentNode;!Z.classList.contains("ql-clipboard");)(c.default.query(Z)||{}).blotName==="list"&&(te+=1),Z=Z.parentNode;return te<=0?Y:Y.compose(new f.default().retain(Y.length()-1).retain(1,{indent:te}))}function he(V,Y){return U(Y,`
`)||(R(V)||Y.length()>0&&V.nextSibling&&R(V.nextSibling))&&Y.insert(`
`),Y}function xe(V,Y){if(R(V)&&V.nextElementSibling!=null&&!U(Y,`

`)){var ee=V.offsetHeight+parseFloat(H(V).marginTop)+parseFloat(H(V).marginBottom);V.nextElementSibling.offsetTop>V.offsetTop+ee*1.5&&Y.insert(`
`)}return Y}function Ne(V,Y){var ee={},te=V.style||{};return te.fontStyle&&H(V).fontStyle==="italic"&&(ee.italic=!0),te.fontWeight&&(H(V).fontWeight.startsWith("bold")||parseInt(H(V).fontWeight)>=700)&&(ee.bold=!0),Object.keys(ee).length>0&&(Y=I(Y,ee)),parseFloat(te.textIndent||0)>0&&(Y=new f.default().insert("	").concat(Y)),Y}function Ee(V,Y){var ee=V.data;if(V.parentNode.tagName==="O:P")return Y.insert(ee.trim());if(ee.trim().length===0&&V.parentNode.classList.contains("ql-clipboard"))return Y;if(!H(V.parentNode).whiteSpace.startsWith("pre")){var te=function(pe,fe){return fe=fe.replace(/[^\u00a0]/g,""),fe.length<1&&pe?" ":fe};ee=ee.replace(/\r\n/g," ").replace(/\n/g," "),ee=ee.replace(/\s\s+/g,te.bind(te,!0)),(V.previousSibling==null&&R(V.parentNode)||V.previousSibling!=null&&R(V.previousSibling))&&(ee=ee.replace(/^\s+/,te.bind(te,!1))),(V.nextSibling==null&&R(V.parentNode)||V.nextSibling!=null&&R(V.nextSibling))&&(ee=ee.replace(/\s+$/,te.bind(te,!1)))}return Y.insert(ee)}r.default=N,r.matchAttributor=W,r.matchBlot=J,r.matchNewline=he,r.matchSpacing=xe,r.matchText=Ee},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function _(y,b){for(var h=0;h<b.length;h++){var m=b[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(y,m.key,m)}}return function(y,b,h){return b&&_(y.prototype,b),h&&_(y,h),y}}(),a=function _(y,b,h){y===null&&(y=Function.prototype);var m=Object.getOwnPropertyDescriptor(y,b);if(m===void 0){var x=Object.getPrototypeOf(y);return x===null?void 0:_(x,b,h)}else{if("value"in m)return m.value;var p=m.get;return p===void 0?void 0:p.call(h)}},g=i(6),d=v(g);function v(_){return _&&_.__esModule?_:{default:_}}function u(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function f(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function l(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var c=function(_){l(y,_);function y(){return u(this,y),f(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return o(y,[{key:"optimize",value:function(h){a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"optimize",this).call(this,h),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return a(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),y}(d.default);c.blotName="bold",c.tagName=["STRONG","B"],r.default=c},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.addControls=r.default=void 0;var o=function(){function k(E,C){var L=[],M=!0,z=!1,B=void 0;try{for(var K=E[Symbol.iterator](),q;!(M=(q=K.next()).done)&&(L.push(q.value),!(C&&L.length===C));M=!0);}catch(D){z=!0,B=D}finally{try{!M&&K.return&&K.return()}finally{if(z)throw B}}return L}return function(E,C){if(Array.isArray(E))return E;if(Symbol.iterator in Object(E))return k(E,C);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function k(E,C){for(var L=0;L<C.length;L++){var M=C[L];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(E,M.key,M)}}return function(E,C,L){return C&&k(E.prototype,C),L&&k(E,L),E}}(),g=i(2),d=h(g),v=i(0),u=h(v),f=i(5),l=h(f),c=i(10),_=h(c),y=i(9),b=h(y);function h(k){return k&&k.__esModule?k:{default:k}}function m(k,E,C){return E in k?Object.defineProperty(k,E,{value:C,enumerable:!0,configurable:!0,writable:!0}):k[E]=C,k}function x(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function p(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function w(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var T=(0,_.default)("quill:toolbar"),S=function(k){w(E,k);function E(C,L){x(this,E);var M=p(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,C,L));if(Array.isArray(M.options.container)){var z=document.createElement("div");P(z,M.options.container),C.container.parentNode.insertBefore(z,C.container),M.container=z}else typeof M.options.container=="string"?M.container=document.querySelector(M.options.container):M.container=M.options.container;if(!(M.container instanceof HTMLElement)){var B;return B=T.error("Container required for toolbar",M.options),p(M,B)}return M.container.classList.add("ql-toolbar"),M.controls=[],M.handlers={},Object.keys(M.options.handlers).forEach(function(K){M.addHandler(K,M.options.handlers[K])}),[].forEach.call(M.container.querySelectorAll("button, select"),function(K){M.attach(K)}),M.quill.on(l.default.events.EDITOR_CHANGE,function(K,q){K===l.default.events.SELECTION_CHANGE&&M.update(q)}),M.quill.on(l.default.events.SCROLL_OPTIMIZE,function(){var K=M.quill.selection.getRange(),q=o(K,1),D=q[0];M.update(D)}),M}return a(E,[{key:"addHandler",value:function(L,M){this.handlers[L]=M}},{key:"attach",value:function(L){var M=this,z=[].find.call(L.classList,function(K){return K.indexOf("ql-")===0});if(z){if(z=z.slice(3),L.tagName==="BUTTON"&&L.setAttribute("type","button"),this.handlers[z]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[z]==null){T.warn("ignoring attaching to disabled format",z,L);return}if(u.default.query(z)==null){T.warn("ignoring attaching to nonexistent format",z,L);return}}var B=L.tagName==="SELECT"?"change":"click";L.addEventListener(B,function(K){var q=void 0;if(L.tagName==="SELECT"){if(L.selectedIndex<0)return;var D=L.options[L.selectedIndex];D.hasAttribute("selected")?q=!1:q=D.value||!1}else L.classList.contains("ql-active")?q=!1:q=L.value||!L.hasAttribute("value"),K.preventDefault();M.quill.focus();var A=M.quill.selection.getRange(),N=o(A,1),I=N[0];if(M.handlers[z]!=null)M.handlers[z].call(M,q);else if(u.default.query(z).prototype instanceof u.default.Embed){if(q=prompt("Enter "+z),!q)return;M.quill.updateContents(new d.default().retain(I.index).delete(I.length).insert(m({},z,q)),l.default.sources.USER)}else M.quill.format(z,q,l.default.sources.USER);M.update(I)}),this.controls.push([z,L])}}},{key:"update",value:function(L){var M=L==null?{}:this.quill.getFormat(L);this.controls.forEach(function(z){var B=o(z,2),K=B[0],q=B[1];if(q.tagName==="SELECT"){var D=void 0;if(L==null)D=null;else if(M[K]==null)D=q.querySelector("option[selected]");else if(!Array.isArray(M[K])){var A=M[K];typeof A=="string"&&(A=A.replace(/\"/g,'\\"')),D=q.querySelector('option[value="'+A+'"]')}D==null?(q.value="",q.selectedIndex=-1):D.selected=!0}else if(L==null)q.classList.remove("ql-active");else if(q.hasAttribute("value")){var N=M[K]===q.getAttribute("value")||M[K]!=null&&M[K].toString()===q.getAttribute("value")||M[K]==null&&!q.getAttribute("value");q.classList.toggle("ql-active",N)}else q.classList.toggle("ql-active",M[K]!=null)})}}]),E}(b.default);S.DEFAULTS={};function O(k,E,C){var L=document.createElement("button");L.setAttribute("type","button"),L.classList.add("ql-"+E),C!=null&&(L.value=C),k.appendChild(L)}function P(k,E){Array.isArray(E[0])||(E=[E]),E.forEach(function(C){var L=document.createElement("span");L.classList.add("ql-formats"),C.forEach(function(M){if(typeof M=="string")O(L,M);else{var z=Object.keys(M)[0],B=M[z];Array.isArray(B)?j(L,z,B):O(L,z,B)}}),k.appendChild(L)})}function j(k,E,C){var L=document.createElement("select");L.classList.add("ql-"+E),C.forEach(function(M){var z=document.createElement("option");M!==!1?z.setAttribute("value",M):z.setAttribute("selected","selected"),L.appendChild(z)}),k.appendChild(L)}S.DEFAULTS={container:null,handlers:{clean:function(){var E=this,C=this.quill.getSelection();if(C!=null)if(C.length==0){var L=this.quill.getFormat();Object.keys(L).forEach(function(M){u.default.query(M,u.default.Scope.INLINE)!=null&&E.quill.format(M,!1)})}else this.quill.removeFormat(C,l.default.sources.USER)},direction:function(E){var C=this.quill.getFormat().align;E==="rtl"&&C==null?this.quill.format("align","right",l.default.sources.USER):!E&&C==="right"&&this.quill.format("align",!1,l.default.sources.USER),this.quill.format("direction",E,l.default.sources.USER)},indent:function(E){var C=this.quill.getSelection(),L=this.quill.getFormat(C),M=parseInt(L.indent||0);if(E==="+1"||E==="-1"){var z=E==="+1"?1:-1;L.direction==="rtl"&&(z*=-1),this.quill.format("indent",M+z,l.default.sources.USER)}},link:function(E){E===!0&&(E=prompt("Enter link URL:")),this.quill.format("link",E,l.default.sources.USER)},list:function(E){var C=this.quill.getSelection(),L=this.quill.getFormat(C);E==="check"?L.list==="checked"||L.list==="unchecked"?this.quill.format("list",!1,l.default.sources.USER):this.quill.format("list","unchecked",l.default.sources.USER):this.quill.format("list",E,l.default.sources.USER)}}},r.default=S,r.addControls=P},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function _(y,b){for(var h=0;h<b.length;h++){var m=b[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(y,m.key,m)}}return function(y,b,h){return b&&_(y.prototype,b),h&&_(y,h),y}}(),a=function _(y,b,h){y===null&&(y=Function.prototype);var m=Object.getOwnPropertyDescriptor(y,b);if(m===void 0){var x=Object.getPrototypeOf(y);return x===null?void 0:_(x,b,h)}else{if("value"in m)return m.value;var p=m.get;return p===void 0?void 0:p.call(h)}},g=i(28),d=v(g);function v(_){return _&&_.__esModule?_:{default:_}}function u(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function f(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function l(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var c=function(_){l(y,_);function y(b,h){u(this,y);var m=f(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,b));return m.label.innerHTML=h,m.container.classList.add("ql-color-picker"),[].slice.call(m.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(x){x.classList.add("ql-primary")}),m}return o(y,[{key:"buildItem",value:function(h){var m=a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"buildItem",this).call(this,h);return m.style.backgroundColor=h.getAttribute("value")||"",m}},{key:"selectItem",value:function(h,m){a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,h,m);var x=this.label.querySelector(".ql-color-label"),p=h&&h.getAttribute("data-value")||"";x&&(x.tagName==="line"?x.style.stroke=p:x.style.fill=p)}}]),y}(d.default);r.default=c},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function _(y,b){for(var h=0;h<b.length;h++){var m=b[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(y,m.key,m)}}return function(y,b,h){return b&&_(y.prototype,b),h&&_(y,h),y}}(),a=function _(y,b,h){y===null&&(y=Function.prototype);var m=Object.getOwnPropertyDescriptor(y,b);if(m===void 0){var x=Object.getPrototypeOf(y);return x===null?void 0:_(x,b,h)}else{if("value"in m)return m.value;var p=m.get;return p===void 0?void 0:p.call(h)}},g=i(28),d=v(g);function v(_){return _&&_.__esModule?_:{default:_}}function u(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function f(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function l(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var c=function(_){l(y,_);function y(b,h){u(this,y);var m=f(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,b));return m.container.classList.add("ql-icon-picker"),[].forEach.call(m.container.querySelectorAll(".ql-picker-item"),function(x){x.innerHTML=h[x.getAttribute("data-value")||""]}),m.defaultItem=m.container.querySelector(".ql-selected"),m.selectItem(m.defaultItem),m}return o(y,[{key:"selectItem",value:function(h,m){a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,h,m),h=h||this.defaultItem,this.label.innerHTML=h.innerHTML}}]),y}(d.default);r.default=c},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function d(v,u){for(var f=0;f<u.length;f++){var l=u[f];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(v,l.key,l)}}return function(v,u,f){return u&&d(v.prototype,u),f&&d(v,f),v}}();function a(d,v){if(!(d instanceof v))throw new TypeError("Cannot call a class as a function")}var g=function(){function d(v,u){var f=this;a(this,d),this.quill=v,this.boundsContainer=u||document.body,this.root=v.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){f.root.style.marginTop=-1*f.quill.root.scrollTop+"px"}),this.hide()}return o(d,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(u){var f=u.left+u.width/2-this.root.offsetWidth/2,l=u.bottom+this.quill.root.scrollTop;this.root.style.left=f+"px",this.root.style.top=l+"px",this.root.classList.remove("ql-flip");var c=this.boundsContainer.getBoundingClientRect(),_=this.root.getBoundingClientRect(),y=0;if(_.right>c.right&&(y=c.right-_.right,this.root.style.left=f+y+"px"),_.left<c.left&&(y=c.left-_.left,this.root.style.left=f+y+"px"),_.bottom>c.bottom){var b=_.bottom-_.top,h=u.bottom-u.top+b;this.root.style.top=l-h+"px",this.root.classList.add("ql-flip")}return y}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),d}();r.default=g},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function j(k,E){var C=[],L=!0,M=!1,z=void 0;try{for(var B=k[Symbol.iterator](),K;!(L=(K=B.next()).done)&&(C.push(K.value),!(E&&C.length===E));L=!0);}catch(q){M=!0,z=q}finally{try{!L&&B.return&&B.return()}finally{if(M)throw z}}return C}return function(k,E){if(Array.isArray(k))return k;if(Symbol.iterator in Object(k))return j(k,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function j(k,E,C){k===null&&(k=Function.prototype);var L=Object.getOwnPropertyDescriptor(k,E);if(L===void 0){var M=Object.getPrototypeOf(k);return M===null?void 0:j(M,E,C)}else{if("value"in L)return L.value;var z=L.get;return z===void 0?void 0:z.call(C)}},g=function(){function j(k,E){for(var C=0;C<E.length;C++){var L=E[C];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(k,L.key,L)}}return function(k,E,C){return E&&j(k.prototype,E),C&&j(k,C),k}}(),d=i(3),v=x(d),u=i(8),f=x(u),l=i(43),c=x(l),_=i(27),y=x(_),b=i(15),h=i(41),m=x(h);function x(j){return j&&j.__esModule?j:{default:j}}function p(j,k){if(!(j instanceof k))throw new TypeError("Cannot call a class as a function")}function w(j,k){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:j}function T(j,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);j.prototype=Object.create(k&&k.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(j,k):j.__proto__=k)}var S=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],O=function(j){T(k,j);function k(E,C){p(this,k),C.modules.toolbar!=null&&C.modules.toolbar.container==null&&(C.modules.toolbar.container=S);var L=w(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,E,C));return L.quill.container.classList.add("ql-snow"),L}return g(k,[{key:"extendToolbar",value:function(C){C.container.classList.add("ql-snow"),this.buildButtons([].slice.call(C.container.querySelectorAll("button")),m.default),this.buildPickers([].slice.call(C.container.querySelectorAll("select")),m.default),this.tooltip=new P(this.quill,this.options.bounds),C.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(L,M){C.handlers.link.call(C,!M.format.link)})}}]),k}(c.default);O.DEFAULTS=(0,v.default)(!0,{},c.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(k){if(k){var E=this.quill.getSelection();if(E==null||E.length==0)return;var C=this.quill.getText(E);/^\S+@\S+\.\S+$/.test(C)&&C.indexOf("mailto:")!==0&&(C="mailto:"+C);var L=this.quill.theme.tooltip;L.edit("link",C)}else this.quill.format("link",!1)}}}}});var P=function(j){T(k,j);function k(E,C){p(this,k);var L=w(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,E,C));return L.preview=L.root.querySelector("a.ql-preview"),L}return g(k,[{key:"listen",value:function(){var C=this;a(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(L){C.root.classList.contains("ql-editing")?C.save():C.edit("link",C.preview.textContent),L.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(L){if(C.linkRange!=null){var M=C.linkRange;C.restoreFocus(),C.quill.formatText(M,"link",!1,f.default.sources.USER),delete C.linkRange}L.preventDefault(),C.hide()}),this.quill.on(f.default.events.SELECTION_CHANGE,function(L,M,z){if(L!=null){if(L.length===0&&z===f.default.sources.USER){var B=C.quill.scroll.descendant(y.default,L.index),K=o(B,2),q=K[0],D=K[1];if(q!=null){C.linkRange=new b.Range(L.index-D,q.length());var A=y.default.formats(q.domNode);C.preview.textContent=A,C.preview.setAttribute("href",A),C.show(),C.position(C.quill.getBounds(C.linkRange));return}}else delete C.linkRange;C.hide()}})}},{key:"show",value:function(){a(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),k}(l.BaseTooltip);P.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),r.default=O},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(29),a=Z(o),g=i(36),d=i(38),v=i(64),u=i(65),f=Z(u),l=i(66),c=Z(l),_=i(67),y=Z(_),b=i(37),h=i(26),m=i(39),x=i(40),p=i(56),w=Z(p),T=i(68),S=Z(T),O=i(27),P=Z(O),j=i(69),k=Z(j),E=i(70),C=Z(E),L=i(71),M=Z(L),z=i(72),B=Z(z),K=i(73),q=Z(K),D=i(13),A=Z(D),N=i(74),I=Z(N),H=i(75),U=Z(H),R=i(57),$=Z(R),G=i(41),W=Z(G),J=i(28),re=Z(J),ce=i(59),ue=Z(ce),he=i(60),xe=Z(he),Ne=i(61),Ee=Z(Ne),V=i(108),Y=Z(V),ee=i(62),te=Z(ee);function Z(pe){return pe&&pe.__esModule?pe:{default:pe}}a.default.register({"attributors/attribute/direction":d.DirectionAttribute,"attributors/class/align":g.AlignClass,"attributors/class/background":b.BackgroundClass,"attributors/class/color":h.ColorClass,"attributors/class/direction":d.DirectionClass,"attributors/class/font":m.FontClass,"attributors/class/size":x.SizeClass,"attributors/style/align":g.AlignStyle,"attributors/style/background":b.BackgroundStyle,"attributors/style/color":h.ColorStyle,"attributors/style/direction":d.DirectionStyle,"attributors/style/font":m.FontStyle,"attributors/style/size":x.SizeStyle},!0),a.default.register({"formats/align":g.AlignClass,"formats/direction":d.DirectionClass,"formats/indent":v.IndentClass,"formats/background":b.BackgroundStyle,"formats/color":h.ColorStyle,"formats/font":m.FontClass,"formats/size":x.SizeClass,"formats/blockquote":f.default,"formats/code-block":A.default,"formats/header":c.default,"formats/list":y.default,"formats/bold":w.default,"formats/code":D.Code,"formats/italic":S.default,"formats/link":P.default,"formats/script":k.default,"formats/strike":C.default,"formats/underline":M.default,"formats/image":B.default,"formats/video":q.default,"formats/list/item":_.ListItem,"modules/formula":I.default,"modules/syntax":U.default,"modules/toolbar":$.default,"themes/bubble":Y.default,"themes/snow":te.default,"ui/icons":W.default,"ui/picker":re.default,"ui/icon-picker":xe.default,"ui/color-picker":ue.default,"ui/tooltip":Ee.default},!0),r.default=a.default},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.IndentClass=void 0;var o=function(){function y(b,h){for(var m=0;m<h.length;m++){var x=h[m];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(b,x.key,x)}}return function(b,h,m){return h&&y(b.prototype,h),m&&y(b,m),b}}(),a=function y(b,h,m){b===null&&(b=Function.prototype);var x=Object.getOwnPropertyDescriptor(b,h);if(x===void 0){var p=Object.getPrototypeOf(b);return p===null?void 0:y(p,h,m)}else{if("value"in x)return x.value;var w=x.get;return w===void 0?void 0:w.call(m)}},g=i(0),d=v(g);function v(y){return y&&y.__esModule?y:{default:y}}function u(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")}function f(y,b){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:y}function l(y,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);y.prototype=Object.create(b&&b.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(y,b):y.__proto__=b)}var c=function(y){l(b,y);function b(){return u(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,[{key:"add",value:function(m,x){if(x==="+1"||x==="-1"){var p=this.value(m)||0;x=x==="+1"?p+1:p-1}return x===0?(this.remove(m),!0):a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"add",this).call(this,m,x)}},{key:"canAdd",value:function(m,x){return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"canAdd",this).call(this,m,x)||a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"canAdd",this).call(this,m,parseInt(x))}},{key:"value",value:function(m){return parseInt(a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,m))||void 0}}]),b}(d.default.Attributor.Class),_=new c("indent","ql-indent",{scope:d.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});r.IndentClass=_},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(4),a=g(o);function g(l){return l&&l.__esModule?l:{default:l}}function d(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function v(l,c){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:l}function u(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(l,c):l.__proto__=c)}var f=function(l){u(c,l);function c(){return d(this,c),v(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return c}(a.default);f.blotName="blockquote",f.tagName="blockquote",r.default=f},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function c(_,y){for(var b=0;b<y.length;b++){var h=y[b];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(_,h.key,h)}}return function(_,y,b){return y&&c(_.prototype,y),b&&c(_,b),_}}(),a=i(4),g=d(a);function d(c){return c&&c.__esModule?c:{default:c}}function v(c,_){if(!(c instanceof _))throw new TypeError("Cannot call a class as a function")}function u(c,_){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:c}function f(c,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);c.prototype=Object.create(_&&_.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(c,_):c.__proto__=_)}var l=function(c){f(_,c);function _(){return v(this,_),u(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return o(_,null,[{key:"formats",value:function(b){return this.tagName.indexOf(b.tagName)+1}}]),_}(g.default);l.blotName="header",l.tagName=["H1","H2","H3","H4","H5","H6"],r.default=l},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ListItem=void 0;var o=function(){function p(w,T){for(var S=0;S<T.length;S++){var O=T[S];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(w,O.key,O)}}return function(w,T,S){return T&&p(w.prototype,T),S&&p(w,S),w}}(),a=function p(w,T,S){w===null&&(w=Function.prototype);var O=Object.getOwnPropertyDescriptor(w,T);if(O===void 0){var P=Object.getPrototypeOf(w);return P===null?void 0:p(P,T,S)}else{if("value"in O)return O.value;var j=O.get;return j===void 0?void 0:j.call(S)}},g=i(0),d=c(g),v=i(4),u=c(v),f=i(25),l=c(f);function c(p){return p&&p.__esModule?p:{default:p}}function _(p,w,T){return w in p?Object.defineProperty(p,w,{value:T,enumerable:!0,configurable:!0,writable:!0}):p[w]=T,p}function y(p,w){if(!(p instanceof w))throw new TypeError("Cannot call a class as a function")}function b(p,w){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:p}function h(p,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);p.prototype=Object.create(w&&w.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(p,w):p.__proto__=w)}var m=function(p){h(w,p);function w(){return y(this,w),b(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return o(w,[{key:"format",value:function(S,O){S===x.blotName&&!O?this.replaceWith(d.default.create(this.statics.scope)):a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"format",this).call(this,S,O)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(S,O){return this.parent.isolate(this.offset(this.parent),this.length()),S===this.parent.statics.blotName?(this.parent.replaceWith(S,O),this):(this.parent.unwrap(),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"replaceWith",this).call(this,S,O))}}],[{key:"formats",value:function(S){return S.tagName===this.tagName?void 0:a(w.__proto__||Object.getPrototypeOf(w),"formats",this).call(this,S)}}]),w}(u.default);m.blotName="list-item",m.tagName="LI";var x=function(p){h(w,p),o(w,null,[{key:"create",value:function(S){var O=S==="ordered"?"OL":"UL",P=a(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,O);return(S==="checked"||S==="unchecked")&&P.setAttribute("data-checked",S==="checked"),P}},{key:"formats",value:function(S){if(S.tagName==="OL")return"ordered";if(S.tagName==="UL")return S.hasAttribute("data-checked")?S.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function w(T){y(this,w);var S=b(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,T)),O=function(j){if(j.target.parentNode===T){var k=S.statics.formats(T),E=d.default.find(j.target);k==="checked"?E.format("list","unchecked"):k==="unchecked"&&E.format("list","checked")}};return T.addEventListener("touchstart",O),T.addEventListener("mousedown",O),S}return o(w,[{key:"format",value:function(S,O){this.children.length>0&&this.children.tail.format(S,O)}},{key:"formats",value:function(){return _({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(S,O){if(S instanceof m)a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertBefore",this).call(this,S,O);else{var P=O==null?this.length():O.offset(this),j=this.split(P);j.parent.insertBefore(S,j)}}},{key:"optimize",value:function(S){a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"optimize",this).call(this,S);var O=this.next;O!=null&&O.prev===this&&O.statics.blotName===this.statics.blotName&&O.domNode.tagName===this.domNode.tagName&&O.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(O.moveChildren(this),O.remove())}},{key:"replace",value:function(S){if(S.statics.blotName!==this.statics.blotName){var O=d.default.create(this.statics.defaultChild);S.moveChildren(O),this.appendChild(O)}a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"replace",this).call(this,S)}}]),w}(l.default);x.blotName="list",x.scope=d.default.Scope.BLOCK_BLOT,x.tagName=["OL","UL"],x.defaultChild="list-item",x.allowedChildren=[m],r.ListItem=m,r.default=x},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(56),a=g(o);function g(l){return l&&l.__esModule?l:{default:l}}function d(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function v(l,c){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:l}function u(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(l,c):l.__proto__=c)}var f=function(l){u(c,l);function c(){return d(this,c),v(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return c}(a.default);f.blotName="italic",f.tagName=["EM","I"],r.default=f},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function _(y,b){for(var h=0;h<b.length;h++){var m=b[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(y,m.key,m)}}return function(y,b,h){return b&&_(y.prototype,b),h&&_(y,h),y}}(),a=function _(y,b,h){y===null&&(y=Function.prototype);var m=Object.getOwnPropertyDescriptor(y,b);if(m===void 0){var x=Object.getPrototypeOf(y);return x===null?void 0:_(x,b,h)}else{if("value"in m)return m.value;var p=m.get;return p===void 0?void 0:p.call(h)}},g=i(6),d=v(g);function v(_){return _&&_.__esModule?_:{default:_}}function u(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function f(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function l(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var c=function(_){l(y,_);function y(){return u(this,y),f(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return o(y,null,[{key:"create",value:function(h){return h==="super"?document.createElement("sup"):h==="sub"?document.createElement("sub"):a(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,h)}},{key:"formats",value:function(h){if(h.tagName==="SUB")return"sub";if(h.tagName==="SUP")return"super"}}]),y}(d.default);c.blotName="script",c.tagName=["SUB","SUP"],r.default=c},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),a=g(o);function g(l){return l&&l.__esModule?l:{default:l}}function d(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function v(l,c){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:l}function u(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(l,c):l.__proto__=c)}var f=function(l){u(c,l);function c(){return d(this,c),v(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return c}(a.default);f.blotName="strike",f.tagName="S",r.default=f},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(6),a=g(o);function g(l){return l&&l.__esModule?l:{default:l}}function d(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function v(l,c){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:l}function u(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(l,c):l.__proto__=c)}var f=function(l){u(c,l);function c(){return d(this,c),v(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return c}(a.default);f.blotName="underline",f.tagName="U",r.default=f},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function b(h,m){for(var x=0;x<m.length;x++){var p=m[x];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(h,p.key,p)}}return function(h,m,x){return m&&b(h.prototype,m),x&&b(h,x),h}}(),a=function b(h,m,x){h===null&&(h=Function.prototype);var p=Object.getOwnPropertyDescriptor(h,m);if(p===void 0){var w=Object.getPrototypeOf(h);return w===null?void 0:b(w,m,x)}else{if("value"in p)return p.value;var T=p.get;return T===void 0?void 0:T.call(x)}},g=i(0),d=u(g),v=i(27);function u(b){return b&&b.__esModule?b:{default:b}}function f(b,h){if(!(b instanceof h))throw new TypeError("Cannot call a class as a function")}function l(b,h){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:b}function c(b,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);b.prototype=Object.create(h&&h.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(b,h):b.__proto__=h)}var _=["alt","height","width"],y=function(b){c(h,b);function h(){return f(this,h),l(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}return o(h,[{key:"format",value:function(x,p){_.indexOf(x)>-1?p?this.domNode.setAttribute(x,p):this.domNode.removeAttribute(x):a(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"format",this).call(this,x,p)}}],[{key:"create",value:function(x){var p=a(h.__proto__||Object.getPrototypeOf(h),"create",this).call(this,x);return typeof x=="string"&&p.setAttribute("src",this.sanitize(x)),p}},{key:"formats",value:function(x){return _.reduce(function(p,w){return x.hasAttribute(w)&&(p[w]=x.getAttribute(w)),p},{})}},{key:"match",value:function(x){return/\.(jpe?g|gif|png)$/.test(x)||/^data:image\/.+;base64/.test(x)}},{key:"sanitize",value:function(x){return(0,v.sanitize)(x,["http","https","data"])?x:"//:0"}},{key:"value",value:function(x){return x.getAttribute("src")}}]),h}(d.default.Embed);y.blotName="image",y.tagName="IMG",r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function b(h,m){for(var x=0;x<m.length;x++){var p=m[x];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(h,p.key,p)}}return function(h,m,x){return m&&b(h.prototype,m),x&&b(h,x),h}}(),a=function b(h,m,x){h===null&&(h=Function.prototype);var p=Object.getOwnPropertyDescriptor(h,m);if(p===void 0){var w=Object.getPrototypeOf(h);return w===null?void 0:b(w,m,x)}else{if("value"in p)return p.value;var T=p.get;return T===void 0?void 0:T.call(x)}},g=i(4),d=i(27),v=u(d);function u(b){return b&&b.__esModule?b:{default:b}}function f(b,h){if(!(b instanceof h))throw new TypeError("Cannot call a class as a function")}function l(b,h){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:b}function c(b,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);b.prototype=Object.create(h&&h.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(b,h):b.__proto__=h)}var _=["height","width"],y=function(b){c(h,b);function h(){return f(this,h),l(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}return o(h,[{key:"format",value:function(x,p){_.indexOf(x)>-1?p?this.domNode.setAttribute(x,p):this.domNode.removeAttribute(x):a(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"format",this).call(this,x,p)}}],[{key:"create",value:function(x){var p=a(h.__proto__||Object.getPrototypeOf(h),"create",this).call(this,x);return p.setAttribute("frameborder","0"),p.setAttribute("allowfullscreen",!0),p.setAttribute("src",this.sanitize(x)),p}},{key:"formats",value:function(x){return _.reduce(function(p,w){return x.hasAttribute(w)&&(p[w]=x.getAttribute(w)),p},{})}},{key:"sanitize",value:function(x){return v.default.sanitize(x)}},{key:"value",value:function(x){return x.getAttribute("src")}}]),h}(g.BlockEmbed);y.blotName="video",y.className="ql-video",y.tagName="IFRAME",r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.FormulaBlot=void 0;var o=function(){function x(p,w){for(var T=0;T<w.length;T++){var S=w[T];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(p,S.key,S)}}return function(p,w,T){return w&&x(p.prototype,w),T&&x(p,T),p}}(),a=function x(p,w,T){p===null&&(p=Function.prototype);var S=Object.getOwnPropertyDescriptor(p,w);if(S===void 0){var O=Object.getPrototypeOf(p);return O===null?void 0:x(O,w,T)}else{if("value"in S)return S.value;var P=S.get;return P===void 0?void 0:P.call(T)}},g=i(35),d=c(g),v=i(5),u=c(v),f=i(9),l=c(f);function c(x){return x&&x.__esModule?x:{default:x}}function _(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function y(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function b(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var h=function(x){b(p,x);function p(){return _(this,p),y(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return o(p,null,[{key:"create",value:function(T){var S=a(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,T);return typeof T=="string"&&(window.katex.render(T,S,{throwOnError:!1,errorColor:"#f00"}),S.setAttribute("data-value",T)),S}},{key:"value",value:function(T){return T.getAttribute("data-value")}}]),p}(d.default);h.blotName="formula",h.className="ql-formula",h.tagName="SPAN";var m=function(x){b(p,x),o(p,null,[{key:"register",value:function(){u.default.register(h,!0)}}]);function p(){_(this,p);var w=y(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return w}return p}(l.default);r.FormulaBlot=h,r.default=m},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.CodeToken=r.CodeBlock=void 0;var o=function(){function T(S,O){for(var P=0;P<O.length;P++){var j=O[P];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(S,j.key,j)}}return function(S,O,P){return O&&T(S.prototype,O),P&&T(S,P),S}}(),a=function T(S,O,P){S===null&&(S=Function.prototype);var j=Object.getOwnPropertyDescriptor(S,O);if(j===void 0){var k=Object.getPrototypeOf(S);return k===null?void 0:T(k,O,P)}else{if("value"in j)return j.value;var E=j.get;return E===void 0?void 0:E.call(P)}},g=i(0),d=y(g),v=i(5),u=y(v),f=i(9),l=y(f),c=i(13),_=y(c);function y(T){return T&&T.__esModule?T:{default:T}}function b(T,S){if(!(T instanceof S))throw new TypeError("Cannot call a class as a function")}function h(T,S){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:T}function m(T,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);T.prototype=Object.create(S&&S.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(T,S):T.__proto__=S)}var x=function(T){m(S,T);function S(){return b(this,S),h(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return o(S,[{key:"replaceWith",value:function(P){this.domNode.textContent=this.domNode.textContent,this.attach(),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"replaceWith",this).call(this,P)}},{key:"highlight",value:function(P){var j=this.domNode.textContent;this.cachedText!==j&&((j.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=P(j),this.domNode.normalize(),this.attach()),this.cachedText=j)}}]),S}(_.default);x.className="ql-syntax";var p=new d.default.Attributor.Class("token","hljs",{scope:d.default.Scope.INLINE}),w=function(T){m(S,T),o(S,null,[{key:"register",value:function(){u.default.register(p,!0),u.default.register(x,!0)}}]);function S(O,P){b(this,S);var j=h(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,O,P));if(typeof j.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var k=null;return j.quill.on(u.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(k),k=setTimeout(function(){j.highlight(),k=null},j.options.interval)}),j.highlight(),j}return o(S,[{key:"highlight",value:function(){var P=this;if(!this.quill.selection.composing){this.quill.update(u.default.sources.USER);var j=this.quill.getSelection();this.quill.scroll.descendants(x).forEach(function(k){k.highlight(P.options.highlight)}),this.quill.update(u.default.sources.SILENT),j!=null&&this.quill.setSelection(j,u.default.sources.SILENT)}}}]),S}(l.default);w.DEFAULTS={highlight:function(){return window.hljs==null?null:function(T){var S=window.hljs.highlightAuto(T);return S.value}}(),interval:1e3},r.CodeBlock=x,r.CodeToken=p,r.default=w},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,r){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,r){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,r){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,r){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BubbleTooltip=void 0;var o=function S(O,P,j){O===null&&(O=Function.prototype);var k=Object.getOwnPropertyDescriptor(O,P);if(k===void 0){var E=Object.getPrototypeOf(O);return E===null?void 0:S(E,P,j)}else{if("value"in k)return k.value;var C=k.get;return C===void 0?void 0:C.call(j)}},a=function(){function S(O,P){for(var j=0;j<P.length;j++){var k=P[j];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(O,k.key,k)}}return function(O,P,j){return P&&S(O.prototype,P),j&&S(O,j),O}}(),g=i(3),d=b(g),v=i(8),u=b(v),f=i(43),l=b(f),c=i(15),_=i(41),y=b(_);function b(S){return S&&S.__esModule?S:{default:S}}function h(S,O){if(!(S instanceof O))throw new TypeError("Cannot call a class as a function")}function m(S,O){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:S}function x(S,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);S.prototype=Object.create(O&&O.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(S,O):S.__proto__=O)}var p=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],w=function(S){x(O,S);function O(P,j){h(this,O),j.modules.toolbar!=null&&j.modules.toolbar.container==null&&(j.modules.toolbar.container=p);var k=m(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,P,j));return k.quill.container.classList.add("ql-bubble"),k}return a(O,[{key:"extendToolbar",value:function(j){this.tooltip=new T(this.quill,this.options.bounds),this.tooltip.root.appendChild(j.container),this.buildButtons([].slice.call(j.container.querySelectorAll("button")),y.default),this.buildPickers([].slice.call(j.container.querySelectorAll("select")),y.default)}}]),O}(l.default);w.DEFAULTS=(0,d.default)(!0,{},l.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(O){O?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var T=function(S){x(O,S);function O(P,j){h(this,O);var k=m(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,P,j));return k.quill.on(u.default.events.EDITOR_CHANGE,function(E,C,L,M){if(E===u.default.events.SELECTION_CHANGE)if(C!=null&&C.length>0&&M===u.default.sources.USER){k.show(),k.root.style.left="0px",k.root.style.width="",k.root.style.width=k.root.offsetWidth+"px";var z=k.quill.getLines(C.index,C.length);if(z.length===1)k.position(k.quill.getBounds(C));else{var B=z[z.length-1],K=k.quill.getIndex(B),q=Math.min(B.length()-1,C.index+C.length-K),D=k.quill.getBounds(new c.Range(K,q));k.position(D)}}else document.activeElement!==k.textbox&&k.quill.hasFocus()&&k.hide()}),k}return a(O,[{key:"listen",value:function(){var j=this;o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){j.root.classList.remove("ql-editing")}),this.quill.on(u.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!j.root.classList.contains("ql-hidden")){var k=j.quill.getSelection();k!=null&&j.position(j.quill.getBounds(k))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(j){var k=o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"position",this).call(this,j),E=this.root.querySelector(".ql-tooltip-arrow");if(E.style.marginLeft="",k===0)return k;E.style.marginLeft=-1*k-E.offsetWidth/2+"px"}}]),O}(f.BaseTooltip);T.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),r.BubbleTooltip=T,r.default=w},function(t,r,i){t.exports=i(63)}]).default})})(_s);var tm=_s.exports,rm=Te&&Te.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),dn=Te&&Te.__assign||function(){return dn=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},dn.apply(this,arguments)},nm=Te&&Te.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var o=arguments[e],a=0,g=o.length;a<g;a++,i++)r[i]=o[a];return r},Tn=Te&&Te.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},ut=Tn(Q),im=Tn(_a),jr=Tn(em),fa=Tn(tm),om=function(n){rm(e,n);function e(t){var r=n.call(this,t)||this;r.dirtyProps=["modules","formats","bounds","theme","children"],r.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],r.state={generation:0},r.selection=null,r.onEditorChange=function(o,a,g,d){var v,u,f,l;o==="text-change"?(u=(v=r).onEditorChangeText)===null||u===void 0||u.call(v,r.editor.root.innerHTML,a,d,r.unprivilegedEditor):o==="selection-change"&&((l=(f=r).onEditorChangeSelection)===null||l===void 0||l.call(f,a,d,r.unprivilegedEditor))};var i=r.isControlled()?t.value:t.defaultValue;return r.value=i??"",r}return e.prototype.validateProps=function(t){var r;if(ut.default.Children.count(t.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(ut.default.Children.count(t.children)){var i=ut.default.Children.only(t.children);if(((r=i)===null||r===void 0?void 0:r.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&t.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},e.prototype.shouldComponentUpdate=function(t,r){var i=this,o;if(this.validateProps(t),!this.editor||this.state.generation!==r.generation)return!0;if("value"in t){var a=this.getEditorContents(),g=(o=t.value,o??"");this.isEqualValue(g,a)||this.setEditorContents(this.editor,g)}return t.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,t.readOnly),nm(this.cleanProps,this.dirtyProps).some(function(d){return!jr.default(t[d],i.props[d])})},e.prototype.shouldComponentRegenerate=function(t){var r=this;return this.dirtyProps.some(function(i){return!jr.default(t[i],r.props[i])})},e.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},e.prototype.componentWillUnmount=function(){this.destroyEditor()},e.prototype.componentDidUpdate=function(t,r){var i=this;if(this.editor&&this.shouldComponentRegenerate(t)){var o=this.editor.getContents(),a=this.editor.getSelection();this.regenerationSnapshot={delta:o,selection:a},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==r.generation){var g=this.regenerationSnapshot,o=g.delta,d=g.selection;delete this.regenerationSnapshot,this.instantiateEditor();var v=this.editor;v.setContents(o),da(function(){return i.setEditorSelection(v,d)})}},e.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},e.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},e.prototype.isControlled=function(){return"value"in this.props},e.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},e.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},e.prototype.createEditor=function(t,r){var i=new fa.default(t,r);return r.tabIndex!=null&&this.setEditorTabIndex(i,r.tabIndex),this.hookEditor(i),i},e.prototype.hookEditor=function(t){this.unprivilegedEditor=this.makeUnprivilegedEditor(t),t.on("editor-change",this.onEditorChange)},e.prototype.unhookEditor=function(t){t.off("editor-change",this.onEditorChange)},e.prototype.getEditorContents=function(){return this.value},e.prototype.getEditorSelection=function(){return this.selection},e.prototype.isDelta=function(t){return t&&t.ops},e.prototype.isEqualValue=function(t,r){return this.isDelta(t)&&this.isDelta(r)?jr.default(t.ops,r.ops):jr.default(t,r)},e.prototype.setEditorContents=function(t,r){var i=this;this.value=r;var o=this.getEditorSelection();typeof r=="string"?t.setContents(t.clipboard.convert(r)):t.setContents(r),da(function(){return i.setEditorSelection(t,o)})},e.prototype.setEditorSelection=function(t,r){if(this.selection=r,r){var i=t.getLength();r.index=Math.max(0,Math.min(r.index,i-1)),r.length=Math.max(0,Math.min(r.length,i-1-r.index)),t.setSelection(r)}},e.prototype.setEditorTabIndex=function(t,r){var i,o;!((o=(i=t)===null||i===void 0?void 0:i.scroll)===null||o===void 0)&&o.domNode&&(t.scroll.domNode.tabIndex=r)},e.prototype.setEditorReadOnly=function(t,r){r?t.disable():t.enable()},e.prototype.makeUnprivilegedEditor=function(t){var r=t;return{getHTML:function(){return r.root.innerHTML},getLength:r.getLength.bind(r),getText:r.getText.bind(r),getContents:r.getContents.bind(r),getSelection:r.getSelection.bind(r),getBounds:r.getBounds.bind(r)}},e.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var t=im.default.findDOMNode(this.editingArea);if(!t)throw new Error("Cannot find element for editing area");if(t.nodeType===3)throw new Error("Editing area cannot be a text node");return t},e.prototype.renderEditingArea=function(){var t=this,r=this.props,i=r.children,o=r.preserveWhitespace,a=this.state.generation,g={key:a,ref:function(d){t.editingArea=d}};return ut.default.Children.count(i)?ut.default.cloneElement(ut.default.Children.only(i),g):o?ut.default.createElement("pre",dn({},g)):ut.default.createElement("div",dn({},g))},e.prototype.render=function(){var t;return ut.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(t=this.props.className,t??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},e.prototype.onEditorChangeText=function(t,r,i,o){var a,g;if(this.editor){var d=this.isDelta(this.value)?o.getContents():o.getHTML();d!==this.getEditorContents()&&(this.lastDeltaChangeSet=r,this.value=d,(g=(a=this.props).onChange)===null||g===void 0||g.call(a,t,r,i,o))}},e.prototype.onEditorChangeSelection=function(t,r,i){var o,a,g,d,v,u;if(this.editor){var f=this.getEditorSelection(),l=!f&&t,c=f&&!t;jr.default(t,f)||(this.selection=t,(a=(o=this.props).onChangeSelection)===null||a===void 0||a.call(o,t,r,i),l?(d=(g=this.props).onFocus)===null||d===void 0||d.call(g,t,r,i):c&&((u=(v=this.props).onBlur)===null||u===void 0||u.call(v,f,r,i)))}},e.prototype.focus=function(){this.editor&&this.editor.focus()},e.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},e.displayName="React Quill",e.Quill=fa.default,e.defaultProps={theme:"snow",modules:{},readOnly:!1},e}(ut.default.Component);function da(n){Promise.resolve().then(n)}var am=om;const sm=Fs(am),lm={toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{color:[]},{background:[]}],[{align:[]}],["blockquote","code-block"],["link","image","video"],["clean"]]},cm=["header","bold","italic","underline","strike","list","bullet","indent","link","image","video","direction","align","color","background","code-block","blockquote","script"],um=({bookId:n})=>{const[e,t]=Q.useState(null),[r,i]=Q.useState("core"),[o,a]=Q.useState(""),[g,d]=Q.useState(""),[v,u]=Q.useState(!0),[f,l]=Q.useState(!1),[c,_]=Q.useState(!1),y=mt(),b=ae("white","gray.700"),h=ae("gray.200","gray.600");Q.useEffect(()=>{n&&(async()=>{try{u(!0);const{data:P,error:j}=await le.from("Books").select("*").eq("id",n).single();if(j)throw j;if(!P)throw new Error("Book not found");t(P),await m(r)}catch(P){console.error("Error fetching data:",P),y({title:"Error fetching data",description:P.message,status:"error",duration:5e3,isClosable:!0})}finally{u(!1)}})()},[n,y]),Q.useEffect(()=>{n&&!v&&m(r)},[r]);const m=async O=>{try{u(!0);const{data:P,error:j}=await le.from("Content").select("*").eq("book_id",n).eq("type",O).single();if(j&&j.code!=="PGRST116")throw j;P?(a(P.content||""),d(P.content||"")):(a(""),d(""))}catch(P){console.error("Error fetching content:",P),y({title:"Error fetching content",description:P.message,status:"error",duration:5e3,isClosable:!0})}finally{u(!1)}},x=O=>{a(O)},p=O=>{i(O.target.value)},w=async()=>{try{l(!0);const{data:O,error:P}=await le.from("Content").upsert({book_id:n,type:r,content:o,is_html:!0,last_updated:new Date().toISOString()},{onConflict:"book_id,type"});if(P)throw P;d(o),y({title:"Content saved",description:"The content has been saved successfully.",status:"success",duration:3e3,isClosable:!0})}catch(O){console.error("Error saving content:",O),y({title:"Error saving content",description:O.message,status:"error",duration:5e3,isClosable:!0})}finally{l(!1)}},T=()=>{a(g),y({title:"Changes discarded",status:"info",duration:2e3,isClosable:!0})},S=o!==g;return s.jsx(ne,{p:4,children:s.jsxs(we,{spacing:6,align:"stretch",children:[s.jsx(ke,{size:"lg",children:v?"Loading...":`Edit Content: ${(e==null?void 0:e.title)||"Unknown Book"}`}),s.jsxs($e,{children:[s.jsx(qe,{children:"Content Type"}),s.jsxs(Si,{value:r,onChange:p,isDisabled:v||f,children:[s.jsx("option",{value:"core",children:"Core Concepts"}),s.jsx("option",{value:"deep_dive",children:"Deep Dive"})]})]}),s.jsxs(Zn,{isFitted:!0,variant:"enclosed",onChange:O=>_(O===1),children:[s.jsxs(Xn,{mb:"1em",children:[s.jsx(Qt,{children:"Editor"}),s.jsx(Qt,{children:"Preview"})]}),s.jsxs(Qn,{children:[s.jsx(er,{p:0,children:s.jsx(ne,{borderWidth:"1px",borderRadius:"lg",borderColor:h,overflow:"hidden",bg:b,children:s.jsx(sm,{theme:"snow",value:o,onChange:x,modules:lm,formats:cm,style:{height:"500px",backgroundColor:ae("white","gray.700")}})})}),s.jsx(er,{p:0,children:s.jsx(ne,{borderWidth:"1px",borderRadius:"lg",borderColor:h,overflow:"auto",bg:b,p:4,height:"500px",className:"html-content",sx:{"h1, h2, h3, h4, h5, h6":{fontWeight:"bold",lineHeight:1.2,mt:4,mb:2},h1:{fontSize:"2xl",mt:6,mb:4},h2:{fontSize:"xl",mt:5,mb:3},h3:{fontSize:"lg"},p:{mb:4,lineHeight:1.7},ul:{pl:6,mb:4},ol:{pl:6,mb:4},li:{mb:2},a:{color:"blue.500",textDecoration:"underline"},blockquote:{borderLeftWidth:"4px",borderLeftColor:"gray.300",pl:4,py:1,my:4,fontStyle:"italic"},img:{maxWidth:"100%",height:"auto",borderRadius:"md",my:4},table:{width:"100%",borderCollapse:"collapse",my:4},"th, td":{borderWidth:"1px",borderColor:"gray.200",p:2},th:{bg:"gray.50",fontWeight:"bold"},pre:{bg:"gray.50",p:4,borderRadius:"md",overflowX:"auto",my:4},code:{fontFamily:"monospace",bg:"gray.100",p:1,borderRadius:"sm"}},dangerouslySetInnerHTML:{__html:o}})})]})]}),s.jsx(Pt,{}),s.jsxs(ve,{spacing:4,justify:"flex-end",children:[S&&s.jsx(oe,{color:"orange.500",fontWeight:"medium",children:"You have unsaved changes"}),s.jsx(be,{colorScheme:"gray",onClick:T,isDisabled:!S||f,children:"Discard Changes"}),s.jsx(be,{colorScheme:"blue",onClick:w,isLoading:f,isDisabled:!S||v,loadingText:"Saving",children:"Save Changes"})]})]})})},fm=()=>{const[n,e]=Q.useState([]),[t,r]=Q.useState([]),[i,o]=Q.useState(!0),[a,g]=Q.useState(null),[d,v]=Q.useState(""),[u,f]=Q.useState(""),[l,c]=Q.useState([]),[_,y]=Q.useState(null),{isOpen:b,onOpen:h,onClose:m}=ei(),x=ae("white","gray.700"),p=ae("gray.200","gray.600");Q.useEffect(()=>{(async()=>{try{o(!0);const{data:P,error:j}=await le.from("Categories").select("*").order("display_order",{ascending:!0});if(j)throw j;const{data:k,error:E}=await le.from("Books").select(`
            *,
            category:Categories (
              id,
              name
            )
          `).order("display_order",{ascending:!0});if(E)throw E;c(P),e(k),r(k)}catch(P){console.error("Error fetching data:",P),g(P.message)}finally{o(!1)}})()},[]),Q.useEffect(()=>{if(n.length>0){let O=[...n];if(u&&(O=O.filter(P=>P.category&&P.category.id===u)),d.trim()){const P=d.toLowerCase();O=O.filter(j=>j.title.toLowerCase().includes(P))}r(O)}},[d,u,n]);const w=O=>{v(O.target.value)},T=O=>{f(O.target.value)},S=O=>{y(O),h()};return i?s.jsx(Me,{justify:"center",align:"center",minH:"300px",children:s.jsx($t,{size:"xl"})}):a?s.jsxs(tt,{status:"error",borderRadius:"md",children:[s.jsx(rt,{}),a]}):s.jsxs(Le,{maxW:"container.xl",py:8,children:[s.jsx(ke,{mb:6,children:"Content Manager"}),s.jsx(oe,{mb:6,color:"gray.500",children:"Manage book content and edit HTML content for each book."}),s.jsxs(ve,{mb:6,spacing:4,children:[s.jsxs(Tt,{maxW:"400px",children:[s.jsx(Tr,{pointerEvents:"none",children:s.jsx(Sf,{color:"gray.300"})}),s.jsx(Xe,{placeholder:"Search books...",value:d,onChange:w})]}),s.jsx(Si,{placeholder:"All Categories",value:u,onChange:T,maxW:"250px",children:l.map(O=>s.jsx("option",{value:O.id,children:O.name},O.id))})]}),t.length===0?s.jsxs(tt,{status:"info",borderRadius:"md",children:[s.jsx(rt,{}),"No books found matching your criteria."]}):s.jsx(Ct,{columns:{base:1,md:2,lg:3},spacing:6,children:t.map(O=>s.jsxs(Zr,{bg:x,borderColor:p,borderWidth:"1px",overflow:"hidden",children:[s.jsx(Ls,{pb:0,children:s.jsxs(Me,{justify:"space-between",align:"flex-start",children:[s.jsx(ke,{size:"md",noOfLines:2,children:O.title}),O.category&&s.jsx(dt,{colorScheme:"blue",ml:2,children:O.category.name})]})}),s.jsx(Qr,{children:s.jsxs(Me,{direction:{base:"column",sm:"row"},align:"center",gap:4,children:[s.jsx(Ot,{src:O.cover_image||"https://via.placeholder.com/150x225?text=No+Cover",alt:O.title,borderRadius:"md",objectFit:"cover",maxW:{base:"100%",sm:"100px"},height:{base:"auto",sm:"150px"}}),s.jsx(rr,{flex:1,children:s.jsx(oe,{noOfLines:3,fontSize:"sm",color:"gray.500",children:O.description||"No description available."})})]})}),s.jsx(Pt,{}),s.jsx(Rs,{children:s.jsx(be,{colorScheme:"blue",width:"full",onClick:()=>S(O),children:"Edit Content"})})]},O.id))}),s.jsxs(ti,{isOpen:b,onClose:m,size:"5xl",children:[s.jsx(ri,{}),s.jsxs(ni,{maxW:"90vw",children:[s.jsxs(ii,{children:["Edit Content",s.jsx(oi,{})]}),s.jsx(ai,{pb:6,children:_&&s.jsx(um,{bookId:_.id})})]})]})]})},dm=()=>{const n=[{label:"Total Users",value:1254,change:12.5,increase:!0},{label:"Active Readers",value:876,change:8.2,increase:!0},{label:"Books Viewed",value:3421,change:23.1,increase:!0},{label:"Avg. Time Spent",value:"5m 32s",change:2.4,increase:!1}];return s.jsx(Le,{maxW:"container.xl",children:s.jsxs(ne,{p:6,borderWidth:"1px",borderRadius:"lg",bg:"white",children:[s.jsx(ke,{as:"h1",size:"xl",mb:4,children:"Analytics Dashboard"}),s.jsx(oe,{mb:6,children:"Overview of user engagement and content performance."}),s.jsx(Ct,{columns:{base:1,md:2,lg:4},spacing:6,mb:8,children:n.map((e,t)=>s.jsx(ne,{p:5,shadow:"md",borderWidth:"1px",borderRadius:"md",children:s.jsxs(jt,{children:[s.jsx(St,{fontSize:"md",children:e.label}),s.jsx(At,{fontSize:"2xl",children:e.value}),s.jsxs(ya,{children:[s.jsx(ma,{type:e.increase?"increase":"decrease"}),e.change,"%"]})]})},t))}),s.jsxs(ne,{p:5,shadow:"md",borderWidth:"1px",borderRadius:"md",children:[s.jsx(ke,{as:"h3",size:"md",mb:4,children:"Future Implementation"}),s.jsx(oe,{children:"This section will include detailed charts and metrics for content performance, user engagement patterns, and conversion analytics."})]})]})})},ha=({onUploadComplete:n,currentImageUrl:e=null})=>{const t=Q.useRef(),[r,i]=Q.useState(e),[o,a]=Q.useState(!1),[g,d]=Q.useState(!1),[v,u]=Q.useState(0),[f,l]=Q.useState(null);mt();const c=ae("gray.50","gray.700"),_=ae("gray.200","gray.600"),y=async h=>{const m=h.target.files[0];if(!m)return;const x=new FileReader;x.onloadend=()=>{i(x.result)},x.readAsDataURL(m),a(!0);try{await n(m)}catch(p){console.error("Error uploading image:",p)}finally{a(!1)}},b=()=>{i(null),t.current&&(t.current.value="")};return s.jsxs(we,{spacing:4,width:"100%",children:[f&&s.jsxs(tt,{status:"error",borderRadius:"md",children:[s.jsx(rt,{}),f]}),s.jsx(Xe,{type:"file",accept:"image/*",onChange:y,ref:t,display:"none"}),r?s.jsxs(ne,{position:"relative",width:"100%",children:[s.jsx(Ot,{src:r,alt:"Preview",objectFit:"cover",width:"100%",height:"200px",borderRadius:"md"}),s.jsx(be,{position:"absolute",top:2,right:2,size:"sm",colorScheme:"red",onClick:b,leftIcon:s.jsx(ze,{as:Lr}),children:"Remove"})]}):s.jsx(ne,{width:"100%",height:"200px",border:"2px dashed",borderColor:_,borderRadius:"md",display:"flex",alignItems:"center",justifyContent:"center",bg:c,cursor:"pointer",onClick:()=>{var h;return(h=t.current)==null?void 0:h.click()},children:s.jsxs(we,{spacing:2,children:[s.jsx(ze,{as:Ao,boxSize:6}),s.jsx(oe,{children:"Click to upload image"})]})}),!r&&s.jsx(be,{onClick:()=>{var h;return(h=t.current)==null?void 0:h.click()},leftIcon:s.jsx(ze,{as:Ao}),isLoading:o,children:"Upload Image"}),g&&s.jsx(ji,{width:"100%",value:v,size:"sm",colorScheme:"blue",hasStripe:!0,isAnimated:!0})]})},pa=st(ne),hm=()=>{var z;const[n,e]=Q.useState([]),[t,r]=Q.useState([]),[i,o]=Q.useState(!1),[a,g]=Q.useState(null),[d,v]=Q.useState({name:"",display_order:1,status:!0,image_url:""}),u=mt(),{isOpen:f,onOpen:l,onClose:c}=ei(),{isOpen:_,onOpen:y,onClose:b}=ei(),[h,m]=Q.useState(!1),[x,p]=Q.useState({title:"",cover_image:"",category_id:"",display_order:1,status:!0,core_content:"",deep_dive_content:""});ae("white","gray.700"),ae("gray.200","gray.600");const w=ae("gray.50","gray.600"),T=ae("gray.50","gray.800");Q.useEffect(()=>{S(),O()},[]);const S=async()=>{try{const{data:B,error:K}=await le.from("Books").select(`
          *,
          Categories (
            name
          )
        `).order("display_order");if(K)throw K;if(B&&B.length>0){const q=B.map(I=>I.id),{data:D,error:A}=await le.from("Content").select("*").in("book_id",q);if(A)throw A;const N=B.map(I=>{var U,R;const H=D.filter($=>$.book_id===I.id);return{...I,core_content:((U=H.find($=>$.type==="core"))==null?void 0:U.content)||"",deep_dive_content:((R=H.find($=>$.type==="deep_dive"))==null?void 0:R.content)||""}});e(N)}else e([])}catch(B){console.error("Error fetching books:",B),u({title:"Error fetching books",description:B.message,status:"error",duration:3e3,isClosable:!0})}},O=async()=>{try{const{data:B,error:K}=await le.from("Categories").select("*").order("name");if(K)throw K;r(B||[])}catch(B){console.error("Error fetching categories:",B)}},P=B=>{const{name:K,value:q}=B.target;p(D=>({...D,[K]:q}))},j=async B=>{B.preventDefault(),o(!0);try{const{data:K,error:q}=await le.from("Books").select("display_order").order("display_order",{ascending:!1}).limit(1);if(q)throw q;const D=K&&K.length>0?K[0].display_order+1:1,{data:A,error:N}=await le.from("Books").insert([{title:x.title,cover_image:x.cover_image,category_id:x.category_id,display_order:D,status:!0}]).select().single();if(N)throw N;const I=[];if(x.core_content&&I.push({book_id:A.id,type:"core",content:x.core_content}),x.deep_dive_content&&I.push({book_id:A.id,type:"deep_dive",content:x.deep_dive_content}),I.length>0){const{error:H}=await le.from("Content").insert(I);if(H)throw H}u({title:"Book added successfully",status:"success",duration:3e3,isClosable:!0}),p({title:"",cover_image:"",category_id:"",display_order:1,status:!0,core_content:"",deep_dive_content:""}),S()}catch(K){console.error("Error adding book:",K),u({title:"Error adding book",description:K.message,status:"error",duration:3e3,isClosable:!0})}finally{o(!1)}},k=async B=>{if(window.confirm("Are you sure you want to delete this book?"))try{const{error:K}=await le.from("Content").delete().eq("book_id",B);if(K)throw K;const{error:q}=await le.from("Books").delete().eq("id",B);if(q)throw q;u({title:"Book deleted successfully",status:"success",duration:3e3,isClosable:!0}),S()}catch(K){console.error("Error deleting book:",K),u({title:"Error deleting book",description:K.message,status:"error",duration:3e3,isClosable:!0})}},E=B=>{g(B),l()},C=async()=>{try{const{data:B}=await le.from("Categories").select("display_order").order("display_order",{ascending:!1}).limit(1),K=B&&B.length>0?B[0].display_order+1:1,{data:q,error:D}=await le.from("Categories").insert([{name:d.name,display_order:K,status:!0,image_url:d.image_url,click_count:0}]).select().single();if(D)throw D;u({title:"Category added",description:`${q.name} has been added successfully`,status:"success",duration:3e3,isClosable:!0}),r([...t,q]),v({name:"",display_order:1,status:!0,image_url:""}),b()}catch(B){console.error("Error adding category:",B),u({title:"Error adding category",description:B.message,status:"error",duration:3e3,isClosable:!0})}},L=B=>{p(K=>({...K,cover_image:B}))},M=async B=>{try{const{data:K,error:q}=await le.storage.from("category-images").upload(`categories/${B.name}`,B);if(q)throw q;const D=`${supabaseUrl}/storage/v1/object/public/category-images/${K.path}`;v(A=>({...A,image_url:D}))}catch(K){console.error("Error uploading category image:",K),u({title:"Error uploading image",description:K.message,status:"error",duration:3e3,isClosable:!0})}};return s.jsxs(Le,{maxW:"container.xl",py:8,children:[s.jsxs(we,{spacing:8,align:"stretch",children:[s.jsx(pa,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:s.jsx(Zr,{children:s.jsx(Qr,{children:s.jsxs(we,{spacing:6,children:[s.jsxs(ve,{width:"full",justify:"space-between",children:[s.jsx(ke,{size:"lg",children:s.jsxs(ve,{children:[s.jsx(nn,{}),s.jsx(oe,{children:"Add New Book"})]})}),s.jsx(be,{size:"sm",variant:"ghost",onClick:()=>m(!h),leftIcon:h?s.jsx(ko,{}):s.jsx(qt,{}),children:h?"Show Code":"Preview"})]}),s.jsxs("form",{onSubmit:j,style:{width:"100%"},children:[s.jsxs(Ns,{templateColumns:"repeat(12, 1fr)",gap:6,children:[s.jsx(Nn,{colSpan:{base:12,md:8},children:s.jsxs(we,{spacing:6,align:"stretch",children:[s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:s.jsxs(ve,{children:[s.jsx(ht,{}),s.jsx(oe,{children:"Title"})]})}),s.jsx(Xe,{name:"title",value:x.title,onChange:P,placeholder:"Enter book title"})]}),s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:s.jsxs(ve,{children:[s.jsx(Oo,{}),s.jsx(oe,{children:"Cover Image"})]})}),s.jsx(ha,{onUploadComplete:L,currentImageUrl:x.cover_image})]}),s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:s.jsxs(ve,{children:[s.jsx(qn,{}),s.jsx(oe,{children:"Category"})]})}),s.jsxs(ve,{children:[s.jsx(Si,{name:"category_id",value:x.category_id,onChange:P,placeholder:"Select category",children:t.map(B=>s.jsx("option",{value:B.id,children:B.name},B.id))}),s.jsx(Bt,{label:"Add new category",children:s.jsx(Ge,{icon:s.jsx(Eo,{}),"aria-label":"Add new category",colorScheme:"green",onClick:y})})]})]})]})}),s.jsx(Nn,{colSpan:{base:12,md:4},children:x.cover_image&&s.jsxs(ne,{borderWidth:"1px",borderRadius:"lg",overflow:"hidden",position:"relative",children:[s.jsx(Ot,{src:x.cover_image,alt:"Cover preview",width:"full",height:"300px",objectFit:"cover",fallbackSrc:"https://via.placeholder.com/300"}),s.jsxs(Wt,{position:"absolute",top:2,right:2,colorScheme:"blue",children:[s.jsx(Gt,{as:Oo}),s.jsx(Kt,{children:"Preview"})]})]})}),s.jsx(Nn,{colSpan:12,children:s.jsxs(Zn,{variant:"enclosed",colorScheme:"blue",children:[s.jsxs(Xn,{children:[s.jsx(Qt,{children:s.jsxs(ve,{children:[s.jsx(ko,{}),s.jsx(oe,{children:"Core Content"}),x.core_content&&s.jsx(br,{color:"green"})]})}),s.jsx(Qt,{children:s.jsxs(ve,{children:[s.jsx(Lu,{}),s.jsx(oe,{children:"Deep Dive Content"}),x.deep_dive_content&&s.jsx(br,{color:"green"})]})})]}),s.jsxs(Qn,{children:[s.jsx(er,{children:s.jsx(we,{spacing:4,children:s.jsxs($e,{isRequired:!0,children:[s.jsx(ve,{justify:"space-between",mb:2,children:s.jsx(qe,{margin:0,children:s.jsxs(ve,{children:[s.jsx(oe,{children:"Core HTML Content"}),s.jsx(Bt,{label:"Main summary and key points of the book",children:s.jsx(ne,{children:s.jsx(jo,{})})})]})})}),s.jsxs(ne,{position:"relative",children:[s.jsx(Qi,{name:"core_content",value:x.core_content,onChange:P,placeholder:"Paste your HTML content here",rows:12,fontFamily:"mono",bg:T}),h&&x.core_content&&s.jsx(ne,{mt:4,p:4,borderWidth:"1px",borderRadius:"md",dangerouslySetInnerHTML:{__html:Ar.sanitize(x.core_content)}})]})]})})}),s.jsx(er,{children:s.jsx(we,{spacing:4,children:s.jsxs($e,{isRequired:!0,children:[s.jsx(ve,{justify:"space-between",mb:2,children:s.jsx(qe,{margin:0,children:s.jsxs(ve,{children:[s.jsx(oe,{children:"Deep Dive HTML Content"}),s.jsx(Bt,{label:"Detailed analysis and extended content",children:s.jsx(ne,{children:s.jsx(jo,{})})})]})})}),s.jsxs(ne,{position:"relative",children:[s.jsx(Qi,{name:"deep_dive_content",value:x.deep_dive_content,onChange:P,placeholder:"Paste your HTML content here",rows:12,fontFamily:"mono",bg:T}),h&&x.deep_dive_content&&s.jsx(ne,{mt:4,p:4,borderWidth:"1px",borderRadius:"md",dangerouslySetInnerHTML:{__html:Ar.sanitize(x.deep_dive_content)}})]})]})})})]})]})})]}),s.jsx(Pt,{my:6}),s.jsx(be,{type:"submit",colorScheme:"blue",isLoading:i,leftIcon:s.jsx(So,{}),width:"full",size:"lg",children:"Add Book"})]})]})})})}),s.jsx(pa,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:s.jsx(Zr,{children:s.jsx(Qr,{children:s.jsxs(we,{spacing:6,align:"stretch",children:[s.jsx(ke,{size:"lg",children:s.jsxs(ve,{children:[s.jsx(ht,{}),s.jsx(oe,{children:"Books List"})]})}),s.jsxs(Is,{variant:"simple",children:[s.jsx(Ds,{children:s.jsxs(eo,{children:[s.jsx(vr,{children:"Book"}),s.jsx(vr,{children:"Category"}),s.jsx(vr,{children:"Status"}),s.jsx(vr,{children:"Content Status"}),s.jsx(vr,{children:"Actions"})]})}),s.jsx(Ms,{children:n.map(B=>{var K;return s.jsxs(eo,{_hover:{bg:w},children:[s.jsx(yr,{children:s.jsxs(ve,{spacing:4,children:[s.jsx(Ot,{src:B.cover_image||"https://via.placeholder.com/50",alt:B.title,boxSize:"50px",objectFit:"cover",borderRadius:"md"}),s.jsx(oe,{fontWeight:"medium",children:B.title})]})}),s.jsx(yr,{children:s.jsxs(Wt,{colorScheme:"blue",size:"md",children:[s.jsx(Gt,{as:qn}),s.jsx(Kt,{children:(K=B.Categories)==null?void 0:K.name})]})}),s.jsx(yr,{children:s.jsxs(Wt,{colorScheme:B.status?"green":"red",size:"sm",children:[s.jsx(Gt,{as:B.status?br:Lr}),s.jsx(Kt,{children:B.status?"Active":"Inactive"})]})}),s.jsx(yr,{children:s.jsxs(ve,{spacing:2,children:[s.jsxs(Wt,{colorScheme:B.core_content?"green":"red",size:"sm",children:[s.jsx(Gt,{as:B.core_content?br:Lr}),s.jsx(Kt,{children:"Core"})]}),s.jsxs(Wt,{colorScheme:B.deep_dive_content?"green":"red",size:"sm",children:[s.jsx(Gt,{as:B.deep_dive_content?br:Lr}),s.jsx(Kt,{children:"Deep Dive"})]})]})}),s.jsx(yr,{children:s.jsxs(ve,{spacing:2,children:[s.jsx(Ge,{icon:s.jsx(qt,{}),"aria-label":"Preview book",size:"sm",colorScheme:"green",onClick:()=>E(B)}),s.jsx(Ge,{icon:s.jsx(Au,{}),"aria-label":"Edit book",size:"sm",colorScheme:"blue"}),s.jsx(Ge,{icon:s.jsx(Iu,{}),"aria-label":"Delete book",size:"sm",colorScheme:"red",onClick:()=>k(B.id)})]})})]},B.id)})})]})]})})})})]}),s.jsxs(ti,{isOpen:f,onClose:c,size:"xl",children:[s.jsx(ri,{}),s.jsxs(ni,{children:[s.jsx(ii,{children:s.jsxs(ve,{children:[s.jsx(nn,{}),s.jsx(oe,{children:a==null?void 0:a.title})]})}),s.jsx(oi,{}),s.jsx(ai,{pb:6,children:s.jsxs(we,{spacing:4,align:"stretch",children:[(a==null?void 0:a.cover_image)&&s.jsx(Ot,{src:a.cover_image,alt:a.title,maxH:"300px",objectFit:"contain",borderRadius:"md",mx:"auto"}),s.jsxs(ne,{children:[s.jsx(ke,{size:"sm",mb:2,children:"Category"}),s.jsxs(Wt,{colorScheme:"blue",children:[s.jsx(Gt,{as:qn}),s.jsx(Kt,{children:(z=a==null?void 0:a.Categories)==null?void 0:z.name})]})]}),s.jsxs(Zn,{children:[s.jsxs(Xn,{children:[s.jsx(Qt,{children:"Core Content"}),s.jsx(Qt,{children:"Deep Dive"})]}),s.jsxs(Qn,{children:[s.jsx(er,{children:a!=null&&a.core_content?s.jsx(ne,{p:4,borderWidth:"1px",borderRadius:"md",dangerouslySetInnerHTML:{__html:Ar.sanitize(a.core_content)}}):s.jsx(oe,{color:"gray.500",children:"No core content available"})}),s.jsx(er,{children:a!=null&&a.deep_dive_content?s.jsx(ne,{p:4,borderWidth:"1px",borderRadius:"md",dangerouslySetInnerHTML:{__html:Ar.sanitize(a.deep_dive_content)}}):s.jsx(oe,{color:"gray.500",children:"No deep dive content available"})})]})]})]})})]})]}),s.jsxs(ti,{isOpen:_,onClose:b,children:[s.jsx(ri,{}),s.jsxs(ni,{children:[s.jsx(ii,{children:s.jsxs(ve,{children:[s.jsx(Eo,{}),s.jsx(oe,{children:"Add New Category"})]})}),s.jsx(oi,{}),s.jsxs("form",{onSubmit:C,children:[s.jsx(ai,{pb:6,children:s.jsxs(we,{spacing:4,children:[s.jsxs($e,{isRequired:!0,children:[s.jsx(qe,{children:"Category Name"}),s.jsx(Xe,{placeholder:"Enter category name",value:d.name,onChange:B=>v(K=>({...K,name:B.target.value}))})]}),s.jsxs($e,{children:[s.jsx(qe,{children:"Category Image"}),s.jsx(ha,{onUploadComplete:M,currentImageUrl:d.image_url})]})]})}),s.jsx(Bs,{children:s.jsxs($s,{spacing:3,children:[s.jsx(be,{colorScheme:"blue",type:"submit",leftIcon:s.jsx(So,{}),children:"Add Category"}),s.jsx(be,{onClick:b,children:"Cancel"})]})})]})]})]})]})},pm=()=>s.jsxs(ne,{textAlign:"center",py:20,px:6,children:[s.jsx(ke,{size:"2xl",mb:2,children:"404"}),s.jsx(oe,{fontSize:"xl",mb:4,children:"Page Not Found"}),s.jsx(be,{as:Ae,to:"/",colorScheme:"blue",children:"Return Home"})]}),gm=()=>{var f,l;const{colorMode:n,toggleColorMode:e}=Oi(),[t,r]=Q.useState(null),[i,o]=Q.useState(null),a=gn(),g=ae("white","gray.800"),d=ae("gray.200","gray.700"),v=a.pathname.startsWith("/admin");Q.useEffect(()=>{le.auth.getSession().then(async({data:{session:_}})=>{var y;if(r(_),(y=_==null?void 0:_.user)!=null&&y.id){const{data:b,error:h}=await le.from("profiles").select("role").eq("id",_.user.id).single();!h&&b&&o(b.role)}});const{data:{subscription:c}}=le.auth.onAuthStateChange(async(_,y)=>{var b;if(r(y),(b=y==null?void 0:y.user)!=null&&b.id){const{data:h,error:m}=await le.from("profiles").select("role").eq("id",y.user.id).single();!m&&h&&o(h.role)}else o(null)});return()=>c.unsubscribe()},[]);const u=async()=>{try{const{error:c}=await le.auth.signOut();if(c)throw c;window.location.href=i==="admin"?"/admin/login":"/login"}catch(c){console.error("Error signing out:",c)}};return a.pathname==="/login"||a.pathname==="/admin/login"?null:v?i!=="admin"?null:s.jsx(ne,{position:"sticky",top:0,zIndex:"sticky",bg:g,borderBottom:"1px",borderColor:d,children:s.jsx(Le,{maxW:"container.xl",children:s.jsxs(Me,{h:16,alignItems:"center",justifyContent:"space-between",children:[s.jsx(be,{as:Ae,to:"/admin",variant:"ghost",fontSize:"xl",fontWeight:"bold",_hover:{textDecoration:"none"},children:"BookShorts Admin"}),s.jsxs(rr,{direction:"row",spacing:4,alignItems:"center",children:[s.jsx(Ge,{icon:n==="light"?s.jsx(an,{}):s.jsx(ln,{}),onClick:e,variant:"ghost","aria-label":"Toggle color mode"}),s.jsxs(to,{children:[s.jsx(ro,{children:s.jsx(Xr,{size:"sm",name:(f=t==null?void 0:t.user)==null?void 0:f.email})}),s.jsxs(no,{children:[s.jsx(Vt,{icon:s.jsx(yi,{}),children:"Admin Profile"}),s.jsx(Vt,{as:Ae,to:"/admin/books",icon:s.jsx(Ni,{}),children:"Manage Books"}),s.jsx(io,{}),s.jsx(Vt,{onClick:u,icon:s.jsx(on,{}),color:"red.400",children:"Sign Out"})]})]})]})]})})}):s.jsx(ne,{position:"sticky",top:0,zIndex:"sticky",bg:g,borderBottom:"1px",borderColor:d,children:s.jsx(Le,{maxW:"container.xl",children:s.jsxs(Me,{h:16,alignItems:"center",justifyContent:"space-between",children:[s.jsx(be,{as:Ae,to:"/",variant:"ghost",fontSize:"xl",fontWeight:"bold",_hover:{textDecoration:"none"},children:"BookShorts"}),s.jsxs(rr,{direction:"row",spacing:4,alignItems:"center",children:[s.jsx(Ge,{icon:n==="light"?s.jsx(an,{}):s.jsx(ln,{}),onClick:e,variant:"ghost","aria-label":"Toggle color mode"}),t?s.jsxs(to,{children:[s.jsx(ro,{children:s.jsx(Xr,{size:"sm",name:t.user.email,src:(l=t.user.user_metadata)==null?void 0:l.avatar_url})}),s.jsxs(no,{children:[s.jsx(Vt,{as:Ae,to:"/profile",icon:s.jsx(yi,{}),children:"Profile"}),s.jsx(Vt,{as:Ae,to:"/bookmarks",icon:s.jsx(or,{}),children:"Bookmarks"}),s.jsx(io,{}),s.jsx(Vt,{onClick:u,icon:s.jsx(on,{}),color:"red.400",children:"Sign Out"})]})]}):s.jsx(be,{as:Ae,to:"/login",colorScheme:"brand",children:"Sign In"})]})]})})})},vm=()=>{const[n,e]=Q.useState(""),[t,r]=Q.useState(""),[i,o]=Q.useState(""),[a,g]=Q.useState(!1),[d,v]=Q.useState(""),[u,f]=Q.useState(!1),l=pn(),c=gn(),{user:_}=Lt(),y=mt(),b=ae("white","gray.800"),h=ae("gray.200","gray.700"),m=ae("brand.500","brand.300");Q.useEffect(()=>{var w;if(_){const T=((w=c.state)==null?void 0:w.from)||"/profile";l(T,{replace:!0})}},[_,l,c.state]);const x=async w=>{var T;w.preventDefault();try{if(g(!0),v(""),u){const{data:S,error:O}=await le.auth.signUp({email:n,password:t,options:{data:{full_name:i}}});if(O)throw O;if(y({title:"Account created!",description:"Please check your email to confirm your account.",status:"success",duration:5e3,isClosable:!0,position:"top-right"}),S!=null&&S.user){const{error:P}=await le.from("profiles").upsert({id:S.user.id,email:S.user.email,full_name:i,role:"user",created_at:new Date});P&&console.error("Error creating profile:",P)}f(!1)}else{const{data:S,error:O}=await le.auth.signInWithPassword({email:n,password:t});if(O)throw O;if(S!=null&&S.user){y({title:"Welcome back!",status:"success",duration:3e3,isClosable:!0,position:"top-right"});const P=((T=c.state)==null?void 0:T.from)||"/";l(P,{replace:!0})}}}catch(S){console.error(`Error ${u?"signing up":"signing in"}:`,S),v(S.message),y({title:"Error",description:S.message,status:"error",duration:3e3,isClosable:!0,position:"top-right"})}finally{g(!1)}},p=()=>{f(!u),v("")};return s.jsx(Le,{maxW:"container.sm",py:8,children:s.jsx(ne,{bg:b,p:8,borderRadius:"xl",borderWidth:"1px",borderColor:h,shadow:"lg",children:s.jsxs(we,{spacing:6,children:[s.jsx(ke,{size:"xl",children:u?"Create Account":"Welcome Back"}),s.jsx(oe,{color:"gray.500",children:u?"Sign up to get started":"Sign in to access your account"}),s.jsx("form",{onSubmit:x,style:{width:"100%"},children:s.jsxs(we,{spacing:4,align:"stretch",children:[u&&s.jsxs($e,{children:[s.jsx(qe,{children:"Full Name"}),s.jsxs(Tt,{children:[s.jsx(Tr,{pointerEvents:"none",children:s.jsx(yi,{color:"gray.300"})}),s.jsx(Xe,{type:"text",value:i,onChange:w=>o(w.target.value),required:u,placeholder:"Your full name"})]})]}),s.jsxs($e,{isInvalid:!!d,children:[s.jsx(qe,{children:"Email"}),s.jsxs(Tt,{children:[s.jsx(Tr,{pointerEvents:"none",children:s.jsx(Pu,{color:"gray.300"})}),s.jsx(Xe,{type:"email",value:n,onChange:w=>e(w.target.value),required:!0,placeholder:"Your email address"})]})]}),s.jsxs($e,{isInvalid:!!d,children:[s.jsx(qe,{children:"Password"}),s.jsxs(Tt,{children:[s.jsx(Tr,{pointerEvents:"none",children:s.jsx(Cu,{color:"gray.300"})}),s.jsx(Xe,{type:"password",value:t,onChange:w=>r(w.target.value),required:!0,placeholder:u?"Create a password":"Enter your password"})]}),d&&s.jsx(qs,{children:d})]}),s.jsx(be,{type:"submit",colorScheme:"brand",size:"lg",width:"100%",isLoading:a,mt:2,children:u?"Sign Up":"Sign In"})]})}),s.jsx(Pt,{}),s.jsxs(ve,{justify:"center",width:"100%",children:[s.jsx(oe,{children:u?"Already have an account?":"Don't have an account?"}),s.jsx(Et,{color:m,onClick:p,children:u?"Sign In":"Sign Up"})]})]})})})},ym=()=>{var c;const[n,e]=Q.useState([]),[t,r]=Q.useState(!0),[i,o]=Q.useState(null),{user:a,signOut:g,loading:d}=Lt(),v=mt(),u=ae("white","gray.800"),f=ae("gray.200","gray.700");Q.useEffect(()=>{const _=async()=>{if(a!=null&&a.id)try{console.log("Fetching bookmarks for user:",a.id),r(!0),o(null);const{data:y,error:b}=await le.from("Bookmarks").select(`
            id,
            created_at,
            Books (
              id,
              title,
              cover_image,
              avg_rating,
              category_id,
              Categories (
                name
              )
            )
          `).eq("user_id",a.id).order("created_at",{ascending:!1});if(b)throw b;console.log("Bookmarks fetched:",y),e(y||[])}catch(y){console.error("Error fetching user bookmarks:",y),o(y.message),v({title:"Error",description:`Failed to load your bookmarks: ${y.message}`,status:"error",duration:5e3,isClosable:!0})}finally{r(!1)}};a!=null&&a.id&&!d&&_()},[a==null?void 0:a.id,d,v]);const l=async()=>{try{await g()}catch(_){console.error("Error signing out:",_),v({title:"Error",description:_.message,status:"error",duration:3e3,isClosable:!0})}};return d?s.jsx(Le,{maxW:"container.xl",py:8,children:s.jsxs(we,{spacing:8,align:"center",minH:"60vh",justify:"center",children:[s.jsx($t,{size:"xl",color:"blue.500",thickness:"4px",speed:"0.65s"}),s.jsx(oe,{color:"gray.500",fontSize:"lg",children:"Loading your profile..."})]})}):a?s.jsx(Le,{maxW:"container.xl",py:8,children:s.jsxs(we,{spacing:8,align:"stretch",children:[s.jsx(ne,{bg:u,borderRadius:"xl",borderWidth:"1px",borderColor:f,p:8,shadow:"lg",children:s.jsxs(we,{spacing:6,children:[s.jsx(Xr,{size:"2xl",name:a.email||"User",src:(c=a.user_metadata)==null?void 0:c.avatar_url}),s.jsxs(we,{spacing:2,children:[s.jsx(ke,{size:"lg",children:a.email||"User"}),s.jsx(dt,{colorScheme:"brand",children:"Member"})]}),s.jsxs(va,{width:"100%",children:[s.jsxs(jt,{textAlign:"center",children:[s.jsx(St,{children:"Bookmarks"}),s.jsx(At,{children:n.length})]}),s.jsxs(jt,{textAlign:"center",children:[s.jsx(St,{children:"Books Read"}),s.jsx(At,{children:"0"})]}),s.jsxs(jt,{textAlign:"center",children:[s.jsx(St,{children:"Reviews"}),s.jsx(At,{children:"0"})]})]}),s.jsx(be,{colorScheme:"red",variant:"outline",onClick:l,children:"Sign Out"})]})}),s.jsx(Pt,{}),t?s.jsxs(we,{spacing:4,py:8,children:[s.jsx($t,{size:"lg",color:"blue.500"}),s.jsx(oe,{color:"gray.500",children:"Loading your bookmarks..."})]}):i?s.jsxs(tt,{status:"error",borderRadius:"md",my:4,children:[s.jsx(rt,{}),i]}):n.length>0?s.jsxs(s.Fragment,{children:[s.jsx(ke,{size:"lg",children:s.jsxs(ve,{children:[s.jsx(or,{}),s.jsx(oe,{children:"Your Bookmarks"})]})}),s.jsx(Ct,{columns:{base:1,md:2,lg:3,xl:4},spacing:6,children:n.map(_=>s.jsx(is,{book:_.Books,isBookmarked:!0},_.id))})]}):s.jsxs(we,{spacing:4,py:8,children:[s.jsx(ht,{size:40}),s.jsx(oe,{color:"gray.500",children:"You haven't bookmarked any books yet. Start exploring!"}),s.jsx(be,{as:"a",href:"/",colorScheme:"brand",leftIcon:s.jsx(ht,{}),children:"Explore Books"})]})]})}):s.jsx(Le,{maxW:"container.xl",py:8,children:s.jsxs(tt,{status:"error",children:[s.jsx(rt,{}),"User session not found. Please try logging in again."]})})},mm=({children:n})=>{const[e,t]=Q.useState(null),[r,i]=Q.useState(!0),[o,a]=Q.useState(!1);return Q.useEffect(()=>{(async()=>{var v;try{const{data:{session:u}}=await le.auth.getSession();if(t(u),(v=u==null?void 0:u.user)!=null&&v.id){const{data:f,error:l}=await le.from("profiles").select("role").eq("id",u.user.id).single();l?(console.error("Error checking admin status:",l),a(!1)):a(f.role==="admin")}i(!1)}catch(u){console.error("Error in checkAdminStatus:",u),i(!1),a(!1)}})();const{data:{subscription:d}}=le.auth.onAuthStateChange(async(v,u)=>{var f;if(t(u),(f=u==null?void 0:u.user)!=null&&f.id){const{data:l,error:c}=await le.from("profiles").select("role").eq("id",u.user.id).single();c?(console.error("Error checking admin status:",c),a(!1)):a(l.role==="admin")}else a(!1)});return()=>d.unsubscribe()},[]),r?null:!e||!o?s.jsx(Ai,{to:"/admin/login",replace:!0}):n},bm=()=>{const n=window.location.pathname.startsWith("/admin");return s.jsx(ba,{theme:n?du:yu,children:s.jsxs(ne,{minH:"100vh",children:[s.jsx(gm,{}),s.jsxs(zs,{children:[s.jsxs(Fe,{element:s.jsx(Bu,{}),children:[s.jsx(Fe,{path:"/",element:s.jsx(Hu,{})}),s.jsx(Fe,{path:"book/:bookId",element:s.jsx(vf,{})}),s.jsx(Fe,{path:"category/:categoryId",element:s.jsx(xf,{})}),s.jsx(Fe,{path:"/login",element:s.jsx(vm,{})}),s.jsx(Fe,{path:"/profile",element:s.jsx(qu,{children:s.jsx(ym,{})})})]}),s.jsxs(Fe,{path:"/admin",children:[s.jsx(Fe,{path:"login",element:s.jsx(wf,{})}),s.jsx(Fe,{path:"signup",element:s.jsx(kf,{})}),s.jsxs(Fe,{element:s.jsx(mm,{children:s.jsx($u,{})}),children:[s.jsx(Fe,{index:!0,element:s.jsx(jf,{})}),s.jsx(Fe,{path:"books",element:s.jsx(hm,{})}),s.jsx(Fe,{path:"content",element:s.jsx(fm,{})}),s.jsx(Fe,{path:"analytics",element:s.jsx(dm,{})})]})]}),s.jsx(Fe,{path:"/404",element:s.jsx(pm,{})}),s.jsx(Fe,{path:"*",element:s.jsx(Ai,{to:"/404",replace:!0})})]})]})})},_m=hn({styles:{global:{body:{bg:"gray.50"}}}});si.createRoot(document.getElementById("root")).render(s.jsx(yt.StrictMode,{children:s.jsx(ba,{theme:_m,children:s.jsx(Hs,{children:s.jsx(bm,{})})})}));
//# sourceMappingURL=index-BWCMLKSa.js.map
